<!-- TOC -->

- [1. åŸå§‹ç±»å‹çš„æ–¹æ³•](#1-%e5%8e%9f%e5%a7%8b%e7%b1%bb%e5%9e%8b%e7%9a%84%e6%96%b9%e6%b3%95)
  - [1.1. å½“ä½œå¯¹è±¡çš„åŸå§‹ç±»å‹](#11-%e5%bd%93%e4%bd%9c%e5%af%b9%e8%b1%a1%e7%9a%84%e5%8e%9f%e5%a7%8b%e7%b1%bb%e5%9e%8b)
  - [1.2. æ€»ç»“](#12-%e6%80%bb%e7%bb%93)
- [2. æ•°å­—ç±»å‹](#2-%e6%95%b0%e5%ad%97%e7%b1%bb%e5%9e%8b)
  - [2.1. ç¼–å†™æ•°å­—çš„æ›´å¤šæ–¹æ³•](#21-%e7%bc%96%e5%86%99%e6%95%b0%e5%ad%97%e7%9a%84%e6%9b%b4%e5%a4%9a%e6%96%b9%e6%b3%95)
  - [2.2. åå…­è¿›åˆ¶ï¼ŒäºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶æ•°å­—](#22-%e5%8d%81%e5%85%ad%e8%bf%9b%e5%88%b6%e4%ba%8c%e8%bf%9b%e5%88%b6%e5%92%8c%e5%85%ab%e8%bf%9b%e5%88%b6%e6%95%b0%e5%ad%97)
  - [2.3. toString(base)](#23-tostringbase)
  - [2.4. èˆå…¥](#24-%e8%88%8d%e5%85%a5)
  - [2.5. ä¸ç²¾ç¡®çš„è®¡ç®—](#25-%e4%b8%8d%e7%b2%be%e7%a1%ae%e7%9a%84%e8%ae%a1%e7%ae%97)
  - [2.6. æµ‹è¯•ï¼šisFinite å’Œ isNaN](#26-%e6%b5%8b%e8%af%95isfinite-%e5%92%8c-isnan)
  - [2.7. parseInt å’Œ parseFloat](#27-parseint-%e5%92%8c-parsefloat)
  - [2.8. å…¶ä»–æ•°å­¦å‡½æ•°](#28-%e5%85%b6%e4%bb%96%e6%95%b0%e5%ad%a6%e5%87%bd%e6%95%b0)
  - [2.9. æ€»ç»“](#29-%e6%80%bb%e7%bb%93)
- [3. å­—ç¬¦ä¸²](#3-%e5%ad%97%e7%ac%a6%e4%b8%b2)
  - [3.1. å¼•å·ï¼ˆQuotesï¼‰](#31-%e5%bc%95%e5%8f%b7quotes)
  - [3.2. ç‰¹æ®Šå­—ç¬¦](#32-%e7%89%b9%e6%ae%8a%e5%ad%97%e7%ac%a6)
  - [3.3. å­—ç¬¦ä¸²é•¿åº¦](#33-%e5%ad%97%e7%ac%a6%e4%b8%b2%e9%95%bf%e5%ba%a6)
  - [3.4. è®¿é—®å­—ç¬¦](#34-%e8%ae%bf%e9%97%ae%e5%ad%97%e7%ac%a6)
  - [3.5. å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„](#35-%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%98%af%e4%b8%8d%e5%8f%af%e5%8f%98%e7%9a%84)
  - [3.6. æ”¹å˜å¤§å°å†™](#36-%e6%94%b9%e5%8f%98%e5%a4%a7%e5%b0%8f%e5%86%99)
  - [3.7. æŸ¥æ‰¾å­å­—ç¬¦ä¸²](#37-%e6%9f%a5%e6%89%be%e5%ad%90%e5%ad%97%e7%ac%a6%e4%b8%b2)
    - [3.7.1. str.indexOf](#371-strindexof)
    - [3.7.2. æŒ‰ä½ï¼ˆbitwiseï¼‰NOT æŠ€å·§](#372-%e6%8c%89%e4%bd%8dbitwisenot-%e6%8a%80%e5%b7%a7)
    - [3.7.3. includesï¼ŒstartsWithï¼ŒendsWith](#373-includesstartswithendswith)
  - [3.8. è·å–å­å­—ç¬¦ä¸²](#38-%e8%8e%b7%e5%8f%96%e5%ad%90%e5%ad%97%e7%ac%a6%e4%b8%b2)
  - [3.9. æ¯”è¾ƒå­—ç¬¦ä¸²](#39-%e6%af%94%e8%be%83%e5%ad%97%e7%ac%a6%e4%b8%b2)
    - [3.9.1. æ­£ç¡®çš„æ¯”è¾ƒ](#391-%e6%ad%a3%e7%a1%ae%e7%9a%84%e6%af%94%e8%be%83)
  - [3.10. å†…éƒ¨ï¼ŒUnicode](#310-%e5%86%85%e9%83%a8unicode)
    - [3.10.1. ä»£ç†å¯¹](#3101-%e4%bb%a3%e7%90%86%e5%af%b9)
    - [3.10.2. å˜éŸ³ç¬¦å·ä¸è§„èŒƒåŒ–](#3102-%e5%8f%98%e9%9f%b3%e7%ac%a6%e5%8f%b7%e4%b8%8e%e8%a7%84%e8%8c%83%e5%8c%96)
  - [3.11. æ€»ç»“](#311-%e6%80%bb%e7%bb%93)
- [4. æ•°ç»„](#4-%e6%95%b0%e7%bb%84)
  - [4.1. å£°æ˜](#41-%e5%a3%b0%e6%98%8e)
  - [4.2. pop/push, shift/unshift æ–¹æ³•](#42-poppush-shiftunshift-%e6%96%b9%e6%b3%95)
    - [4.2.1. ä½œç”¨äºæ•°ç»„æœ«ç«¯çš„æ–¹æ³•](#421-%e4%bd%9c%e7%94%a8%e4%ba%8e%e6%95%b0%e7%bb%84%e6%9c%ab%e7%ab%af%e7%9a%84%e6%96%b9%e6%b3%95)
    - [4.2.2. ä½œç”¨äºæ•°ç»„é¦–ç«¯çš„æ–¹æ³•ï¼š](#422-%e4%bd%9c%e7%94%a8%e4%ba%8e%e6%95%b0%e7%bb%84%e9%a6%96%e7%ab%af%e7%9a%84%e6%96%b9%e6%b3%95)
  - [4.3. å†…éƒ¨](#43-%e5%86%85%e9%83%a8)
  - [4.4. æ€§èƒ½](#44-%e6%80%a7%e8%83%bd)
  - [4.5. å¾ªç¯](#45-%e5%be%aa%e7%8e%af)
  - [4.6. å…³äº â€œlengthâ€](#46-%e5%85%b3%e4%ba%8e-length)
  - [4.7. new Array()](#47-new-array)
  - [4.8. å¤šç»´æ•°ç»„](#48-%e5%a4%9a%e7%bb%b4%e6%95%b0%e7%bb%84)
  - [4.9. toString](#49-tostring)
  - [4.10. æ€»ç»“](#410-%e6%80%bb%e7%bb%93)
- [5. æ•°ç»„æ–¹æ³•](#5-%e6%95%b0%e7%bb%84%e6%96%b9%e6%b3%95)
  - [5.1. æ·»åŠ /ç§»é™¤æ•°ç»„å…ƒç´ ](#51-%e6%b7%bb%e5%8a%a0%e7%a7%bb%e9%99%a4%e6%95%b0%e7%bb%84%e5%85%83%e7%b4%a0)
    - [5.1.1. splice](#511-splice)
    - [5.1.2. slice](#512-slice)
    - [5.1.3. concat](#513-concat)
  - [5.2. éå†ï¼šforEach](#52-%e9%81%8d%e5%8e%86foreach)
  - [5.3. åœ¨æ•°ç»„ä¸­æœç´¢](#53-%e5%9c%a8%e6%95%b0%e7%bb%84%e4%b8%ad%e6%90%9c%e7%b4%a2)
    - [5.3.1. indexOf/lastIndexOf å’Œ includes](#531-indexoflastindexof-%e5%92%8c-includes)
    - [5.3.2. find å’Œ findIndex](#532-find-%e5%92%8c-findindex)
    - [5.3.3. filter](#533-filter)
  - [5.4. è½¬æ¢æ•°ç»„](#54-%e8%bd%ac%e6%8d%a2%e6%95%b0%e7%bb%84)
    - [5.4.1. map](#541-map)
    - [5.4.2. sort(fn)](#542-sortfn)
    - [5.4.3. reverse](#543-reverse)
    - [5.4.4. split å’Œ join](#544-split-%e5%92%8c-join)
    - [5.4.5. reduce/reduceRight](#545-reducereduceright)
  - [5.5. Array.isArray](#55-arrayisarray)
  - [5.6. å¤§å¤šæ•°æ–¹æ³•éƒ½æ”¯æŒ â€œthisArgâ€](#56-%e5%a4%a7%e5%a4%9a%e6%95%b0%e6%96%b9%e6%b3%95%e9%83%bd%e6%94%af%e6%8c%81-thisarg)
  - [5.7. æ€»ç»“](#57-%e6%80%bb%e7%bb%93)
- [6. Iterable objectï¼ˆå¯è¿­ä»£å¯¹è±¡ï¼‰](#6-iterable-object%e5%8f%af%e8%bf%ad%e4%bb%a3%e5%af%b9%e8%b1%a1)
  - [6.1. Symbol.iterator](#61-symboliterator)
  - [6.2. å­—ç¬¦ä¸²æ˜¯å¯è¿­ä»£çš„](#62-%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%98%af%e5%8f%af%e8%bf%ad%e4%bb%a3%e7%9a%84)
  - [6.3. æ˜¾å¼è°ƒç”¨è¿­ä»£å™¨](#63-%e6%98%be%e5%bc%8f%e8%b0%83%e7%94%a8%e8%bf%ad%e4%bb%a3%e5%99%a8)
  - [6.4. å¯è¿­ä»£ï¼ˆiterableï¼‰å’Œç±»æ•°ç»„ï¼ˆarray-likeï¼‰](#64-%e5%8f%af%e8%bf%ad%e4%bb%a3iterable%e5%92%8c%e7%b1%bb%e6%95%b0%e7%bb%84array-like)
  - [6.5. Array.from](#65-arrayfrom)
  - [6.6. æ€»ç»“](#66-%e6%80%bb%e7%bb%93)
- [7. Map and Setï¼ˆæ˜ å°„å’Œé›†åˆï¼‰](#7-map-and-set%e6%98%a0%e5%b0%84%e5%92%8c%e9%9b%86%e5%90%88)
  - [7.1. Map](#71-map)
  - [7.2. Map è¿­ä»£](#72-map-%e8%bf%ad%e4%bb%a3)
  - [7.3. Object.entriesï¼šä»å¯¹è±¡åˆ›å»º Map](#73-objectentries%e4%bb%8e%e5%af%b9%e8%b1%a1%e5%88%9b%e5%bb%ba-map)
  - [7.4. Object.fromEntriesï¼šä» Map åˆ›å»ºå¯¹è±¡](#74-objectfromentries%e4%bb%8e-map-%e5%88%9b%e5%bb%ba%e5%af%b9%e8%b1%a1)
  - [7.5. Set](#75-set)
  - [7.6. Set è¿­ä»£ï¼ˆiterationï¼‰](#76-set-%e8%bf%ad%e4%bb%a3iteration)
  - [7.7. æ€»ç»“](#77-%e6%80%bb%e7%bb%93)
- [8. WeakMap and WeakSetï¼ˆå¼±æ˜ å°„å’Œå¼±é›†åˆï¼‰](#8-weakmap-and-weakset%e5%bc%b1%e6%98%a0%e5%b0%84%e5%92%8c%e5%bc%b1%e9%9b%86%e5%90%88)
  - [8.1. WeakMap](#81-weakmap)
  - [8.2. ä½¿ç”¨æ¡ˆä¾‹ï¼šé¢å¤–çš„æ•°æ®](#82-%e4%bd%bf%e7%94%a8%e6%a1%88%e4%be%8b%e9%a2%9d%e5%a4%96%e7%9a%84%e6%95%b0%e6%8d%ae)
  - [8.3. ä½¿ç”¨æ¡ˆä¾‹ï¼šç¼“å­˜](#83-%e4%bd%bf%e7%94%a8%e6%a1%88%e4%be%8b%e7%bc%93%e5%ad%98)
  - [8.4. WeakSet](#84-weakset)
  - [8.5. æ€»ç»“](#85-%e6%80%bb%e7%bb%93)
- [9. Object.keysï¼Œvaluesï¼Œentries](#9-objectkeysvaluesentries)
  - [9.1. Object.keysï¼Œvaluesï¼Œentries](#91-objectkeysvaluesentries)
  - [9.2. è½¬æ¢å¯¹è±¡](#92-%e8%bd%ac%e6%8d%a2%e5%af%b9%e8%b1%a1)
- [10. è§£æ„èµ‹å€¼](#10-%e8%a7%a3%e6%9e%84%e8%b5%8b%e5%80%bc)
  - [10.1. æ•°ç»„è§£æ„](#101-%e6%95%b0%e7%bb%84%e8%a7%a3%e6%9e%84)
  - [10.2. å‰©ä½™çš„ â€˜â€¦â€™](#102-%e5%89%a9%e4%bd%99%e7%9a%84)
  - [10.3. é»˜è®¤å€¼](#103-%e9%bb%98%e8%ae%a4%e5%80%bc)
  - [10.4. å¯¹è±¡è§£æ„](#104-%e5%af%b9%e8%b1%a1%e8%a7%a3%e6%9e%84)
  - [10.5. å‰©ä½™æ¨¡å¼ï¼ˆpatternï¼‰"â€¦"](#105-%e5%89%a9%e4%bd%99%e6%a8%a1%e5%bc%8fpattern%22%22)
  - [10.6. åµŒå¥—è§£æ„](#106-%e5%b5%8c%e5%a5%97%e8%a7%a3%e6%9e%84)
  - [10.7. æ™ºèƒ½å‡½æ•°å‚æ•°](#107-%e6%99%ba%e8%83%bd%e5%87%bd%e6%95%b0%e5%8f%82%e6%95%b0)
  - [10.8. æ€»ç»“](#108-%e6%80%bb%e7%bb%93)
- [11. æ—¥æœŸå’Œæ—¶é—´](#11-%e6%97%a5%e6%9c%9f%e5%92%8c%e6%97%b6%e9%97%b4)
  - [11.1. åˆ›å»º](#111-%e5%88%9b%e5%bb%ba)
  - [11.2. è®¿é—®æ—¥æœŸç»„ä»¶](#112-%e8%ae%bf%e9%97%ae%e6%97%a5%e6%9c%9f%e7%bb%84%e4%bb%b6)
  - [11.3. è®¾ç½®æ—¥æœŸç»„ä»¶](#113-%e8%ae%be%e7%bd%ae%e6%97%a5%e6%9c%9f%e7%bb%84%e4%bb%b6)
  - [11.4. è‡ªåŠ¨æ ¡å‡†ï¼ˆAutocorrectionï¼‰](#114-%e8%87%aa%e5%8a%a8%e6%a0%a1%e5%87%86autocorrection)
  - [11.5. æ—¥æœŸè½¬åŒ–ä¸ºæ•°å­—ï¼Œæ—¥æœŸå·®å€¼](#115-%e6%97%a5%e6%9c%9f%e8%bd%ac%e5%8c%96%e4%b8%ba%e6%95%b0%e5%ad%97%e6%97%a5%e6%9c%9f%e5%b7%ae%e5%80%bc)
  - [11.6. Date.now()](#116-datenow)
  - [11.7. åº¦é‡ï¼ˆBenchmarkingï¼‰](#117-%e5%ba%a6%e9%87%8fbenchmarking)
  - [11.8. å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨ Date.parse](#118-%e5%af%b9%e4%b8%80%e4%b8%aa%e5%ad%97%e7%ac%a6%e4%b8%b2%e4%bd%bf%e7%94%a8-dateparse)
  - [11.9. æ€»ç»“](#119-%e6%80%bb%e7%bb%93)
- [12. JSON æ–¹æ³•ï¼ŒtoJSON](#12-json-%e6%96%b9%e6%b3%95tojson)
  - [12.1. JSON.stringify](#121-jsonstringify)
  - [12.2. æ’é™¤å’Œè½¬æ¢ï¼šreplacer](#122-%e6%8e%92%e9%99%a4%e5%92%8c%e8%bd%ac%e6%8d%a2replacer)
  - [12.3. æ ¼å¼åŒ–ï¼šspace](#123-%e6%a0%bc%e5%bc%8f%e5%8c%96space)
  - [12.4. è‡ªå®šä¹‰ â€œtoJSONâ€](#124-%e8%87%aa%e5%ae%9a%e4%b9%89-tojson)
  - [12.5. JSON.parse](#125-jsonparse)
  - [12.6. ä½¿ç”¨ reviver](#126-%e4%bd%bf%e7%94%a8-reviver)
  - [12.7. æ€»ç»“](#127-%e6%80%bb%e7%bb%93)

<!-- /TOC -->
# 1. åŸå§‹ç±»å‹çš„æ–¹æ³•

JavaScript å…è®¸æˆ‘ä»¬åƒä½¿ç”¨å¯¹è±¡ä¸€æ ·ä½¿ç”¨åŸå§‹ç±»å‹ï¼ˆå­—ç¬¦ä¸²ï¼Œæ•°å­—ç­‰ï¼‰ã€‚JavaScript è¿˜æä¾›äº†è¿™æ ·çš„è°ƒç”¨æ–¹æ³•ã€‚æˆ‘ä»¬å¾ˆå¿«å°±ä¼šå­¦ä¹ å®ƒä»¬ï¼Œä½†æ˜¯é¦–å…ˆæˆ‘ä»¬å°†äº†è§£å®ƒçš„å·¥ä½œåŸç†ï¼Œæ¯•ç«ŸåŸå§‹ç±»å‹ä¸æ˜¯å¯¹è±¡ï¼ˆåœ¨è¿™é‡Œæˆ‘ä»¬ä¼šåˆ†æåœ°æ›´åŠ æ¸…æ¥šï¼‰ã€‚

æˆ‘ä»¬æ¥çœ‹çœ‹åŸå§‹ç±»å‹å’Œå¯¹è±¡ä¹‹é—´çš„å…³é”®åŒºåˆ«ã€‚

ä¸€ä¸ªåŸå§‹å€¼ï¼š

- æ˜¯åŸå§‹ç±»å‹ä¸­çš„ä¸€ç§å€¼ã€‚
- åœ¨ JavaScript ä¸­æœ‰ 7 ç§åŸå§‹ç±»å‹ï¼š`string`ï¼Œ`number`ï¼Œ`bigint`ï¼Œ`boolean`ï¼Œ`symbol`ï¼Œ`null` å’Œ `undefined`ã€‚

ä¸€ä¸ªå¯¹è±¡ï¼š

- èƒ½å¤Ÿå­˜å‚¨å¤šä¸ªå€¼ä½œä¸ºå±æ€§ã€‚
- å¯ä»¥ä½¿ç”¨å¤§æ‹¬å· `{}` åˆ›å»ºå¯¹è±¡ï¼Œä¾‹å¦‚ï¼š`{name: "John", age: 30}`ã€‚JavaScript ä¸­è¿˜æœ‰å…¶ä»–ç§ç±»çš„å¯¹è±¡ï¼Œä¾‹å¦‚å‡½æ•°å°±æ˜¯å¯¹è±¡ã€‚

å…³äºå¯¹è±¡çš„æœ€å¥½çš„äº‹å„¿ä¹‹ä¸€æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªå‡½æ•°ä½œä¸ºå¯¹è±¡çš„å±æ€§å­˜å‚¨åˆ°å¯¹è±¡ä¸­ã€‚

```js
let john = {
  name: "John",
  sayHi: function () {
    alert("Hi buddy!");
  },
};

john.sayHi(); // Hi buddy!
```

æ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªåŒ…å« `sayHi` æ–¹æ³•çš„å¯¹è±¡ `john`ã€‚

è®¸å¤šå†…å»ºå¯¹è±¡å·²ç»å­˜åœ¨ï¼Œä¾‹å¦‚é‚£äº›å¤„ç†æ—¥æœŸã€é”™è¯¯ã€HTML å…ƒç´ ç­‰çš„å†…å»ºå¯¹è±¡ã€‚å®ƒä»¬å…·æœ‰ä¸åŒçš„å±æ€§å’Œæ–¹æ³•ã€‚

ä½†æ˜¯ï¼Œè¿™äº›ç‰¹æ€§ï¼ˆfeatureï¼‰éƒ½æ˜¯æœ‰æˆæœ¬çš„ï¼

å¯¹è±¡æ¯”åŸå§‹ç±»å‹â€œæ›´é‡â€ã€‚å®ƒä»¬éœ€è¦é¢å¤–çš„èµ„æºæ¥æ”¯æŒè¿ä½œã€‚

## 1.1. å½“ä½œå¯¹è±¡çš„åŸå§‹ç±»å‹

ä»¥ä¸‹æ˜¯ JavaScript åˆ›å»ºè€…é¢ä¸´çš„æ‚–è®ºï¼š

- äººä»¬å¯èƒ½æƒ³å¯¹è¯¸å¦‚å­—ç¬¦ä¸²æˆ–æ•°å­—ä¹‹ç±»çš„åŸå§‹ç±»å‹æ‰§è¡Œå¾ˆå¤šæ“ä½œã€‚æœ€å¥½å°†å®ƒä»¬ä½œä¸ºæ–¹æ³•æ¥è®¿é—®ã€‚
- åŸå§‹ç±»å‹å¿…é¡»å°½å¯èƒ½çš„ç®€å•è½»é‡ã€‚

è€Œè§£å†³æ–¹æ¡ˆçœ‹èµ·æ¥å¤šå°‘æœ‰ç‚¹å°´å°¬ï¼Œå¦‚ä¸‹ï¼š

1. åŸå§‹ç±»å‹ä»ç„¶æ˜¯åŸå§‹çš„ã€‚ä¸é¢„æœŸç›¸åŒï¼Œæä¾›å•ä¸ªå€¼
2. JavaScript å…è®¸è®¿é—®å­—ç¬¦ä¸²ï¼Œæ•°å­—ï¼Œå¸ƒå°”å€¼å’Œ symbol çš„æ–¹æ³•å’Œå±æ€§ã€‚
3. ä¸ºäº†ä½¿å®ƒä»¬èµ·ä½œç”¨ï¼Œåˆ›å»ºäº†æä¾›é¢å¤–åŠŸèƒ½çš„ç‰¹æ®Šâ€œå¯¹è±¡åŒ…è£…å™¨â€ï¼Œä½¿ç”¨åå³è¢«é”€æ¯ã€‚

â€œå¯¹è±¡åŒ…è£…å™¨â€å¯¹äºæ¯ç§åŸå§‹ç±»å‹éƒ½æ˜¯ä¸åŒçš„ï¼Œå®ƒä»¬è¢«ç§°ä¸º `String`ã€`Number`ã€`Boolean` å’Œ `Symbol`ã€‚å› æ­¤ï¼Œå®ƒä»¬æä¾›äº†ä¸åŒçš„æ–¹æ³•ã€‚

ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²æ–¹æ³• [str.toUpperCase()](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/toUpperCase) è¿”å›ä¸€ä¸ªå¤§å†™åŒ–å¤„ç†çš„å­—ç¬¦ä¸²ã€‚

ç”¨æ³•æ¼”ç¤ºå¦‚ä¸‹ï¼š

```js
let str = "Hello";

alert(str.toUpperCase()); // HELLO
```

å¾ˆç®€å•ï¼Œå¯¹å§ï¼Ÿä»¥ä¸‹æ˜¯ `str.toUpperCase()` ä¸­å®é™…å‘ç”Ÿçš„æƒ…å†µï¼š

1. å­—ç¬¦ä¸² `str` æ˜¯ä¸€ä¸ªåŸå§‹å€¼ã€‚å› æ­¤ï¼Œåœ¨è®¿é—®å…¶å±æ€§æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²å­—é¢å€¼çš„ç‰¹æ®Šå¯¹è±¡ï¼Œå¹¶ä¸”å…·æœ‰æœ‰ç”¨çš„æ–¹æ³•ï¼Œä¾‹å¦‚ `toUpperCase()`ã€‚
2. è¯¥æ–¹æ³•è¿è¡Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼ˆç”± `alert` æ˜¾ç¤ºï¼‰ã€‚
3. ç‰¹æ®Šå¯¹è±¡è¢«é”€æ¯ï¼Œåªç•™ä¸‹åŸå§‹å€¼ `str`ã€‚

æ‰€ä»¥åŸå§‹ç±»å‹å¯ä»¥æä¾›æ–¹æ³•ï¼Œä½†å®ƒä»¬ä¾ç„¶æ˜¯è½»é‡çº§çš„ã€‚

JavaScript å¼•æ“é«˜åº¦ä¼˜åŒ–äº†è¿™ä¸ªè¿‡ç¨‹ã€‚å®ƒç”šè‡³å¯èƒ½è·³è¿‡åˆ›å»ºé¢å¤–çš„å¯¹è±¡ã€‚ä½†æ˜¯å®ƒä»ç„¶å¿…é¡»éµå®ˆè§„èŒƒï¼Œå¹¶ä¸”è¡¨ç°å¾—å¥½åƒå®ƒåˆ›å»ºäº†ä¸€æ ·ã€‚

æ•°å­—æœ‰å…¶è‡ªå·±çš„æ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œ[toFixed(n)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toFixed) å°†æ•°å­—èˆå…¥åˆ°ç»™å®šçš„ç²¾åº¦ï¼š

```js
let n = 1.23456;

alert(n.toFixed(2)); // 1.23
```

æˆ‘ä»¬å°†åœ¨åé¢ æ•°å­—ç±»å‹ å’Œ å­—ç¬¦ä¸² ç« èŠ‚ä¸­çœ‹åˆ°æ›´å¤šå…·ä½“çš„æ–¹æ³•ã€‚

> :warning: æ„é€ å™¨ `String/Number/Boolean` ä»…ä¾›å†…éƒ¨ä½¿ç”¨

åƒ Java è¿™æ ·çš„ä¸€äº›è¯­è¨€å…è®¸æˆ‘ä»¬ä½¿ç”¨ `new Number(1)` æˆ– `new Boolean(false)` ç­‰è¯­æ³•ï¼Œæ˜ç¡®åœ°ä¸ºåŸå§‹ç±»å‹åˆ›å»ºâ€œå¯¹è±¡åŒ…è£…å™¨â€ã€‚

åœ¨ JavaScript ä¸­ï¼Œç”±äºå†å²åŸå› ï¼Œè¿™ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æå…¶ **ä¸æ¨è**ã€‚å› ä¸ºè¿™æ ·ä¼šå‡ºé—®é¢˜ã€‚

ä¾‹å¦‚ï¼š

```js
alert(typeof 0); // "number"

alert(typeof new Number(0)); // "object"!
```

å¯¹è±¡åœ¨ `if` ä¸­å§‹ç»ˆæ˜¯ trueï¼Œå› æ­¤æ­¤å¤„çš„ `alert` å°†æ˜¾ç¤ºï¼š

```js
let zero = new Number(0);

if (zero) {
  // zero ä¸º trueï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡
  alert("zero is truthy?!?");
}
```

ä¾‹å¦‚ï¼Œä¸‹é¢å®Œå…¨æ˜¯æœ‰æ•ˆçš„ï¼š

```js
let num = Number("123"); // å°†å­—ç¬¦ä¸²è½¬æˆæ•°å­—
```

> :warning:**null/undefined æ²¡æœ‰ä»»ä½•æ–¹æ³•**

ç‰¹æ®Šçš„åŸå§‹ç±»å‹ `null` å’Œ `undefined`æ˜¯ä¾‹å¤–ã€‚å®ƒä»¬æ²¡æœ‰å¯¹åº”çš„â€œå¯¹è±¡åŒ…è£…å™¨â€ï¼Œä¹Ÿæ²¡æœ‰æä¾›ä»»ä½•æ–¹æ³•ã€‚ä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œå®ƒä»¬æ˜¯â€œæœ€åŸå§‹çš„â€ã€‚

å°è¯•è®¿é—®è¿™ç§å€¼çš„å±æ€§ä¼šå¯¼è‡´é”™è¯¯ï¼š

```js
alert(null.test); // error
```

## 1.2. æ€»ç»“

- é™¤ `null` å’Œ `undefined` ä»¥å¤–çš„åŸå§‹ç±»å‹éƒ½æä¾›äº†è®¸å¤šæœ‰ç”¨çš„æ–¹æ³•ã€‚æˆ‘ä»¬åé¢çš„ç« èŠ‚ä¸­å­¦ä¹ è¿™äº›å†…å®¹ã€‚
- ä»å½¢å¼ä¸Šè®²ï¼Œè¿™äº›æ–¹æ³•é€šè¿‡ä¸´æ—¶å¯¹è±¡å·¥ä½œï¼Œä½† JavaScript å¼•æ“å¯ä»¥å¾ˆå¥½åœ°è°ƒæ•´ï¼Œä»¥åœ¨å†…éƒ¨å¯¹å…¶è¿›è¡Œä¼˜åŒ–ï¼Œå› æ­¤è°ƒç”¨å®ƒä»¬å¹¶ä¸éœ€è¦å¤ªé«˜çš„æˆæœ¬ã€‚

# 2. æ•°å­—ç±»å‹

åœ¨ç°ä»£ JavaScript ä¸­ï¼Œæ•°å­—ï¼ˆnumberï¼‰æœ‰ä¸¤ç§ç±»å‹ï¼š

1. javaScript ä¸­çš„å¸¸è§„æ•°å­—ä»¥ 64 ä½çš„æ ¼å¼ [IEEE-754](https://en.wikipedia.org/wiki/IEEE_754-2008_revision) å­˜å‚¨ï¼Œä¹Ÿè¢«ç§°ä¸ºâ€œåŒç²¾åº¦æµ®ç‚¹æ•°â€ã€‚è¿™æ˜¯æˆ‘ä»¬å¤§å¤šæ•°æ—¶å€™æ‰€ä½¿ç”¨çš„æ•°å­—ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬ç« ä¸­å­¦ä¹ å®ƒä»¬ã€‚

2. BigInt æ•°å­—ï¼Œç”¨äºè¡¨ç¤ºä»»æ„é•¿åº¦çš„æ•´æ•°ã€‚æœ‰æ—¶ä¼šéœ€è¦å®ƒä»¬ï¼Œå› ä¸ºå¸¸è§„æ•°å­—ä¸èƒ½è¶…è¿‡ 253 æˆ–å°äº -253ã€‚ç”±äºä»…åœ¨å°‘æ•°ç‰¹æ®Šé¢†åŸŸæ‰ä¼šç”¨åˆ° BigIntï¼Œå› æ­¤æˆ‘ä»¬åœ¨ç‰¹æ®Šçš„ç« èŠ‚ [BigInt](https://zh.javascript.info/bigint) ä¸­å¯¹å…¶è¿›è¡Œäº†ä»‹ç»ã€‚

æ‰€ä»¥ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†è®¨è®ºå¸¸è§„æ•°å­—ç±»å‹ã€‚ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹å­¦ä¹ å§ã€‚

## 2.1. ç¼–å†™æ•°å­—çš„æ›´å¤šæ–¹æ³•

æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å†™ 10 äº¿ã€‚æ˜¾ç„¶çš„æ–¹æ³•æ˜¯ï¼š

```js
let billion = 1000000000;
```

ä½†åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸é¿å…å†™ä¸€é•¿ä¸²é›¶ï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“æ‰“é”™ã€‚å¦å¤–ï¼Œæˆ‘ä»¬å¾ˆæ‡’ã€‚æˆ‘ä»¬é€šå¸¸ä¼šå°† 10 äº¿å†™æˆ `"1bn"`ï¼Œæˆ–å°† 72 äº¿å†™æˆ `"7.3bn"`ã€‚å¯¹äºå¤§å¤šæ•°å¤§çš„æ•°å­—æ¥è¯´éƒ½æ˜¯å¦‚æ­¤ã€‚

åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨æ•°å­—åé™„åŠ å­—æ¯ â€œeâ€ï¼Œå¹¶æŒ‡å®šé›¶çš„æ•°é‡æ¥ç¼©çŸ­æ•°å­—ï¼š

```js
let billion = 1e9; // 10 äº¿ï¼Œå­—é¢æ„æ€ï¼šæ•°å­— 1 åé¢è·Ÿ 9 ä¸ª 0

alert(7.3e9); // 73 äº¿ï¼ˆ7,300,000,000ï¼‰
```

æ¢å¥è¯è¯´ï¼Œ`"e"` æŠŠæ•°å­—ä¹˜ä»¥ `1` åé¢è·Ÿç€ç»™å®šæ•°é‡çš„ 0 çš„æ•°å­—ã€‚

```js
1e3 = 1 * 1000;
1.23e6 = 1.23 * 1000000;
```

ç°åœ¨è®©æˆ‘ä»¬å†™ä¸€äº›éå¸¸å°çš„æ•°å­—ã€‚ä¾‹å¦‚ï¼Œ1 å¾®ç§’ï¼ˆç™¾ä¸‡åˆ†ä¹‹ä¸€ç§’ï¼‰ï¼š

```js
let ms = 0.000001;
```

å°±åƒä»¥å‰ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨ `"e"` æ¥å®Œæˆã€‚å¦‚æœæˆ‘ä»¬æƒ³é¿å…æ˜¾å¼åœ°å†™é›¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š

```js
let ms = 1e-6; // 1 çš„å·¦è¾¹æœ‰ 6 ä¸ª 0
```

å¦‚æœæˆ‘ä»¬æ•°ä¸€ä¸‹ `0.000001` ä¸­çš„ 0 çš„ä¸ªæ•°ï¼Œæ˜¯ 6 ä¸ªã€‚æ‰€ä»¥è‡ªç„¶æ˜¯ `1e-6`ã€‚

æ¢å¥è¯è¯´ï¼Œ`e` åé¢çš„è´Ÿæ•°è¡¨ç¤ºé™¤ä»¥ 1 åé¢è·Ÿç€ç»™å®šæ•°é‡çš„ 0 çš„æ•°å­—ï¼š

```js
// -3 é™¤ä»¥ 1 åé¢è·Ÿç€ 3 ä¸ª 0 çš„æ•°å­—
1e-3 = 1 / 1000 (=0.001)

// -6 é™¤ä»¥ 1 åé¢è·Ÿç€ 6 ä¸ª 0 çš„æ•°å­—
1.23e-6 = 1.23 / 1000000 (=0.00000123)
```

## 2.2. åå…­è¿›åˆ¶ï¼ŒäºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶æ•°å­—

[åå…­è¿›åˆ¶](https://en.wikipedia.org/wiki/Hexadecimal) æ•°å­—åœ¨ JavaScript ä¸­è¢«å¹¿æ³›ç”¨äºè¡¨ç¤ºé¢œè‰²ï¼Œç¼–ç å­—ç¬¦ä»¥åŠå…¶ä»–è®¸å¤šä¸œè¥¿ã€‚æ‰€ä»¥è‡ªç„¶åœ°ï¼Œæœ‰ä¸€ç§è¾ƒçŸ­çš„å†™æ–¹æ³•ï¼š`0x`ï¼Œç„¶åæ˜¯æ•°å­—ã€‚

ä¾‹å¦‚ï¼š

```js
alert(0xff); // 255
alert(0xff); // 255ï¼ˆä¸€æ ·ï¼Œå¤§å°å†™æ²¡å½±å“ï¼‰
```

äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶æ•°å­—ç³»ç»Ÿå¾ˆå°‘ä½¿ç”¨ï¼Œä½†ä¹Ÿæ”¯æŒä½¿ç”¨ `0b` å’Œ `0o` å‰ç¼€ï¼š

```js
let a = 0b11111111; // äºŒè¿›åˆ¶å½¢å¼çš„ 255
let b = 0o377; // å…«è¿›åˆ¶å½¢å¼çš„ 255

alert(a == b); // trueï¼Œä¸¤è¾¹æ˜¯ç›¸åŒçš„æ•°å­—ï¼Œéƒ½æ˜¯ 255
```

åªæœ‰è¿™ä¸‰ç§è¿›åˆ¶æ”¯æŒè¿™ç§å†™æ³•ã€‚å¯¹äºå…¶ä»–è¿›åˆ¶ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨å‡½æ•° `parseInt`ï¼ˆæˆ‘ä»¬å°†åœ¨æœ¬ç« åé¢çœ‹åˆ°ï¼‰ã€‚

## 2.3. toString(base)

æ–¹æ³• `num.toString(base)` è¿”å›åœ¨ç»™å®š base è¿›åˆ¶æ•°å­—ç³»ç»Ÿä¸­ num çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```js
let num = 255;

alert(num.toString(16)); // ff
alert(num.toString(2)); // 11111111
```

`base` çš„èŒƒå›´å¯ä»¥ä» `2` åˆ° `36`ã€‚é»˜è®¤æƒ…å†µä¸‹æ˜¯ `10`ã€‚

å¸¸è§çš„ç”¨ä¾‹å¦‚ä¸‹ï¼š

- **base=16** ç”¨äºåå…­è¿›åˆ¶é¢œè‰²ï¼Œå­—ç¬¦ç¼–ç ç­‰,æ•°å­—å¯ä»¥æ˜¯ `0..9` æˆ– `A..F`ã€‚
- **base=2** ä¸»è¦ç”¨äºè°ƒè¯•æŒ‰ä½æ“ä½œï¼Œæ•°å­—å¯ä»¥æ˜¯ 0 æˆ– 1ã€‚
- **base=36** æ˜¯æœ€å¤§è¿›åˆ¶ï¼Œæ•°å­—å¯ä»¥æ˜¯ `0..9` æˆ– `A..Z`ã€‚æ‰€æœ‰æ‹‰ä¸å­—æ¯éƒ½è¢«ç”¨äºäº†è¡¨ç¤ºæ•°å­—ã€‚å¯¹äº 36 è¿›åˆ¶æ¥è¯´ï¼Œä¸€ä¸ªæœ‰è¶£ä¸”æœ‰ç”¨çš„ä¾‹å­æ˜¯ï¼Œå½“æˆ‘ä»¬éœ€è¦å°†ä¸€ä¸ªè¾ƒé•¿çš„æ•°å­—æ ‡è¯†ç¬¦è½¬æ¢æˆè¾ƒçŸ­çš„æ—¶å€™ï¼Œä¾‹å¦‚åšä¸€ä¸ªçŸ­çš„ URLã€‚å¯ä»¥ç®€å•åœ°ä½¿ç”¨åŸºæ•°ä¸º 36 çš„æ•°å­—ç³»ç»Ÿè¡¨ç¤ºï¼š

```js
alert((123456).toString(36)); // 2n9c
```

> :warning:ä½¿ç”¨ä¸¤ä¸ªç‚¹æ¥è°ƒç”¨ä¸€ä¸ªæ–¹æ³•

è¯·æ³¨æ„ `123456..toString(36)` ä¸­çš„ä¸¤ä¸ªç‚¹ä¸æ˜¯æ‰“é”™äº†ã€‚å¦‚æœæˆ‘ä»¬æƒ³ç›´æ¥åœ¨ä¸€ä¸ªæ•°å­—ä¸Šè°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œæ¯”å¦‚ä¸Šé¢ä¾‹å­ä¸­çš„ toStringï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨å®ƒåé¢æ”¾ç½®ä¸¤ä¸ªç‚¹ `..`ã€‚

å¦‚æœæˆ‘ä»¬æ”¾ç½®ä¸€ä¸ªç‚¹ï¼š`123456.toString(36)`ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°ä¸€ä¸ª `error`ï¼Œå› ä¸º `JavaScript` è¯­æ³•éšå«äº†ç¬¬ä¸€ä¸ªç‚¹ä¹‹åçš„éƒ¨åˆ†ä¸ºå°æ•°éƒ¨åˆ†ã€‚å¦‚æœæˆ‘ä»¬å†æ”¾ä¸€ä¸ªç‚¹ï¼Œé‚£ä¹ˆ `JavaScript` å°±çŸ¥é“å°æ•°éƒ¨åˆ†ä¸ºç©ºï¼Œç°åœ¨ä½¿ç”¨è¯¥æ–¹æ³•ã€‚

ä¹Ÿå¯ä»¥å†™æˆ `(123456).toString(36)`ã€‚

## 2.4. èˆå…¥

èˆå…¥`ï¼ˆroundingï¼‰`æ˜¯ä½¿ç”¨æ•°å­—æ—¶æœ€å¸¸ç”¨çš„æ“ä½œä¹‹ä¸€ã€‚

è¿™é‡Œæœ‰å‡ ä¸ªå¯¹æ•°å­—è¿›è¡Œèˆå…¥çš„å†…å»ºå‡½æ•°ï¼š

- `Math.floor`
  å‘ä¸‹èˆå…¥ï¼š3.1 å˜æˆ 3ï¼Œ-1.1 å˜æˆ -2ã€‚
- `Math.ceil`
  å‘ä¸Šèˆå…¥ï¼š3.1 å˜æˆ 4ï¼Œ-1.1 å˜æˆ -1ã€‚
- `Math.round`
  å‘æœ€è¿‘çš„æ•´æ•°èˆå…¥ï¼š3.1 å˜æˆ 3ï¼Œ3.6 å˜æˆ 4ï¼Œ-1.1 å˜æˆ -1ã€‚
- `Math.trunc`ï¼ˆIE æµè§ˆå™¨ä¸æ”¯æŒè¿™ä¸ªæ–¹æ³•ï¼‰
  ç§»é™¤å°æ•°ç‚¹åçš„æ‰€æœ‰å†…å®¹è€Œæ²¡æœ‰èˆå…¥ï¼š3.1 å˜æˆ 3ï¼Œ-1.1 å˜æˆ -1ã€‚

è¿™ä¸ªæ˜¯æ€»ç»“å®ƒä»¬ä¹‹é—´å·®å¼‚çš„è¡¨æ ¼ï¼š

<p></p>|Math.floor	|Math.ceil	|Math.round	|Math.trunc
--|--|--|--|--|--
3.1	|3	|4	|3	|3
3.6	|3	|4	|4	|3
-1.1	|-2	|-1	|-1	|-1
-1.6	|-2	|-1	|-2	|-1

è¿™äº›å‡½æ•°æ¶µç›–äº†å¤„ç†æ•°å­—å°æ•°éƒ¨åˆ†çš„æ‰€æœ‰å¯èƒ½æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å°†æ•°å­—èˆå…¥åˆ°å°æ•°ç‚¹å `n` ä½ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ

ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ 1.2345ï¼Œå¹¶ä¸”æƒ³æŠŠå®ƒèˆå…¥åˆ°å°æ•°ç‚¹åä¸¤ä½ï¼Œä»…å¾—åˆ° 1.23ã€‚

æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥å®ç°è¿™ä¸ªéœ€æ±‚ï¼š

1. ä¹˜é™¤æ³•

   ä¾‹å¦‚ï¼Œè¦å°†æ•°å­—èˆå…¥åˆ°å°æ•°ç‚¹åä¸¤ä½ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°å­—ä¹˜ä»¥ 100ï¼Œè°ƒç”¨èˆå…¥å‡½æ•°ï¼Œç„¶åå†å°†å…¶é™¤å›ã€‚

   ```js
   let num = 1.23456;

   alert(Math.floor(num * 100) / 100); // 1.23456 -> 123.456 -> 123 -> 1.23
   ```

2. å‡½æ•° [toFixed(n)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toFixed) å°†æ•°å­—èˆå…¥åˆ°å°æ•°ç‚¹å n ä½ï¼Œå¹¶ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ç»“æœã€‚
   ```js
   let num = 12.34;
   alert(num.toFixed(1)); // "12.3"
   ```
   è¿™ä¼šå‘ä¸Šæˆ–å‘ä¸‹èˆå…¥åˆ°æœ€æ¥è¿‘çš„å€¼ï¼Œç±»ä¼¼äº `Math.round`ï¼š
   ```js
   let num = 12.36;
   alert(num.toFixed(1)); // "12.4"
   ```
   è¯·æ³¨æ„ `toFixed` çš„ç»“æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å¦‚æœå°æ•°éƒ¨åˆ†æ¯”æ‰€éœ€è¦çš„çŸ­ï¼Œåˆ™åœ¨ç»“å°¾æ·»åŠ é›¶ï¼š
   ```js
   let num = 12.34;
   alert(num.toFixed(5)); // "12.34000"ï¼Œåœ¨ç»“å°¾æ·»åŠ äº† 0ï¼Œä»¥è¾¾åˆ°å°æ•°ç‚¹åäº”ä½
   ```
   æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€å…ƒåŠ å·æˆ– `Number()` è°ƒç”¨ï¼Œå°†å…¶è½¬æ¢ä¸ºæ•°å­—ï¼š`+ num.toFixed(5)`ã€‚

## 2.5. ä¸ç²¾ç¡®çš„è®¡ç®—

åœ¨å†…éƒ¨ï¼Œæ•°å­—æ˜¯ä»¥ 64 ä½æ ¼å¼ [IEEE-754](http://en.wikipedia.org/wiki/IEEE_754-1985) è¡¨ç¤ºçš„ï¼Œæ‰€ä»¥æ­£å¥½æœ‰ 64 ä½å¯ä»¥å­˜å‚¨ä¸€ä¸ªæ•°å­—ï¼šå…¶ä¸­ 52 ä½è¢«ç”¨äºå­˜å‚¨è¿™äº›æ•°å­—ï¼Œå…¶ä¸­ 11 ä½ç”¨äºå­˜å‚¨å°æ•°ç‚¹çš„ä½ç½®ï¼ˆå¯¹äºæ•´æ•°ï¼Œå®ƒä»¬ä¸ºé›¶ï¼‰ï¼Œè€Œ 1 ä½ç”¨äºç¬¦å·ã€‚

å¦‚æœä¸€ä¸ªæ•°å­—å¤ªå¤§ï¼Œåˆ™ä¼šæº¢å‡º 64 ä½å­˜å‚¨ï¼Œå¹¶å¯èƒ½ä¼šå¯¼è‡´æ— ç©·å¤§ï¼š

```js
alert(1e500); // Infinity
```

è¿™å¯èƒ½ä¸é‚£ä¹ˆæ˜æ˜¾ï¼Œä½†ç»å¸¸ä¼šå‘ç”Ÿçš„æ˜¯ï¼Œç²¾åº¦çš„æŸå¤±ã€‚

è€ƒè™‘ä¸‹è¿™ä¸ªï¼ˆfalsyï¼ï¼‰æµ‹è¯•ï¼š

```js
alert(0.1 + 0.2 == 0.3); // false
```

æ²¡é”™ï¼Œå¦‚æœæˆ‘ä»¬æ£€æŸ¥ `0.1` å’Œ `0.2` çš„æ€»å’Œæ˜¯å¦ä¸º `0.3`ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ° falseã€‚

å¥‡äº†æ€ªäº†ï¼å¦‚æœä¸æ˜¯ 0.3ï¼Œé‚£èƒ½æ˜¯å•¥ï¼Ÿ

```js
alert(0.1 + 0.2); // 0.30000000000000004
```

å“å“Ÿï¼è¿™ä¸ªé”™è¯¯æ¯”ä¸æ­£ç¡®çš„æ¯”è¾ƒçš„åæœæ›´ä¸¥é‡ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ åˆ›å»ºäº†ä¸€ä¸ªç”µå­è´­ç‰©ç½‘ç«™ï¼Œå¦‚æœè®¿é—®è€…å°†ä»·æ ¼ä¸º `Â¥ 0.10` å’Œ `Â¥ 0.20` çš„å•†å“æ”¾å…¥äº†ä»–çš„è´­ç‰©è½¦ã€‚è®¢å•æ€»é¢å°†æ˜¯ `Â¥ 0.30000000000000004`ã€‚è¿™ä¼šè®©ä»»ä½•äººæ„Ÿåˆ°æƒŠè®¶ã€‚

ä½†ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿ

ä¸€ä¸ªæ•°å­—ä»¥å…¶äºŒè¿›åˆ¶çš„å½¢å¼å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä¸€ä¸ª `1` å’Œ `0`çš„åºåˆ—ã€‚ä½†æ˜¯åœ¨åè¿›åˆ¶æ•°å­—ç³»ç»Ÿä¸­çœ‹èµ·æ¥å¾ˆç®€å•çš„ `0.1`ï¼Œ`0.2` è¿™æ ·çš„å°æ•°ï¼Œå®é™…ä¸Šåœ¨äºŒè¿›åˆ¶å½¢å¼ä¸­æ˜¯æ— é™å¾ªç¯å°æ•°ã€‚

æ¢å¥è¯è¯´ï¼Œä»€ä¹ˆæ˜¯ `0.1`ï¼Ÿ`0.1` å°±æ˜¯ `1` é™¤ä»¥ `10`ï¼Œ`1/10`ï¼Œå³ååˆ†ä¹‹ä¸€ã€‚åœ¨åè¿›åˆ¶æ•°å­—ç³»ç»Ÿä¸­ï¼Œè¿™æ ·çš„æ•°å­—è¡¨ç¤ºèµ·æ¥å¾ˆå®¹æ˜“ã€‚å°†å…¶ä¸ä¸‰åˆ†ä¹‹ä¸€è¿›è¡Œæ¯”è¾ƒï¼š`1/3`ã€‚ä¸‰åˆ†ä¹‹ä¸€å˜æˆäº†æ— é™å¾ªç¯å°æ•° `0.33333(3)`ã€‚

åœ¨åè¿›åˆ¶æ•°å­—ç³»ç»Ÿä¸­ï¼Œå¯ä»¥ä¿è¯ä»¥ `10` çš„æ•´æ•°æ¬¡å¹‚ä½œä¸ºé™¤æ•°èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯ä»¥ `3` ä½œä¸ºé™¤æ•°åˆ™ä¸èƒ½ã€‚ä¹Ÿæ˜¯åŒæ ·çš„åŸå› ï¼Œåœ¨äºŒè¿›åˆ¶æ•°å­—ç³»ç»Ÿä¸­ï¼Œå¯ä»¥ä¿è¯ä»¥ `2` çš„æ•´æ•°æ¬¡å¹‚ä½œä¸ºé™¤æ•°æ—¶èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œä½† `1/10` å°±å˜æˆäº†ä¸€ä¸ªæ— é™å¾ªç¯çš„äºŒè¿›åˆ¶å°æ•°ã€‚

ä½¿ç”¨äºŒè¿›åˆ¶æ•°å­—ç³»ç»Ÿæ— æ³• **ç²¾ç¡®** å­˜å‚¨ `0.1` æˆ– `0.2`ï¼Œå°±åƒæ²¡æœ‰åŠæ³•å°†ä¸‰åˆ†ä¹‹ä¸€å­˜å‚¨ä¸ºåè¿›åˆ¶å°æ•°ä¸€æ ·ã€‚

IEEE-754 æ•°å­—æ ¼å¼é€šè¿‡å°†æ•°å­—èˆå…¥åˆ°æœ€æ¥è¿‘çš„å¯èƒ½æ•°å­—æ¥è§£å†³æ­¤é—®é¢˜ã€‚è¿™äº›èˆå…¥è§„åˆ™é€šå¸¸ä¸å…è®¸æˆ‘ä»¬çœ‹åˆ°â€œæå°çš„ç²¾åº¦æŸå¤±â€ï¼Œä½†æ˜¯å®ƒç¡®å®å­˜åœ¨ã€‚

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š

```js
alert((0.1).toFixed(20)); // 0.10000000000000000555
```

å½“æˆ‘ä»¬å¯¹ä¸¤ä¸ªæ•°å­—è¿›è¡Œæ±‚å’Œæ—¶ï¼Œå®ƒä»¬çš„â€œç²¾åº¦æŸå¤±â€ä¼šå åŠ èµ·æ¥ã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ`0.1 + 0.2` ä¸ç­‰äº `0.3`ã€‚

> :information_source: ä¸ä»…ä»…æ˜¯ JavaScript
> è®¸å¤šå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¹Ÿå­˜åœ¨åŒæ ·çš„é—®é¢˜ã€‚

PHPï¼ŒJavaï¼ŒCï¼ŒPerlï¼ŒRuby ç»™å‡ºçš„ä¹Ÿæ˜¯å®Œå…¨ç›¸åŒçš„ç»“æœï¼Œå› ä¸ºå®ƒä»¬åŸºäºçš„æ˜¯ç›¸åŒçš„æ•°å­—æ ¼å¼ã€‚

æˆ‘ä»¬èƒ½è§£å†³è¿™ä¸ªé—®é¢˜å—ï¼Ÿå½“ç„¶ï¼Œæœ€å¯é çš„æ–¹æ³•æ˜¯å€ŸåŠ©æ–¹æ³• `toFixed(n)` å¯¹ç»“æœè¿›è¡Œèˆå…¥ï¼š

```js
let sum = 0.1 + 0.2;
alert(sum.toFixed(2)); // 0.30
```

è¯·æ³¨æ„ï¼Œ`toFixed` æ€»æ˜¯è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å®ƒç¡®ä¿å°æ•°ç‚¹åæœ‰ 2 ä½æ•°å­—ã€‚å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªç”µå­è´­ç‰©ç½‘ç«™ï¼Œå¹¶éœ€è¦æ˜¾ç¤º `Â¥ 0.30`ï¼Œè¿™å®é™…ä¸Šå¾ˆæ–¹ä¾¿ã€‚å¯¹äºå…¶ä»–æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€å…ƒåŠ å·å°†å…¶å¼ºåˆ¶è½¬æ¢ä¸ºä¸€ä¸ªæ•°å­—ï¼š

```js
let sum = 0.1 + 0.2;
alert(+sum.toFixed(2)); // 0.3
```

æˆ‘ä»¬å¯ä»¥å°†æ•°å­—ä¸´æ—¶ä¹˜ä»¥ 100ï¼ˆæˆ–æ›´å¤§çš„æ•°å­—ï¼‰ï¼Œå°†å…¶è½¬æ¢ä¸ºæ•´æ•°ï¼Œè¿›è¡Œæ•°å­¦è¿ç®—ï¼Œç„¶åå†é™¤å›ã€‚å½“æˆ‘ä»¬ä½¿ç”¨æ•´æ•°è¿›è¡Œæ•°å­¦è¿ç®—æ—¶ï¼Œè¯¯å·®ä¼šæœ‰æ‰€å‡å°‘ï¼Œä½†ä»ç„¶å¯ä»¥åœ¨é™¤æ³•ä¸­å¾—åˆ°ï¼š

```js
alert((0.1 * 10 + 0.2 * 10) / 10); // 0.3
alert((0.28 * 100 + 0.14 * 100) / 100); // 0.4200000000000001
```

å› æ­¤ï¼Œä¹˜/é™¤æ³•å¯ä»¥å‡å°‘è¯¯å·®ï¼Œä½†ä¸èƒ½å®Œå…¨æ¶ˆé™¤è¯¯å·®ã€‚

æœ‰æ—¶å€™æˆ‘ä»¬å¯ä»¥å°è¯•å®Œå…¨é¿å…å°æ•°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªç”µå­è´­ç‰©ç½‘ç«™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨è§’è€Œä¸æ˜¯å…ƒæ¥å­˜å‚¨ä»·æ ¼ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬è¦æ‰“ 30% çš„æŠ˜æ‰£å‘¢ï¼Ÿå®é™…ä¸Šï¼Œå®Œå…¨é¿å…å°æ•°å¤„ç†å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚åªéœ€è¦åœ¨å¿…è¦æ—¶å‰ªæ‰å…¶â€œå°¾å·´â€æ¥å¯¹å…¶è¿›è¡Œèˆå…¥å³å¯ã€‚

> :information_source:æœ‰è¶£çš„äº‹å„¿

å°è¯•è¿è¡Œä¸‹é¢è¿™æ®µä»£ç ï¼š

```js
// Helloï¼æˆ‘æ˜¯ä¸€ä¸ªä¼šè‡ªæˆ‘å¢åŠ çš„æ•°å­—ï¼
alert(9999999999999999); // æ˜¾ç¤º 10000000000000000
```

å‡ºç°äº†åŒæ ·çš„é—®é¢˜ï¼šç²¾åº¦æŸå¤±ã€‚æœ‰ 64 ä½æ¥è¡¨ç¤ºè¯¥æ•°å­—ï¼Œå…¶ä¸­ 52 ä½å¯ç”¨äºå­˜å‚¨æ•°å­—ï¼Œä½†è¿™è¿˜ä¸å¤Ÿã€‚æ‰€ä»¥æœ€ä¸é‡è¦çš„æ•°å­—å°±æ¶ˆå¤±äº†ã€‚

JavaScript ä¸ä¼šåœ¨æ­¤ç±»äº‹ä»¶ä¸­è§¦å‘ errorã€‚å®ƒä¼šå°½æœ€å¤§åŠªåŠ›ä½¿æ•°å­—ç¬¦åˆæ‰€éœ€çš„æ ¼å¼ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§æ ¼å¼ä¸å¤Ÿå¤§åˆ°æ»¡è¶³éœ€æ±‚ã€‚

> :information_source:ä¸¤ä¸ªé›¶
> æ•°å­—å†…éƒ¨è¡¨ç¤ºçš„å¦ä¸€ä¸ªæœ‰è¶£ç»“æœæ˜¯å­˜åœ¨ä¸¤ä¸ªé›¶ï¼š0 å’Œ -0ã€‚

è¿™æ˜¯å› ä¸ºåœ¨å­˜å‚¨æ—¶ï¼Œä½¿ç”¨ä¸€ä½æ¥å­˜å‚¨ç¬¦å·ï¼Œå› æ­¤å¯¹äºåŒ…æ‹¬é›¶åœ¨å†…çš„ä»»ä½•æ•°å­—ï¼Œå¯ä»¥è®¾ç½®è¿™ä¸€ä½æˆ–è€…ä¸è®¾ç½®ã€‚

åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ç§åŒºåˆ«å¹¶ä¸æ˜æ˜¾ï¼Œå› ä¸ºè¿ç®—ç¬¦å°†å®ƒä»¬è§†ä¸ºç›¸åŒçš„å€¼ã€‚

## 2.6. æµ‹è¯•ï¼šisFinite å’Œ isNaN

è¿˜è®°å¾—è¿™ä¸¤ä¸ªç‰¹æ®Šçš„æ•°å€¼å—ï¼Ÿ

- `Infinity`ï¼ˆå’Œ `-Infinity`ï¼‰æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ•°å€¼ï¼Œæ¯”ä»»ä½•æ•°å€¼éƒ½å¤§ï¼ˆå°ï¼‰ã€‚
- NaN ä»£è¡¨ä¸€ä¸ª errorã€‚

å®ƒä»¬å±äº `number` ç±»å‹ï¼Œä½†ä¸æ˜¯â€œæ™®é€šâ€æ•°å­—ï¼Œå› æ­¤ï¼Œè¿™é‡Œæœ‰ç”¨äºæ£€æŸ¥å®ƒä»¬çš„ç‰¹æ®Šå‡½æ•°ï¼š

- `isNaN(value)` å°†å…¶å‚æ•°è½¬æ¢ä¸ºæ•°å­—ï¼Œç„¶åæµ‹è¯•å®ƒæ˜¯å¦ä¸º NaNï¼š
  ```js
  alert(isNaN(NaN)); // true
  alert(isNaN("str")); // true
  ```
  ä½†æ˜¯æˆ‘ä»¬éœ€è¦è¿™ä¸ªå‡½æ•°å—ï¼Ÿæˆ‘ä»¬ä¸èƒ½åªä½¿ç”¨ === NaN æ¯”è¾ƒå—ï¼Ÿä¸å¥½æ„æ€ï¼Œè¿™ä¸è¡Œã€‚å€¼ â€œNaNâ€ æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå®ƒä¸ç­‰äºä»»ä½•ä¸œè¥¿ï¼ŒåŒ…æ‹¬å®ƒè‡ªèº«ï¼š
  ```js
  alert(NaN === NaN); // false
  ```
- `isFinite(value)` å°†å…¶å‚æ•°è½¬æ¢ä¸ºæ•°å­—ï¼Œå¦‚æœæ˜¯å¸¸è§„æ•°å­—ï¼Œåˆ™è¿”å› trueï¼Œè€Œä¸æ˜¯ NaN/Infinity/-Infinityï¼š
  `js alert( isFinite("15") ); // true alert( isFinite("str") ); // falseï¼Œå› ä¸ºæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å€¼ï¼šNaN alert( isFinite(Infinity) ); // falseï¼Œå› ä¸ºæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å€¼ï¼šInfinity`
  æœ‰æ—¶ `isFinite` è¢«ç”¨äºéªŒè¯å­—ç¬¦ä¸²å€¼æ˜¯å¦ä¸ºå¸¸è§„æ•°å­—ï¼š

  ````js
  let num = +prompt("Enter a number", '');

      // ç»“æœä¼šæ˜¯ trueï¼Œé™¤éä½ è¾“å…¥çš„æ˜¯ Infinityã€-Infinity æˆ–ä¸æ˜¯æ•°å­—
      alert( isFinite(num) );
      ```
      è¯·æ³¨æ„ï¼Œåœ¨æ‰€æœ‰æ•°å­—å‡½æ•°ä¸­ï¼ŒåŒ…æ‹¬ `isFinite`ï¼Œç©ºå­—ç¬¦ä¸²æˆ–ä»…æœ‰ç©ºæ ¼çš„å­—ç¬¦ä¸²å‡è¢«è§†ä¸º `0`ã€‚

  > :information_source:ä¸ `Object.is` è¿›è¡Œæ¯”è¾ƒ
  ````

æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å†…å»ºæ–¹æ³• [Object.is](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/is)ï¼Œå®ƒç±»ä¼¼äº === ä¸€æ ·å¯¹å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä½†å®ƒå¯¹äºä¸¤ç§è¾¹ç¼˜æƒ…å†µæ›´å¯é ï¼š

1. å®ƒé€‚ç”¨äº NaNï¼š`Object.isï¼ˆNaNï¼ŒNaNï¼‰=== true`ï¼Œè¿™æ˜¯ä»¶å¥½äº‹ã€‚
2. å€¼ 0 å’Œ -0 æ˜¯ä¸åŒçš„ï¼š`Object.isï¼ˆ0ï¼Œ-0ï¼‰=== false`ï¼Œä»æŠ€æœ¯ä¸Šè®²è¿™æ˜¯å¯¹çš„ï¼Œå› ä¸ºåœ¨å†…éƒ¨ï¼Œæ•°å­—çš„ç¬¦å·ä½å¯èƒ½ä¼šä¸åŒï¼Œå³ä½¿å…¶ä»–æ‰€æœ‰ä½å‡ä¸ºé›¶ã€‚

åœ¨æ‰€æœ‰å…¶ä»–æƒ…å†µä¸‹ï¼Œ`Object.is(aï¼Œb) ä¸ a === b` ç›¸åŒã€‚

è¿™ç§æ¯”è¾ƒæ–¹å¼ç»å¸¸è¢«ç”¨åœ¨ JavaScript è§„èŒƒä¸­ã€‚å½“å†…éƒ¨ç®—æ³•éœ€è¦æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦å®Œå…¨ç›¸åŒæ—¶ï¼Œå®ƒä½¿ç”¨ `Object.is`ï¼ˆå†…éƒ¨ç§°ä¸º [SameValue](https://tc39.github.io/ecma262/#sec-samevalue)ï¼‰ã€‚

## 2.7. parseInt å’Œ parseFloat

ä½¿ç”¨åŠ å· `+` æˆ–`Number()` çš„æ•°å­—è½¬æ¢æ˜¯ä¸¥æ ¼çš„ã€‚å¦‚æœä¸€ä¸ªå€¼ä¸å®Œå…¨æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå°±ä¼šå¤±è´¥ï¼š

```js
alert(+"100px"); // NaN
```

å”¯ä¸€çš„ä¾‹å¤–æ˜¯å­—ç¬¦ä¸²å¼€å¤´æˆ–ç»“å°¾çš„ç©ºæ ¼ï¼Œå› ä¸ºå®ƒä»¬ä¼šè¢«å¿½ç•¥ã€‚

ä½†åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæœ‰å¸¦æœ‰å•ä½çš„å€¼ï¼Œä¾‹å¦‚ CSS ä¸­çš„ `"100px"` æˆ– `"12pt"`ã€‚å¹¶ä¸”ï¼Œåœ¨å¾ˆå¤šå›½å®¶ï¼Œè´§å¸ç¬¦å·æ˜¯ç´§éšé‡‘é¢ä¹‹åçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ `"19â‚¬"`ï¼Œå¹¶å¸Œæœ›ä»ä¸­æå–å‡ºä¸€ä¸ªæ•°å€¼ã€‚

è¿™å°±æ˜¯ `parseInt` å’Œ `parseFloat` çš„ä½œç”¨ã€‚

å®ƒä»¬å¯ä»¥ä»å­—ç¬¦ä¸²ä¸­â€œè¯»å–â€æ•°å­—ï¼Œç›´åˆ°æ— æ³•è¯»å–ä¸ºæ­¢ã€‚å¦‚æœå‘ç”Ÿ errorï¼Œåˆ™è¿”å›æ”¶é›†åˆ°çš„æ•°å­—ã€‚å‡½æ•° `parseInt` è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè€Œ `parseFloat` è¿”å›ä¸€ä¸ªæµ®ç‚¹æ•°ï¼š

```js
alert(parseInt("100px")); // 100
alert(parseFloat("12.5em")); // 12.5

alert(parseInt("12.3")); // 12ï¼Œåªæœ‰æ•´æ•°éƒ¨åˆ†è¢«è¿”å›äº†
alert(parseFloat("12.3.4")); // 12.3ï¼Œåœ¨ç¬¬äºŒä¸ªç‚¹å‡ºåœæ­¢äº†è¯»å–
```

æŸäº›æƒ…å†µä¸‹ï¼Œ`parseInt/parseFloat` ä¼šè¿”å› `NaN`ã€‚å½“æ²¡æœ‰æ•°å­—å¯è¯»æ—¶ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼š

```js
alert(parseInt("a123")); // NaNï¼Œç¬¬ä¸€ä¸ªç¬¦å·åœæ­¢äº†è¯»å–
```

> :information_source:`parseInt(str, radix)` çš„ç¬¬äºŒä¸ªå‚æ•°

`parseInt()` å‡½æ•°å…·æœ‰å¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚å®ƒæŒ‡å®šäº†æ•°å­—ç³»ç»Ÿçš„åŸºæ•°ï¼Œå› æ­¤ parseInt è¿˜å¯ä»¥è§£æåå…­è¿›åˆ¶æ•°å­—ã€äºŒè¿›åˆ¶æ•°å­—ç­‰çš„å­—ç¬¦ä¸²ï¼š

```js
alert(parseInt("0xff", 16)); // 255
alert(parseInt("ff", 16)); // 255ï¼Œæ²¡æœ‰ 0x ä»ç„¶æœ‰æ•ˆ

alert(parseInt("2n9c", 36)); // 123456
```

## 2.8. å…¶ä»–æ•°å­¦å‡½æ•°

JavaScript æœ‰ä¸€ä¸ªå†…å»ºçš„ [Math](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Math) å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ä¸€ä¸ªå°å‹çš„æ•°å­¦å‡½æ•°å’Œå¸¸é‡åº“ã€‚

å‡ ä¸ªä¾‹å­ï¼š
`Math.random()`

è¿”å›ä¸€ä¸ªä» 0 åˆ° 1 çš„éšæœºæ•°ï¼ˆä¸åŒ…æ‹¬ 1ï¼‰

```js
alert(Math.random()); // 0.1234567894322
alert(Math.random()); // 0.5435252343232
alert(Math.random()); // ... (ä»»ä½•éšæœºæ•°)
```

`Math.max(a, b, c...)` / `Math.min(a, b, c...)`

ä»ä»»æ„æ•°é‡çš„å‚æ•°ä¸­è¿”å›æœ€å¤§/æœ€å°å€¼ã€‚

```js
alert(Math.max(3, 5, -10, 0, 1));
alert(Math.min(1, 2)); // 1
```

`Math.pow(n, power)`

è¿”å› n çš„ç»™å®šï¼ˆpowerï¼‰æ¬¡å¹‚

```js
alert(Math.pow(2, 10)); // 2 çš„ 10 æ¬¡å¹‚ = 1024
```

`Math` å¯¹è±¡ä¸­è¿˜æœ‰æ›´å¤šå‡½æ•°å’Œå¸¸é‡ï¼ŒåŒ…æ‹¬ä¸‰è§’å‡½æ•°ï¼Œä½ å¯ä»¥åœ¨ [Math å‡½æ•°æ–‡æ¡£](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Math) ä¸­æ‰¾åˆ°è¿™äº›å†…å®¹ã€‚

## 2.9. æ€»ç»“

è¦å†™æœ‰å¾ˆå¤šé›¶çš„æ•°å­—ï¼š

- å°† `"e"` å’Œ 0 çš„æ•°é‡é™„åŠ åˆ°æ•°å­—åã€‚å°±åƒï¼š`123e6` ä¸ 123 åé¢æ¥ 6 ä¸ª 0 ç›¸åŒã€‚
- `"e"` åé¢çš„è´Ÿæ•°å°†ä½¿æ•°å­—é™¤ä»¥ 1 åé¢æ¥ç€ç»™å®šæ•°é‡çš„é›¶çš„æ•°å­—ã€‚ä¾‹å¦‚ 123e-6 è¡¨ç¤º 0.000123ï¼ˆ123 çš„ç™¾ä¸‡åˆ†ä¹‹ä¸€ï¼‰ã€‚

å¯¹äºä¸åŒçš„æ•°å­—ç³»ç»Ÿï¼š

- å¯ä»¥ç›´æ¥åœ¨åå…­è¿›åˆ¶ï¼ˆ0xï¼‰ï¼Œå…«è¿›åˆ¶ï¼ˆ0oï¼‰å’ŒäºŒè¿›åˆ¶ï¼ˆ0bï¼‰ç³»ç»Ÿä¸­å†™å…¥æ•°å­—ã€‚
- parseInt(strï¼Œbase) å°†å­—ç¬¦ä¸² str è§£æä¸ºåœ¨ç»™å®šçš„ base æ•°å­—ç³»ç»Ÿä¸­çš„æ•´æ•°ï¼Œ2 â‰¤ base â‰¤ 36ã€‚
- num.toString(base) å°†æ•°å­—è½¬æ¢ä¸ºåœ¨ç»™å®šçš„ base æ•°å­—ç³»ç»Ÿä¸­çš„å­—ç¬¦ä¸²ã€‚

è¦å°† 12pt å’Œ 100px ä¹‹ç±»çš„å€¼è½¬æ¢ä¸ºæ•°å­—ï¼š

- ä½¿ç”¨ parseInt/parseFloat è¿›è¡Œâ€œè½¯â€è½¬æ¢ï¼Œå®ƒä»å­—ç¬¦ä¸²ä¸­è¯»å–æ•°å­—ï¼Œç„¶åè¿”å›åœ¨å‘ç”Ÿ error å‰å¯ä»¥è¯»å–åˆ°çš„å€¼ã€‚

å°æ•°ï¼š

- ä½¿ç”¨ Math.floorï¼ŒMath.ceilï¼ŒMath.truncï¼ŒMath.round æˆ– num.toFixed(precision) è¿›è¡Œèˆå…¥ã€‚
- è¯·ç¡®ä¿è®°ä½ä½¿ç”¨å°æ•°æ—¶ä¼šæŸå¤±ç²¾åº¦ã€‚

æ›´å¤šæ•°å­¦å‡½æ•°ï¼š

éœ€è¦æ—¶è¯·æŸ¥çœ‹ [Math](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Math) å¯¹è±¡ã€‚è¿™ä¸ªåº“å¾ˆå°ï¼Œä½†æ˜¯å¯ä»¥æ»¡è¶³åŸºæœ¬çš„éœ€æ±‚ã€‚

# 3. å­—ç¬¦ä¸²

åœ¨ JavaScript ä¸­ï¼Œæ–‡æœ¬æ•°æ®è¢«ä»¥å­—ç¬¦ä¸²å½¢å¼å­˜å‚¨ï¼Œå•ä¸ªå­—ç¬¦æ²¡æœ‰å•ç‹¬çš„ç±»å‹ã€‚

å­—ç¬¦ä¸²çš„å†…éƒ¨æ ¼å¼å§‹ç»ˆæ˜¯ [UTF-16](https://en.wikipedia.org/wiki/UTF-16)ï¼Œå®ƒä¸ä¾èµ–äºé¡µé¢ç¼–ç ã€‚

## 3.1. å¼•å·ï¼ˆQuotesï¼‰

è®©æˆ‘ä»¬å›å¿†ä¸€ä¸‹å¼•å·çš„ç§ç±»ã€‚

å­—ç¬¦ä¸²å¯ä»¥åŒ…å«åœ¨å•å¼•å·ã€åŒå¼•å·æˆ–åå¼•å·ä¸­ï¼š

```js
let single = "single-quoted";
let double = "double-quoted";

let backticks = `backticks`;
```

å•å¼•å·å’ŒåŒå¼•å·åŸºæœ¬ç›¸åŒã€‚ä½†æ˜¯ï¼Œåå¼•å·å…è®¸æˆ‘ä»¬é€šè¿‡ `${â€¦}` å°†ä»»ä½•è¡¨è¾¾å¼åµŒå…¥åˆ°å­—ç¬¦ä¸²ä¸­ï¼š

```js
function sum(a, b) {
  return a + b;
}

alert(`1 + 2 = ${sum(1, 2)}.`); // 1 + 2 = 3.
```

ä½¿ç”¨åå¼•å·çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯å®ƒä»¬å…è®¸å­—ç¬¦ä¸²è·¨è¡Œï¼š

```js
let guestList = `Guests:
 * John
 * Pete
 * Mary
`;

alert(guestList); // å®¢äººæ¸…å•ï¼Œå¤šè¡Œ
```

çœ‹èµ·æ¥å¾ˆè‡ªç„¶ï¼Œä¸æ˜¯å—ï¼Ÿä½†æ˜¯å•å¼•å·å’ŒåŒå¼•å·å¯ä¸èƒ½è¿™æ ·åšã€‚

å¦‚æœæˆ‘ä»¬ä½¿ç”¨å•å¼•å·æˆ–åŒå¼•å·æ¥å®ç°å­—ç¬¦ä¸²è·¨è¡Œçš„è¯ï¼Œåˆ™ä¼šå‡ºç°é”™è¯¯ï¼š

```js
let guestList = "Guests: // Error: Unexpected token ILLEGAL
  * John";
```

å½“ä¸è€ƒè™‘å¤šè¡Œå­—ç¬¦ä¸²çš„éœ€è¦æ—¶ï¼Œå•å¼•å·å’ŒåŒå¼•å·æ¥è‡ªè¯­è¨€åˆ›å»ºçš„å¤æ—¶ä»£ã€‚åå¼•å·å‡ºç°è¾ƒæ™šï¼Œå› æ­¤æ›´é€šç”¨ã€‚

åå¼•å·è¿˜å…è®¸æˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªåå¼•å·ä¹‹å‰æŒ‡å®šä¸€ä¸ªâ€œæ¨¡ç‰ˆå‡½æ•°â€ã€‚è¯­æ³•æ˜¯ï¼š`func string`ã€‚å‡½æ•° func è¢«è‡ªåŠ¨è°ƒç”¨ï¼Œæ¥æ”¶å­—ç¬¦ä¸²å’ŒåµŒå…¥å¼è¡¨è¾¾å¼ï¼Œå¹¶å¤„ç†å®ƒä»¬ã€‚ä½ å¯ä»¥åœ¨[docs](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Template_literals#Tagged_template_literals)ä¸­é˜…è¯»æ›´å¤šå…³äºå®ƒä»¬çš„ä¿¡æ¯ã€‚è¿™å«åš â€œtagged templatesâ€ã€‚æ­¤åŠŸèƒ½å¯ä»¥æ›´è½»æ¾åœ°å°†å­—ç¬¦ä¸²åŒ…è£…åˆ°è‡ªå®šä¹‰æ¨¡ç‰ˆæˆ–å…¶ä»–å‡½æ•°ä¸­ï¼Œä½†è¿™å¾ˆå°‘ä½¿ç”¨ã€‚

## 3.2. ç‰¹æ®Šå­—ç¬¦

æˆ‘ä»¬ä»ç„¶å¯ä»¥é€šè¿‡ä½¿ç”¨â€œæ¢è¡Œç¬¦ï¼ˆnewline characterï¼‰â€ï¼Œä»¥æ”¯æŒä½¿ç”¨å•å¼•å·å’ŒåŒå¼•å·æ¥åˆ›å»ºè·¨è¡Œå­—ç¬¦ä¸²ã€‚æ¢è¡Œç¬¦å†™ä½œ `\n`ï¼Œç”¨æ¥è¡¨ç¤ºæ¢è¡Œï¼š

```js
let guestList = "Guests:\n * John\n * Pete\n * Mary";

alert(guestList); // ä¸€ä¸ªå¤šè¡Œçš„å®¢äººåˆ—è¡¨
```

ä¾‹å¦‚ï¼Œè¿™ä¸¤è¡Œæè¿°çš„æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ä¹¦å†™æ–¹å¼ä¸åŒï¼š

```js
let str1 = "Hello\nWorld"; // ä½¿ç”¨â€œæ¢è¡Œç¬¦â€åˆ›å»ºçš„ä¸¤è¡Œå­—ç¬¦ä¸²

// ä½¿ç”¨åå¼•å·å’Œæ™®é€šçš„æ¢è¡Œåˆ›å»ºçš„ä¸¤è¡Œå­—ç¬¦ä¸²
let str2 = `Hello
World`;

alert(str1 == str2); // true
```

è¿˜æœ‰å…¶ä»–ä¸å¸¸è§çš„â€œç‰¹æ®Šâ€å­—ç¬¦ã€‚

è¿™æ˜¯å®Œæ•´åˆ—è¡¨ï¼š
å­—ç¬¦ |æè¿°
--|--
\n |æ¢è¡Œ
\r |å›è½¦ï¼šä¸å•ç‹¬ä½¿ç”¨ã€‚Windows æ–‡æœ¬æ–‡ä»¶ä½¿ç”¨ä¸¤ä¸ªå­—ç¬¦ \r\n çš„ç»„åˆæ¥è¡¨ç¤ºæ¢è¡Œã€‚
\', \" |å¼•å·
\\ |åæ–œçº¿
\t |åˆ¶è¡¨ç¬¦
\b, \f, \v |é€€æ ¼ï¼Œæ¢é¡µï¼Œå‚ç›´æ ‡ç­¾ â€”â€” ä¸ºäº†å…¼å®¹æ€§ï¼Œç°åœ¨å·²ç»ä¸ä½¿ç”¨äº†ã€‚
\xXX |å…·æœ‰ç»™å®šåå…­è¿›åˆ¶ Unicode XX çš„ Unicode å­—ç¬¦ï¼Œä¾‹å¦‚ï¼š'\x7A' å’Œ 'z' ç›¸åŒã€‚
\uXXXX |ä»¥ UTF-16 ç¼–ç çš„åå…­è¿›åˆ¶ä»£ç  XXXX çš„ unicode å­—ç¬¦ï¼Œä¾‹å¦‚ \u00A9 â€”â€” æ˜¯ç‰ˆæƒç¬¦å· Â© çš„ unicodeã€‚å®ƒå¿…é¡»æ­£å¥½æ˜¯ 4 ä¸ªåå…­è¿›åˆ¶æ•°å­—ã€‚
\u{Xâ€¦XXXXXX}ï¼ˆ1 åˆ° 6 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ï¼‰| å…·æœ‰ç»™å®š UTF-32 ç¼–ç çš„ unicode ç¬¦å·ã€‚ä¸€äº›ç½•è§çš„å­—ç¬¦ç”¨ä¸¤ä¸ª unicode ç¬¦å·ç¼–ç ï¼Œå ç”¨ 4 ä¸ªå­—èŠ‚ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ’å…¥é•¿ä»£ç äº†ã€‚

unicode ç¤ºä¾‹ï¼š

```js
alert("\u00A9"); // Â©
alert("\u{20331}"); // ä½«ï¼Œç½•è§çš„ä¸­å›½è±¡å½¢æ–‡å­—ï¼ˆé•¿ unicodeï¼‰
alert("\u{1F60D}"); // ğŸ˜ï¼Œç¬‘è„¸ç¬¦å·ï¼ˆå¦ä¸€ä¸ªé•¿ unicodeï¼‰
```

æ‰€æœ‰çš„ç‰¹æ®Šå­—ç¬¦éƒ½ä»¥åæ–œæ å­—ç¬¦ \ å¼€å§‹ã€‚å®ƒä¹Ÿè¢«ç§°ä¸ºâ€œè½¬ä¹‰å­—ç¬¦â€ã€‚

å¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨å­—ç¬¦ä¸²ä¸­æ’å…¥ä¸€ä¸ªå¼•å·ï¼Œæˆ‘ä»¬ä¹Ÿä¼šä½¿ç”¨å®ƒã€‚

ä¾‹å¦‚ï¼š

```js
alert("I'm the Walrus!"); // I'm the Walrus!
```

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨å†…éƒ¨å¼•å·å‰åŠ ä¸Šåæ–œæ  `\'`ï¼Œå¦åˆ™å®ƒå°†è¡¨ç¤ºå­—ç¬¦ä¸²ç»“æŸã€‚

å½“ç„¶ï¼Œåªæœ‰ä¸å¤–éƒ¨é—­åˆå¼•å·ç›¸åŒçš„å¼•å·æ‰éœ€è¦è½¬ä¹‰ã€‚å› æ­¤ï¼Œä½œä¸ºä¸€ä¸ªæ›´ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥æ”¹ç”¨åŒå¼•å·æˆ–è€…åå¼•å·ï¼š

```js
alert(`I'm the Walrus!`); // I'm the Walrus!
```

æ³¨æ„åæ–œæ  `\` åœ¨ JavaScript ä¸­ç”¨äºæ­£ç¡®è¯»å–å­—ç¬¦ä¸²ï¼Œç„¶åæ¶ˆå¤±ã€‚å†…å­˜ä¸­çš„å­—ç¬¦ä¸²æ²¡æœ‰ `\`ã€‚ä½ ä»ä¸Šè¿°ç¤ºä¾‹ä¸­çš„ `alert` å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚

ä½†æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨å­—ç¬¦ä¸²ä¸­æ˜¾ç¤ºä¸€ä¸ªå®é™…çš„åæ–œæ  `\` åº”è¯¥æ€ä¹ˆåšï¼Ÿ

æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼Œåªéœ€è¦å°†å…¶ä¹¦å†™ä¸¤æ¬¡ `\\`ï¼š

```js
alert(`The backslash: \\`); // The backslash: \
```

## 3.3. å­—ç¬¦ä¸²é•¿åº¦

`length` å±æ€§è¡¨ç¤ºå­—ç¬¦ä¸²é•¿åº¦ï¼š

```js
alert(`My\n`.length); // 3
```

æ³¨æ„ `\n` æ˜¯ä¸€ä¸ªå•ç‹¬çš„â€œç‰¹æ®Šâ€å­—ç¬¦ï¼Œæ‰€ä»¥é•¿åº¦ç¡®å®æ˜¯ 3ã€‚

> :warning:**length æ˜¯ä¸€ä¸ªå±æ€§**

æŒæ¡å…¶ä»–ç¼–ç¨‹è¯­è¨€çš„äººï¼Œæœ‰æ—¶ä¼šé”™è¯¯åœ°è°ƒç”¨ `str.length()` è€Œä¸æ˜¯ `str.length`ã€‚è¿™æ˜¯è¡Œä¸é€šçš„ã€‚

è¯·æ³¨æ„ `str.length` æ˜¯ä¸€ä¸ªæ•°å­—å±æ€§ï¼Œè€Œä¸æ˜¯å‡½æ•°ã€‚åé¢ä¸éœ€è¦æ·»åŠ æ‹¬å·ã€‚

## 3.4. è®¿é—®å­—ç¬¦

è¦è·å–åœ¨ `pos` ä½ç½®çš„ä¸€ä¸ªå­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ‹¬å· `[pos]` æˆ–è€…è°ƒç”¨ [str.charAt(pos)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/charAt) æ–¹æ³•ã€‚ç¬¬ä¸€ä¸ªå­—ç¬¦ä»é›¶ä½ç½®å¼€å§‹ï¼š

```js
let str = `Hello`;

// ç¬¬ä¸€ä¸ªå­—ç¬¦
alert(str[0]); // H
alert(str.charAt(0)); // H

// æœ€åä¸€ä¸ªå­—ç¬¦
alert(str[str.length - 1]); // o
```

æ–¹æ‹¬å·æ˜¯è·å–å­—ç¬¦çš„ä¸€ç§ç°ä»£åŒ–æ–¹æ³•ï¼Œè€Œ `charAt` æ˜¯å†å²åŸå› æ‰å­˜åœ¨çš„ã€‚

å®ƒä»¬ä¹‹é—´çš„å”¯ä¸€åŒºåˆ«æ˜¯ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ï¼Œ`[]` è¿”å› `undefined`ï¼Œè€Œ `charAt` è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼š

```js
let str = `Hello`;

alert(str[1000]); // undefined
alert(str.charAt(1000)); // ''ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ `for..of` éå†å­—ç¬¦ï¼š

```js
for (let char of "Hello") {
  alert(char); // H,e,l,l,oï¼ˆchar å˜ä¸º "H"ï¼Œç„¶åæ˜¯ "e"ï¼Œç„¶åæ˜¯ "l" ç­‰ï¼‰
}
```

## 3.5. å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„

åœ¨ JavaScript ä¸­ï¼Œå­—ç¬¦ä¸²ä¸å¯æ›´æ”¹ã€‚æ”¹å˜å­—ç¬¦æ˜¯ä¸å¯èƒ½çš„ã€‚

æˆ‘ä»¬è¯æ˜ä¸€ä¸‹ä¸ºä»€ä¹ˆä¸å¯èƒ½ï¼š

```js
let str = "Hi";

str[0] = "h"; // error
alert(str[0]); // æ— æ³•è¿è¡Œ
```

é€šå¸¸çš„è§£å†³æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶åˆ†é…ç»™ str è€Œä¸æ˜¯ä»¥å‰çš„å­—ç¬¦ä¸²ã€‚

ä¾‹å¦‚ï¼š

```js
let str = "Hi";

str = "h" + str[1]; // æ›¿æ¢å­—ç¬¦ä¸²

alert(str); // hi
```

åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°æ›´å¤šç›¸å…³ç¤ºä¾‹ã€‚

## 3.6. æ”¹å˜å¤§å°å†™

[toLowerCase()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/toLowerCase) å’Œ [toUpperCase()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/toUpperCase) æ–¹æ³•å¯ä»¥æ”¹å˜å¤§å°å†™ï¼š

```js
alert("Interface".toUpperCase()); // INTERFACE
alert("Interface".toLowerCase()); // interface
```

æˆ–è€…æˆ‘ä»¬æƒ³è¦ä½¿ä¸€ä¸ªå­—ç¬¦å˜æˆå°å†™ï¼š

```js
alert("Interface"[0].toLowerCase()); // 'i'
```

## 3.7. æŸ¥æ‰¾å­å­—ç¬¦ä¸²

åœ¨å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾å­å­—ç¬¦ä¸²æœ‰å¾ˆå¤šç§æ–¹æ³•ã€‚

### 3.7.1. str.indexOf

ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯ [str.indexOf(substr, pos)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/indexOf)ã€‚

å®ƒä»ç»™å®šä½ç½® `pos` å¼€å§‹ï¼Œåœ¨ `str` ä¸­æŸ¥æ‰¾ `substr`ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™è¿”å› `-1`ï¼Œå¦åˆ™è¿”å›åŒ¹é…æˆåŠŸçš„ä½ç½®ã€‚

ä¾‹å¦‚ï¼š

```js
let str = "Widget with id";

alert(str.indexOf("Widget")); // 0ï¼Œå› ä¸º 'Widget' ä¸€å¼€å§‹å°±è¢«æ‰¾åˆ°
alert(str.indexOf("widget")); // -1ï¼Œæ²¡æœ‰æ‰¾åˆ°ï¼Œæ£€ç´¢æ˜¯å¤§å°å†™æ•æ„Ÿçš„

alert(str.indexOf("id")); // 1ï¼Œ"id" åœ¨ä½ç½® 1 å¤„ï¼ˆâ€¦â€¦idget å’Œ idï¼‰
```

å¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°å…è®¸æˆ‘ä»¬ä»ç»™å®šçš„èµ·å§‹ä½ç½®å¼€å§‹æ£€ç´¢ã€‚

ä¾‹å¦‚ï¼Œ`"id"` ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®æ˜¯ `1`ã€‚æŸ¥è¯¢ä¸‹ä¸€ä¸ªå­˜åœ¨ä½ç½®æ—¶ï¼Œæˆ‘ä»¬ä» `2` å¼€å§‹æ£€ç´¢ï¼š

```js
let str = "Widget with id";

alert(str.indexOf("id", 2)); // 12
```

å¦‚æœæˆ‘ä»¬å¯¹æ‰€æœ‰å­˜åœ¨ä½ç½®éƒ½æ„Ÿå…´è¶£ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªå¾ªç¯ä¸­ä½¿ç”¨ `indexOf`ã€‚æ¯ä¸€æ¬¡æ–°çš„è°ƒç”¨éƒ½å‘ç”Ÿåœ¨ä¸Šä¸€åŒ¹é…ä½ç½®ä¹‹åï¼š

```js
let str = "As sly as a fox, as strong as an ox";

let target = "as"; // è¿™æ˜¯æˆ‘ä»¬è¦æŸ¥æ‰¾çš„ç›®æ ‡

let pos = 0;
while (true) {
  let foundPos = str.indexOf(target, pos);
  if (foundPos == -1) break;

  alert(`Found at ${foundPos}`);
  pos = foundPos + 1; // ç»§ç»­ä»ä¸‹ä¸€ä¸ªä½ç½®æŸ¥æ‰¾
}
```

ç›¸åŒçš„ç®—æ³•å¯ä»¥ç®€å†™ï¼š

```js
let str = "As sly as a fox, as strong as an ox";
let target = "as";

let pos = -1;
while ((pos = str.indexOf(target, pos + 1)) != -1) {
  alert(pos);
}
```

> :information_source: str.lastIndexOf(substr, pos)

è¿˜æœ‰ä¸€ä¸ªç±»ä¼¼çš„æ–¹æ³• [str.lastIndexOf(substr, position)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/lastIndexOf)ï¼Œå®ƒä»å­—ç¬¦ä¸²çš„æœ«å°¾å¼€å§‹æœç´¢åˆ°å¼€å¤´ã€‚

å®ƒä¼šä»¥ç›¸åçš„é¡ºåºåˆ—å‡ºè¿™äº›äº‹ä»¶ã€‚

åœ¨ `if` æµ‹è¯•ä¸­ `indexOf` æœ‰ä¸€ç‚¹ä¸æ–¹ä¾¿ã€‚æˆ‘ä»¬ä¸èƒ½åƒè¿™æ ·æŠŠå®ƒæ”¾åœ¨ `if` ä¸­ï¼š

```js
let str = "Widget with id";

if (str.indexOf("Widget")) {
  alert("We found it"); // ä¸å·¥ä½œï¼
}
```

ä¸Šè¿°ç¤ºä¾‹ä¸­çš„ `alert` ä¸ä¼šæ˜¾ç¤ºï¼Œå› ä¸º `str.indexOf("Widget")` è¿”å› `0`ï¼ˆæ„æ€æ˜¯å®ƒåœ¨èµ·å§‹ä½ç½®å°±æŸ¥æ‰¾åˆ°äº†åŒ¹é…é¡¹ï¼‰ã€‚æ˜¯çš„ï¼Œä½†æ˜¯ `if` è®¤ä¸º `0` è¡¨ç¤º `false`ã€‚

å› æ­¤æˆ‘ä»¬åº”è¯¥æ£€æŸ¥ `-1`ï¼Œåƒè¿™æ ·ï¼š

```js
let str = "Widget with id";

if (str.indexOf("Widget") != -1) {
  alert("We found it"); // ç°åœ¨å·¥ä½œäº†ï¼
}
```

### 3.7.2. æŒ‰ä½ï¼ˆbitwiseï¼‰NOT æŠ€å·§

è¿™é‡Œä½¿ç”¨çš„ä¸€ä¸ªè€æŠ€å·§æ˜¯ [bitwise NOT](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators#Bitwise_NOT) `~` è¿ç®—ç¬¦ã€‚å®ƒå°†æ•°å­—è½¬æ¢ä¸º 32-bit æ•´æ•°ï¼ˆå¦‚æœå­˜åœ¨å°æ•°éƒ¨åˆ†ï¼Œåˆ™åˆ é™¤å°æ•°éƒ¨åˆ†ï¼‰ï¼Œç„¶åå¯¹å…¶äºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼ä¸­çš„æ‰€æœ‰ä½å‡å–åã€‚

å®é™…ä¸Šï¼Œè¿™æ„å‘³ç€ä¸€ä»¶å¾ˆç®€å•çš„äº‹å„¿ï¼šå¯¹äº 32-bit æ•´æ•°ï¼Œ`~n` ç­‰äº `-(n+1)`ã€‚

ä¾‹å¦‚ï¼š

```js
alert(~2); // -3ï¼Œå’Œ -(2+1) ç›¸åŒ
alert(~1); // -2ï¼Œå’Œ -(1+1) ç›¸åŒ
alert(~0); // -1ï¼Œå’Œ -(0+1) ç›¸åŒ
alert(~-1); // 0ï¼Œå’Œ -(-1+1) ç›¸åŒ
```

æ­£å¦‚æˆ‘ä»¬çœ‹åˆ°è¿™æ ·ï¼Œåªæœ‰å½“ `n == -1` æ—¶ï¼Œ`~n` æ‰ä¸ºé›¶ï¼ˆé€‚ç”¨äºä»»ä½• 32-bit å¸¦ç¬¦å·çš„æ•´æ•° nï¼‰ã€‚

å› æ­¤ï¼Œä»…å½“ `indexOf` çš„ç»“æœä¸æ˜¯ `-1` æ—¶ï¼Œæ£€æŸ¥ `if ( ~str.indexOf("...") )` æ‰ä¸ºçœŸã€‚æ¢å¥è¯è¯´ï¼Œå½“æœ‰åŒ¹é…æ—¶ã€‚

äººä»¬ç”¨å®ƒæ¥ç®€å†™ `indexOf` æ£€æŸ¥ï¼š

```js
let str = "Widget";

if (~str.indexOf("Widget")) {
  alert("Found it!"); // æ­£å¸¸è¿è¡Œ
}
```

é€šå¸¸ä¸å»ºè®®ä»¥éæ˜¾è€Œæ˜“è§çš„æ–¹å¼ä½¿ç”¨è¯­è¨€ç‰¹æ€§ï¼Œä½†è¿™ç§ç‰¹æ®ŠæŠ€å·§åœ¨æ—§ä»£ç ä¸­ä»è¢«å¹¿æ³›ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥ç†è§£å®ƒã€‚

åªè¦è®°ä½ï¼š`if (~str.indexOf(...))` è¯»ä½œ `â€œif foundâ€`ã€‚

ç¡®åˆ‡åœ°è¯´ï¼Œç”±äº `~` è¿ç®—ç¬¦å°†å¤§æ•°å­—æˆªæ–­ä¸º 32 ä½ï¼Œå› æ­¤å­˜åœ¨ç»™å‡º `0` çš„å…¶ä»–æ•°å­—ï¼Œæœ€å°çš„æ•°å­—æ˜¯`~4294967295=0`ã€‚è¿™ä½¿å¾—è¿™ç§æ£€æŸ¥åªæœ‰åœ¨å­—ç¬¦ä¸²æ²¡æœ‰é‚£ä¹ˆé•¿çš„æƒ…å†µä¸‹æ‰æ˜¯æ­£ç¡®çš„ã€‚

ç°åœ¨æˆ‘ä»¬åªä¼šåœ¨æ—§çš„ä»£ç ä¸­çœ‹åˆ°è¿™ä¸ªæŠ€å·§ï¼Œå› ä¸ºç°ä»£ JavaScript æä¾›äº† .`includes` æ–¹æ³•ï¼ˆè§ä¸‹æ–‡ï¼‰ã€‚

### 3.7.3. includesï¼ŒstartsWithï¼ŒendsWith

æ›´ç°ä»£çš„æ–¹æ³• [str.includes(substr, pos)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/includes) æ ¹æ® `str` ä¸­æ˜¯å¦åŒ…å« `substr` æ¥è¿”å› `true/false`ã€‚

å¦‚æœæˆ‘ä»¬éœ€è¦æ£€æµ‹åŒ¹é…ï¼Œä½†ä¸éœ€è¦å®ƒçš„ä½ç½®ï¼Œé‚£ä¹ˆè¿™æ˜¯æ­£ç¡®çš„é€‰æ‹©ï¼š

```js
alert("Widget with id".includes("Widget")); // true

alert("Hello".includes("Bye")); // false
```

`str.includes` çš„ç¬¬äºŒä¸ªå¯é€‰å‚æ•°æ˜¯å¼€å§‹æœç´¢çš„èµ·å§‹ä½ç½®ï¼š

```js
alert("Midget".includes("id")); // true
alert("Midget".includes("id", 3)); // false, ä»ä½ç½® 3 å¼€å§‹æ²¡æœ‰ "id"
```

æ–¹æ³• [str.startsWith](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith) å’Œ [str.endsWith](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith) çš„åŠŸèƒ½ä¸å…¶åç§°æ‰€è¡¨ç¤ºçš„æ„æ€ç›¸åŒï¼š

```js
alert("Widget".startsWith("Wid")); // trueï¼Œ"Widget" ä»¥ "Wid" å¼€å§‹
alert("Widget".endsWith("get")); // trueï¼Œ"Widget" ä»¥ "get" ç»“æŸ
```

## 3.8. è·å–å­å­—ç¬¦ä¸²

JavaScript ä¸­æœ‰ä¸‰ç§è·å–å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼š`substring`ã€`substr` å’Œ `slice`ã€‚

`str.slice(start [, end])`

è¿”å›å­—ç¬¦ä¸²ä» `start` åˆ°ï¼ˆä½†ä¸åŒ…æ‹¬ï¼‰`end` çš„éƒ¨åˆ†ã€‚

ä¾‹å¦‚ï¼š

```js
let str = "stringify";
alert(str.slice(0, 5)); // 'strin'ï¼Œä» 0 åˆ° 5 çš„å­å­—ç¬¦ä¸²ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰
alert(str.slice(0, 1)); // 's'ï¼Œä» 0 åˆ° 1ï¼Œä½†ä¸åŒ…æ‹¬ 1ï¼Œæ‰€ä»¥åªæœ‰åœ¨ 0 å¤„çš„å­—ç¬¦
```

å¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œ`slice` ä¼šä¸€ç›´è¿è¡Œåˆ°å­—ç¬¦ä¸²æœ«å°¾ï¼š

```js
let str = "stringify";
alert(str.slice(2)); // ä»ç¬¬äºŒä¸ªä½ç½®ç›´åˆ°ç»“æŸ
```

`start/end` ä¹Ÿæœ‰å¯èƒ½æ˜¯è´Ÿå€¼ã€‚å®ƒä»¬çš„æ„æ€æ˜¯èµ·å§‹ä½ç½®ä»å­—ç¬¦ä¸²ç»“å°¾è®¡ç®—ï¼š

```js
let str = "stringify";

// ä»å³è¾¹çš„ç¬¬å››ä¸ªä½ç½®å¼€å§‹ï¼Œåœ¨å³è¾¹çš„ç¬¬ä¸€ä¸ªä½ç½®ç»“æŸ
alert(str.slice(-4, -1)); // 'gif'
```

**`str.substring(start [, end])`**

è¿”å›å­—ç¬¦ä¸²åœ¨ `start` å’Œ `end` ä¹‹é—´ çš„éƒ¨åˆ†ã€‚

è¿™ä¸ `slice` å‡ ä¹ç›¸åŒï¼Œä½†å®ƒå…è®¸ `start` å¤§äº `end`ã€‚

ä¾‹å¦‚ï¼š

```js
let str = "stringify";

// è¿™äº›å¯¹äº substring æ˜¯ç›¸åŒçš„
alert(str.substring(2, 6)); // "ring"
alert(str.substring(6, 2)); // "ring"

// â€¦â€¦ä½†å¯¹ slice æ˜¯ä¸åŒçš„ï¼š
alert(str.slice(2, 6)); // "ring"ï¼ˆä¸€æ ·ï¼‰
alert(str.slice(6, 2)); // ""ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰
```

ä¸æ”¯æŒè´Ÿå‚æ•°ï¼ˆä¸åƒ sliceï¼‰ï¼Œå®ƒä»¬è¢«è§†ä¸º `0`ã€‚

**`str.substr(start [, length])`**
è¿”å›å­—ç¬¦ä¸²ä» `start` å¼€å§‹çš„ç»™å®š `length`çš„éƒ¨åˆ†ã€‚

ä¸ä»¥å‰çš„æ–¹æ³•ç›¸æ¯”ï¼Œè¿™ä¸ªå…è®¸æˆ‘ä»¬æŒ‡å®š `length` è€Œä¸æ˜¯ç»“æŸä½ç½®ï¼š

```js
let str = "stringify";
alert(str.substr(2, 4)); // 'ring'ï¼Œä»ä½ç½® 2 å¼€å§‹ï¼Œè·å– 4 ä¸ªå­—ç¬¦
```

ç¬¬ä¸€ä¸ªå‚æ•°å¯èƒ½æ˜¯è´Ÿæ•°ï¼Œä»ç»“å°¾ç®—èµ·ï¼š

```js
let str = "stringify";
alert(str.substr(-4, 2)); // 'gi'ï¼Œä»ç¬¬ 4 ä½è·å– 2 ä¸ªå­—ç¬¦
```

æˆ‘ä»¬å›é¡¾ä¸€ä¸‹è¿™äº›æ–¹æ³•ï¼Œä»¥å…æ··æ·†ï¼š
æ–¹æ³• |é€‰æ‹©æ–¹å¼â€¦â€¦ |è´Ÿå€¼å‚æ•°
--|--|--
`slice(start, end)` |ä» start åˆ° endï¼ˆä¸å« endï¼‰ |å…è®¸
`substring(start, end)` |start ä¸ end ä¹‹é—´ï¼ˆåŒ…æ‹¬ startï¼Œä½†ä¸åŒ…æ‹¬ endï¼‰ è´Ÿå€¼ä»£è¡¨ |0
`substr(start, length)` |ä» start å¼€å§‹è·å–é•¿ä¸º length çš„å­—ç¬¦ä¸² |å…è®¸ start ä¸ºè´Ÿæ•°

> :information_source:**ä½¿ç”¨å“ªä¸€ä¸ªï¼Ÿ**

å®ƒä»¬å¯ä»¥å®Œæˆè¿™é¡¹å·¥ä½œã€‚å½¢å¼ä¸Šï¼Œ`subst`r æœ‰ä¸€ä¸ªå°ç¼ºç‚¹ï¼šå®ƒä¸æ˜¯åœ¨ JavaScript æ ¸å¿ƒè§„èŒƒä¸­æè¿°çš„ï¼Œè€Œæ˜¯åœ¨é™„å½• B ä¸­ï¼Œå®ƒæ¶µç›–äº†ä¸»è¦ç”±äºå†å²åŸå› è€Œå­˜åœ¨çš„ä»…æµè§ˆå™¨ç‰¹æ€§ã€‚å› æ­¤ï¼Œéæµè§ˆå™¨ç¯å¢ƒå¯èƒ½æ— æ³•æ”¯æŒå®ƒã€‚ä½†å®é™…ä¸Šå®ƒåœ¨ä»»ä½•åœ°æ–¹éƒ½æœ‰æ•ˆã€‚

ç›¸è¾ƒäºå…¶ä»–ä¸¤ä¸ªå˜ä½“ï¼Œ`slice` ç¨å¾®çµæ´»ä¸€äº›ï¼Œå®ƒå…è®¸ä»¥è´Ÿå€¼ä½œä¸ºå‚æ•°å¹¶ä¸”å†™æ³•æ›´ç®€çŸ­ã€‚å› æ­¤ä»…ä»…è®°ä½è¿™ä¸‰ç§æ–¹æ³•ä¸­çš„ `slice` å°±è¶³å¤Ÿäº†ã€‚

## 3.9. æ¯”è¾ƒå­—ç¬¦ä¸²

æ­£å¦‚æˆ‘ä»¬ä» å€¼çš„æ¯”è¾ƒ ä¸€ç« ä¸­äº†è§£åˆ°çš„ï¼Œå­—ç¬¦ä¸²æŒ‰å­—æ¯é¡ºåºé€å­—æ¯”è¾ƒã€‚

ä¸è¿‡ï¼Œä¹Ÿæœ‰ä¸€äº›å¥‡æ€ªçš„åœ°æ–¹ã€‚

1. å°å†™å­—æ¯æ€»æ˜¯å¤§äºå¤§å†™å­—æ¯ï¼š
   ```js
   alert("a" > "Z"); // true
   ```
2. å¸¦å˜éŸ³ç¬¦å·çš„å­—æ¯å­˜åœ¨â€œä¹±åºâ€çš„æƒ…å†µï¼š
   ```js
   alert("Ã–sterreich" > "Zealand"); // true
   ```
   å¦‚æœæˆ‘ä»¬å¯¹è¿™äº›å›½å®¶åè¿›è¡Œæ’åºï¼Œå¯èƒ½ä¼šå¯¼è‡´å¥‡æ€ªçš„ç»“æœã€‚é€šå¸¸ï¼Œäººä»¬ä¼šæœŸæœ› `Zealand` åœ¨åå•ä¸­çš„ `Ã–sterreich` ä¹‹åå‡ºç°ã€‚

ä¸ºäº†æ˜ç™½å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬å›é¡¾ä¸€ä¸‹åœ¨ JavaScript ä¸­å­—ç¬¦ä¸²çš„å†…éƒ¨è¡¨ç¤ºã€‚

æ‰€æœ‰çš„å­—ç¬¦ä¸²éƒ½ä½¿ç”¨ [UTF-16](https://en.wikipedia.org/wiki/UTF-16) ç¼–ç ã€‚å³ï¼šæ¯ä¸ªå­—ç¬¦éƒ½æœ‰å¯¹åº”çš„æ•°å­—ä»£ç ã€‚æœ‰ç‰¹æ®Šçš„æ–¹æ³•å¯ä»¥è·å–ä»£ç è¡¨ç¤ºçš„å­—ç¬¦ï¼Œä»¥åŠå­—ç¬¦å¯¹åº”çš„ä»£ç ã€‚

**`str.codePointAt(pos)`**

è¿”å›åœ¨ `pos` ä½ç½®çš„å­—ç¬¦ä»£ç  :

```js
// ä¸åŒçš„å­—æ¯æœ‰ä¸åŒçš„ä»£ç 
alert("z".codePointAt(0)); // 122
alert("Z".codePointAt(0)); // 90
```

**`String.fromCodePoint(code)`**
é€šè¿‡æ•°å­— `code` åˆ›å»ºå­—ç¬¦

```js
alert(String.fromCodePoint(90)); // Z
```

æˆ‘ä»¬è¿˜å¯ä»¥ç”¨ `\u` åè·Ÿåå…­è¿›åˆ¶ä»£ç ï¼Œé€šè¿‡è¿™äº›ä»£ç æ·»åŠ  unicode å­—ç¬¦ï¼š

```js
// åœ¨åå…­è¿›åˆ¶ç³»ç»Ÿä¸­ 90 ä¸º 5a
alert("\u005a"); // Z
```

ç°åœ¨æˆ‘ä»¬çœ‹ä¸€ä¸‹ä»£ç ä¸º `65..220` çš„å­—ç¬¦ï¼ˆæ‹‰ä¸å­—æ¯å’Œä¸€äº›é¢å¤–çš„å­—ç¬¦ï¼‰ï¼Œæ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼š

```js
let str = "";

for (let i = 65; i <= 220; i++) {
  str += String.fromCodePoint(i);
}
alert(str);
// ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~Â€ÂÂ‚ÂƒÂ„
// Â¡Â¢Â£Â¤Â¥Â¦Â§Â¨Â©ÂªÂ«Â¬Â­Â®Â¯Â°Â±Â²Â³Â´ÂµÂ¶Â·Â¸Â¹ÂºÂ»Â¼Â½Â¾Â¿Ã€ÃÃ‚ÃƒÃ„Ã…Ã†Ã‡ÃˆÃ‰ÃŠÃ‹ÃŒÃÃÃÃÃ‘Ã’Ã“Ã”Ã•Ã–Ã—Ã˜Ã™ÃšÃ›Ãœ
```

çœ‹åˆ°æ²¡ï¼Ÿå…ˆæ˜¯å¤§å†™å­—ç¬¦ï¼Œç„¶åæ˜¯ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œç„¶åæ˜¯å°å†™å­—ç¬¦ï¼Œè€Œ Ã– å‡ ä¹æ˜¯æœ€åè¾“å‡ºã€‚

ç°åœ¨å¾ˆæ˜æ˜¾ä¸ºä»€ä¹ˆ `a` > `Z`ã€‚

å­—ç¬¦é€šè¿‡æ•°å­—ä»£ç è¿›è¡Œæ¯”è¾ƒã€‚è¶Šå¤§çš„ä»£ç æ„å‘³ç€å­—ç¬¦è¶Šå¤§ã€‚`aï¼ˆ97ï¼‰`çš„ä»£ç å¤§äº `Zï¼ˆ90ï¼‰`çš„ä»£ç 

- æ‰€æœ‰å°å†™å­—æ¯è¿½éšåœ¨å¤§å†™å­—æ¯ä¹‹åï¼Œå› ä¸ºå®ƒä»¬çš„ä»£ç æ›´å¤§ã€‚
- ä¸€äº›åƒ `Ã–` çš„å­—æ¯ä¸ä¸»è¦å­—æ¯è¡¨ä¸åŒã€‚è¿™é‡Œï¼Œå®ƒçš„ä»£ç æ¯”ä»»ä½•ä» a åˆ° z çš„ä»£ç éƒ½è¦å¤§

### 3.9.1. æ­£ç¡®çš„æ¯”è¾ƒ

æ‰§è¡Œå­—ç¬¦ä¸²æ¯”è¾ƒçš„â€œæ­£ç¡®â€ç®—æ³•æ¯”çœ‹èµ·æ¥æ›´å¤æ‚ï¼Œå› ä¸ºä¸åŒè¯­è¨€çš„å­—æ¯éƒ½ä¸ç›¸åŒã€‚

å› æ­¤æµè§ˆå™¨éœ€è¦çŸ¥é“è¦æ¯”è¾ƒçš„è¯­è¨€ã€‚

å¹¸è¿çš„æ˜¯ï¼Œæ‰€æœ‰ç°ä»£æµè§ˆå™¨ï¼ˆIE10- éœ€è¦é¢å¤–çš„åº“ [Intl.JS](https://github.com/andyearnshaw/Intl.js/)) éƒ½æ”¯æŒå›½é™…åŒ–æ ‡å‡†[ ECMA-402](http://www.ecma-international.org/ecma-402/1.0/ECMA-402.pdf)ã€‚

å®ƒæä¾›äº†ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•æ¥æ¯”è¾ƒä¸åŒè¯­è¨€çš„å­—ç¬¦ä¸²ï¼Œéµå¾ªå®ƒä»¬çš„è§„åˆ™ã€‚

è°ƒç”¨ [str.localeCompare(str2)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/localeCompare) ä¼šæ ¹æ®è¯­è¨€è§„åˆ™è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¿™ä¸ªæ•´æ•°èƒ½è¡¨æ˜ `str` æ˜¯å¦åœ¨ `str2` å‰ï¼Œåæˆ–è€…ç­‰äºå®ƒï¼š

- å¦‚æœ `str` å°äº `str2` åˆ™è¿”å›è´Ÿæ•°ã€‚
- å¦‚æœ `str` å¤§äº `str2` åˆ™è¿”å›æ­£æ•°ã€‚
- å¦‚æœå®ƒä»¬ç›¸ç­‰åˆ™è¿”å› `0`ã€‚

ä¾‹å¦‚ï¼š

```js
alert("Ã–sterreich".localeCompare("Zealand")); // -1
```

è¿™ä¸ªæ–¹æ³•å®é™…ä¸Šåœ¨ [æ–‡æ¡£](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/localeCompare) ä¸­æŒ‡å®šäº†ä¸¤ä¸ªé¢å¤–çš„å‚æ•°ï¼Œè¿™ä¸¤ä¸ªå‚æ•°å…è®¸å®ƒæŒ‡å®šè¯­è¨€ï¼ˆé»˜è®¤è¯­è¨€ä»ç¯å¢ƒä¸­è·å–ï¼Œå­—ç¬¦é¡ºåºè§†è¯­è¨€ä¸åŒè€Œä¸åŒï¼‰å¹¶è®¾ç½®è¯¸å¦‚åŒºåˆ«å¤§å°ä¹‹ç±»çš„é™„åŠ è§„åˆ™ï¼Œæˆ–åº”è¯¥å°† "a" å’Œ "aÌ" çœ‹ä½œç›¸ç­‰æƒ…å†µç­‰ã€‚

## 3.10. å†…éƒ¨ï¼ŒUnicode

> :warning:è¿›é˜¶å†…å®¹

è¿™éƒ¨åˆ†ä¼šæ·±å…¥å­—ç¬¦ä¸²å†…éƒ¨ã€‚å¦‚æœä½ è®¡åˆ’å¤„ç† emojiã€ç½•è§çš„æ•°å­¦æˆ–è±¡å½¢æ–‡å­—æˆ–å…¶ä»–ç½•è§çš„ç¬¦å·ï¼Œè¿™äº›çŸ¥è¯†ä¼šå¯¹ä½ æœ‰ç”¨ã€‚

å¦‚æœä½ ä¸æ‰“ç®—æ”¯æŒå®ƒä»¬ï¼Œä½ å¯ä»¥è·³è¿‡è¿™ä¸€éƒ¨åˆ†ã€‚

### 3.10.1. ä»£ç†å¯¹

æ‰€æœ‰å¸¸ç”¨çš„å­—ç¬¦éƒ½æ˜¯ä¸€ä¸ª 2 å­—èŠ‚çš„ä»£ç ã€‚å¤§å¤šæ•°æ¬§æ´²è¯­è¨€ï¼Œæ•°å­—ç”šè‡³å¤§å¤šæ•°è±¡å½¢æ–‡å­—ä¸­çš„å­—æ¯éƒ½æœ‰ 2 å­—èŠ‚çš„è¡¨ç¤ºå½¢å¼ã€‚

ä½† 2 å­—èŠ‚åªå…è®¸ 65536 ä¸ªç»„åˆï¼Œè¿™å¯¹äºè¡¨ç¤ºæ¯ä¸ªå¯èƒ½çš„ç¬¦å·æ˜¯ä¸å¤Ÿçš„ã€‚æ‰€ä»¥ç¨€æœ‰çš„ç¬¦å·è¢«ç§°ä¸ºâ€œä»£ç†å¯¹â€çš„ä¸€å¯¹ 2 å­—èŠ‚çš„ç¬¦å·ç¼–ç ã€‚

è¿™äº›ç¬¦å·çš„é•¿åº¦æ˜¯ 2ï¼š

```js
alert("ğ’³".length); // 2ï¼Œå¤§å†™æ•°å­¦ç¬¦å· X
alert("ğŸ˜‚".length); // 2ï¼Œç¬‘å“­è¡¨æƒ…
alert("ğ©·¶".length); // 2ï¼Œç½•è§çš„ä¸­å›½è±¡å½¢æ–‡å­—
```

æ³¨æ„ï¼Œä»£ç†å¯¹åœ¨ JavaScript è¢«åˆ›å»ºæ—¶å¹¶ä¸å­˜åœ¨ï¼Œå› æ­¤æ— æ³•è¢«ç¼–ç¨‹è¯­è¨€æ­£ç¡®å¤„ç†ï¼

æˆ‘ä»¬å®é™…ä¸Šåœ¨ä¸Šé¢çš„æ¯ä¸ªå­—ç¬¦ä¸²ä¸­éƒ½æœ‰ä¸€ä¸ªç¬¦å·ï¼Œä½† length æ˜¾ç¤ºé•¿åº¦ä¸º 2ã€‚

`String.fromCodePoint` å’Œ `str.codePointAt` æ˜¯å‡ ç§å¤„ç†ä»£ç†å¯¹çš„å°‘æ•°æ–¹æ³•ã€‚å®ƒä»¬æœ€è¿‘æ‰å‡ºç°åœ¨ç¼–ç¨‹è¯­è¨€ä¸­ã€‚åœ¨å®ƒä»¬ä¹‹å‰ï¼Œåªæœ‰ [`String.fromCharCode`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/fromCharCode) å’Œ [`str.charCodeAt`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/charCodeAt)ã€‚è¿™äº›æ–¹æ³•å®é™…ä¸Šä¸ `fromCodePoint/codePointAt` ç›¸åŒï¼Œä½†æ˜¯ä¸é€‚ç”¨äºä»£ç†å¯¹ã€‚

è·å–ç¬¦å·å¯èƒ½ä¼šéå¸¸éº»çƒ¦ï¼Œå› ä¸ºä»£ç†å¯¹è¢«è®¤ä¸ºæ˜¯ä¸¤ä¸ªå­—ç¬¦ï¼š

```js
alert("ğ’³"[0]); // å¥‡æ€ªçš„ç¬¦å·â€¦â€¦
alert("ğ’³"[1]); // â€¦â€¦ä»£ç†å¯¹çš„ä¸€å—
```

è¯·æ³¨æ„ï¼Œä»£ç†å¯¹çš„å„éƒ¨åˆ†æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚å› æ­¤ï¼Œä¸Šè¿°ç¤ºä¾‹ä¸­çš„ alert æ˜¾ç¤ºçš„å®é™…ä¸Šæ˜¯åƒåœ¾ä¿¡æ¯ã€‚

æŠ€æœ¯è§’åº¦æ¥è¯´ï¼Œä»£ç†å¯¹ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡å®ƒä»¬çš„ä»£ç æ£€æµ‹åˆ°çš„ï¼šå¦‚æœä¸€ä¸ªå­—ç¬¦çš„ä»£ç åœ¨ `0xd800..0xdbff` èŒƒå›´å†…ï¼Œé‚£ä¹ˆå®ƒæ˜¯ä»£ç†å¯¹çš„ç¬¬ä¸€éƒ¨åˆ†ã€‚ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼ˆç¬¬äºŒéƒ¨åˆ†ï¼‰å¿…é¡»åœ¨ `0xdc00..0xdfff` èŒƒå›´ä¸­ã€‚è¿™äº›èŒƒå›´æ˜¯æŒ‰ç…§æ ‡å‡†ä¸“é—¨ä¸ºä»£ç†å¯¹ä¿ç•™çš„ã€‚

åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼š

```js
// charCodeAt ä¸ç†è§£ä»£ç†å¯¹ï¼Œæ‰€ä»¥å®ƒç»™å‡ºäº†ä»£ç†å¯¹çš„ä»£ç 

alert("ğ’³".charCodeAt(0).toString(16)); // d835ï¼Œåœ¨ 0xd800 å’Œ 0xdbff ä¹‹é—´
alert("ğ’³".charCodeAt(1).toString(16)); // dcb3, åœ¨ 0xdc00 å’Œ 0xdfff ä¹‹é—´
```

æœ¬ç« èŠ‚åé¢çš„ [`Iterable objectï¼ˆå¯è¿­ä»£å¯¹è±¡ï¼‰`](https://zh.javascript.info/iterable) ç« èŠ‚ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ°æ›´å¤šå¤„ç†ä»£ç†å¯¹çš„æ–¹æ³•ã€‚å¯èƒ½ä¹Ÿä¸“é—¨çš„åº“ï¼Œè¿™é‡Œæ²¡æœ‰ä»€ä¹ˆè¶³å¤Ÿå¥½çš„å»ºè®®äº†ã€‚

### 3.10.2. å˜éŸ³ç¬¦å·ä¸è§„èŒƒåŒ–

åœ¨è®¸å¤šè¯­è¨€ä¸­ï¼Œéƒ½æœ‰ä¸€äº›ç”±åŸºæœ¬å­—ç¬¦ç»„æˆçš„ç¬¦å·ï¼Œåœ¨å…¶ä¸Šæ–¹/ä¸‹æ–¹æœ‰ä¸€ä¸ªæ ‡è®°ã€‚

ä¾‹å¦‚ï¼Œå­—æ¯ `a` å¯ä»¥æ˜¯ `Ã Ã¡Ã¢Ã¤Ã£Ã¥Ä` çš„åŸºæœ¬å­—ç¬¦ã€‚æœ€å¸¸è§çš„â€œå¤åˆâ€å­—ç¬¦åœ¨ UTF-16 è¡¨ä¸­éƒ½æœ‰è‡ªå·±çš„ä»£ç ã€‚ä½†ä¸æ˜¯å…¨éƒ¨ï¼Œå› ä¸ºå¯èƒ½çš„ç»„åˆå¤ªå¤šã€‚

ä¸ºäº†æ”¯æŒä»»æ„ç»„åˆï¼ŒUTF-16 å…è®¸æˆ‘ä»¬ä½¿ç”¨å¤šä¸ª unicode å­—ç¬¦ï¼šåŸºæœ¬å­—ç¬¦ç´§è·Ÿâ€œè£…é¥°â€å®ƒçš„ä¸€ä¸ªæˆ–å¤šä¸ªâ€œæ ‡è®°â€å­—ç¬¦ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬ S åè·Ÿæœ‰ç‰¹æ®Šçš„ â€œdot aboveâ€ å­—ç¬¦ï¼ˆä»£ç  `\u0307`ï¼‰ï¼Œåˆ™æ˜¾ç¤º SÌ‡ã€‚

```js
alert("S\u0307"); // SÌ‡
```

å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨å­—æ¯ä¸Šæ–¹ï¼ˆæˆ–ä¸‹æ–¹ï¼‰æ·»åŠ é¢å¤–çš„æ ‡è®° â€”â€” æ²¡é—®é¢˜ï¼Œåªéœ€è¦æ·»åŠ å¿…è¦çš„æ ‡è®°å­—ç¬¦å³å¯ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬è¿½åŠ ä¸€ä¸ªå­—ç¬¦ â€œdot belowâ€ï¼ˆä»£ç  `\u0323`ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å¾—åˆ°â€œS ä¸Šé¢å’Œä¸‹é¢éƒ½æœ‰ç‚¹â€çš„å­—ç¬¦ï¼š`SÌ‡Ì£`ã€‚

ä¾‹å¦‚ï¼š

```js
alert("S\u0307\u0323"); // SÌ‡Ì£
```

è¿™åœ¨æä¾›è‰¯å¥½çµæ´»æ€§çš„åŒæ—¶ï¼Œä¹Ÿå­˜åœ¨ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜ï¼šä¸¤ä¸ªè§†è§‰ä¸Šçœ‹èµ·æ¥ç›¸åŒçš„å­—ç¬¦ï¼Œå¯ä»¥ç”¨ä¸åŒçš„ unicode ç»„åˆè¡¨ç¤ºã€‚

ä¾‹å¦‚ï¼š

```js
let s1 = "S\u0307\u0323"; // SÌ‡Ì£ï¼ŒS + ä¸Šç‚¹ + ä¸‹ç‚¹
let s2 = "S\u0323\u0307"; // SÌ£Ì‡ï¼ŒS + ä¸‹ç‚¹ + ä¸Šç‚¹

alert(`s1: ${s1}, s2: ${s2}`);

alert(s1 == s2); // falseï¼Œå°½ç®¡å­—ç¬¦çœ‹èµ·æ¥ç›¸åŒï¼ˆ?!ï¼‰
```

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸€ä¸ª â€œunicode è§„èŒƒåŒ–â€ç®—æ³•ï¼Œå®ƒå°†æ¯ä¸ªå­—ç¬¦ä¸²éƒ½è½¬åŒ–æˆå•ä¸ªâ€œé€šç”¨â€æ ¼å¼ã€‚

å®ƒç”± [`str.normalize()`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/normalize) å®ç°ã€‚

```js
alert("S\u0307\u0323".normalize() == "S\u0323\u0307".normalize()); // true
```

æœ‰è¶£çš„æ˜¯ï¼Œåœ¨å®é™…æƒ…å†µä¸‹ï¼Œ`normalize()` å®é™…ä¸Šå°†ä¸€ä¸ªç”± 3 ä¸ªå­—ç¬¦ç»„æˆçš„åºåˆ—åˆå¹¶ä¸ºä¸€ä¸ªï¼š`\u1e68`ï¼ˆS æœ‰ä¸¤ä¸ªç‚¹ï¼‰ã€‚

```js
alert("S\u0307\u0323".normalize().length); // 1

alert("S\u0307\u0323".normalize() == "\u1e68"); // true
```

äº‹å®ä¸Šï¼Œæƒ…å†µå¹¶éæ€»æ˜¯å¦‚æ­¤ï¼Œå› ä¸ºç¬¦å· `SÌ‡Ì£` æ˜¯â€œå¸¸ç”¨â€çš„ï¼Œæ‰€ä»¥ UTF-16 åˆ›å»ºè€…æŠŠå®ƒåŒ…å«åœ¨ä¸»è¡¨ä¸­å¹¶ç»™å®ƒäº†å¯¹åº”çš„ä»£ç ã€‚

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºè§„èŒƒåŒ–è§„åˆ™å’Œå˜ä½“çš„ä¿¡æ¯ â€”â€” å®ƒä»¬åœ¨ Unicode æ ‡å‡†é™„å½•ä¸­æœ‰è¯¦ç»†æè¿°ï¼š[Unicode è§„èŒƒåŒ–å½¢å¼](http://www.unicode.org/reports/tr15/)ï¼Œä½†å¯¹äºå¤§å¤šæ•°å®é™…ç›®çš„æ¥è¯´ï¼Œæœ¬æ–‡çš„å†…å®¹å°±å·²ç»è¶³å¤Ÿäº†ã€‚

## 3.11. æ€»ç»“

- æœ‰ 3 ç§ç±»å‹çš„å¼•å·ã€‚åå¼•å·å…è®¸å­—ç¬¦ä¸²è·¨è¶Šå¤šè¡Œå¹¶å¯ä»¥ä½¿ç”¨ \${â€¦} åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥è¡¨è¾¾å¼ã€‚
- JavaScript ä¸­çš„å­—ç¬¦ä¸²ä½¿ç”¨çš„æ˜¯ UTF-16 ç¼–ç ã€‚
- æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åƒ \n è¿™æ ·çš„ç‰¹æ®Šå­—ç¬¦æˆ–é€šè¿‡ä½¿ç”¨ \u... æ¥æ“ä½œå®ƒä»¬çš„ unicode è¿›è¡Œå­—ç¬¦æ’å…¥ã€‚
- è·å–å­—ç¬¦æ—¶ï¼Œä½¿ç”¨ []ã€‚
- è·å–å­å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ slice æˆ– substringã€‚
- å­—ç¬¦ä¸²çš„å¤§/å°å†™è½¬æ¢ï¼Œä½¿ç”¨ï¼štoLowerCase/toUpperCaseã€‚
- æŸ¥æ‰¾å­å­—ç¬¦ä¸²æ—¶ï¼Œä½¿ç”¨ indexOf æˆ– includes/startsWith/endsWith è¿›è¡Œç®€å•æ£€æŸ¥ã€‚
- æ ¹æ®è¯­è¨€æ¯”è¾ƒå­—ç¬¦ä¸²æ—¶ä½¿ç”¨ localeCompareï¼Œå¦åˆ™å°†æŒ‰å­—ç¬¦ä»£ç è¿›è¡Œæ¯”è¾ƒã€‚

è¿˜æœ‰å…¶ä»–å‡ ç§æœ‰ç”¨çš„å­—ç¬¦ä¸²æ–¹æ³•ï¼š

- str.trim() â€”â€” åˆ é™¤å­—ç¬¦ä¸²å‰åçš„ç©ºæ ¼ (â€œtrimsâ€)ã€‚
- str.repeat(n) â€”â€” é‡å¤å­—ç¬¦ä¸² n æ¬¡ã€‚
- â€¦â€¦æ›´å¤šå†…å®¹ç»†èŠ‚è¯·å‚è§[ æ‰‹å†Œ](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String)ã€‚

å­—ç¬¦ä¸²è¿˜å…·æœ‰ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæœç´¢/æ›¿æ¢çš„æ–¹æ³•ã€‚ä½†è¿™ä¸ªè¯é¢˜å¾ˆå¤§ï¼Œå› æ­¤æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹ä¸­å•ç‹¬çš„ [æ­£åˆ™è¡¨è¾¾å¼](https://zh.javascript.info/regular-expressions) ç« èŠ‚ä¸­è¿›è¡Œè®¨è®ºã€‚

# 4. æ•°ç»„

å¯¹è±¡å…è®¸å­˜å‚¨é”®å€¼é›†åˆï¼Œè¿™å¾ˆå¥½ã€‚

ä½†å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å‘ç°è¿˜éœ€è¦ **æœ‰åºé›†åˆ**ï¼Œé‡Œé¢çš„å…ƒç´ éƒ½æ˜¯æŒ‰é¡ºåºæ’åˆ—çš„ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å­˜å‚¨ä¸€äº›åˆ—è¡¨ï¼Œæ¯”å¦‚ç”¨æˆ·ã€å•†å“ä»¥åŠ HTML å…ƒç´ ç­‰ã€‚

è¿™é‡Œä½¿ç”¨å¯¹è±¡å°±ä¸æ˜¯å¾ˆæ–¹ä¾¿äº†ï¼Œå› ä¸ºå¯¹è±¡ä¸èƒ½æä¾›èƒ½å¤Ÿç®¡ç†å…ƒç´ é¡ºåºçš„æ–¹æ³•ã€‚æˆ‘ä»¬ä¸èƒ½åœ¨å·²æœ‰çš„å…ƒç´ â€œä¹‹é—´â€æ’å…¥ä¸€ä¸ªæ–°çš„å±æ€§ã€‚è¿™ç§åœºæ™¯ä¸‹å¯¹è±¡å°±ä¸å¤ªé€‚ç”¨äº†ã€‚

è¿™æ—¶ä¸€ä¸ªç‰¹æ®Šçš„æ•°æ®ç»“æ„æ•°ç»„ï¼ˆ`Array`ï¼‰å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œå®ƒèƒ½å­˜å‚¨æœ‰åºçš„é›†åˆã€‚

## 4.1. å£°æ˜

åˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„æœ‰ä¸¤ç§è¯­æ³•ï¼š

```js
let arr = new Array();
let arr = [];
```

ç»å¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨çš„éƒ½æ˜¯ç¬¬äºŒç§è¯­æ³•ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ–¹æ‹¬å·ä¸­æ·»åŠ åˆå§‹å…ƒç´ ï¼š

```js
let fruits = ["Apple", "Orange", "Plum"];
```

æ•°ç»„å…ƒç´ ä» 0 å¼€å§‹ç¼–å·ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–¹æ‹¬å·ä¸­çš„æ•°å­—è·å–å…ƒç´ ï¼š

```js
let fruits = ["Apple", "Orange", "Plum"];

alert(fruits[0]); // Apple
alert(fruits[1]); // Orange
alert(fruits[2]); // Plum
```

å¯ä»¥æ›¿æ¢å…ƒç´ ï¼š

```js
fruits[2] = "Pear"; // ç°åœ¨å˜æˆäº† ["Apple", "Orange", "Pear"]
```

â€¦â€¦æˆ–è€…å‘æ•°ç»„æ–°åŠ ä¸€ä¸ªå…ƒç´ ï¼š

```js
fruits[3] = "Lemon"; // ç°åœ¨å˜æˆ ["Apple", "Orange", "Pear", "Lemon"]
```

`length` å±æ€§çš„å€¼æ˜¯æ•°ç»„ä¸­å…ƒç´ çš„æ€»ä¸ªæ•°ï¼š

```js
let fruits = ["Apple", "Orange", "Plum"];

alert(fruits.length); // 3
```

ä¹Ÿå¯ä»¥ç”¨ alert æ¥æ˜¾ç¤ºæ•´ä¸ªæ•°ç»„ã€‚

```js
let fruits = ["Apple", "Orange", "Plum"];

alert(fruits); // Apple,Orange,Plum
```

æ•°ç»„å¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„å…ƒç´ ã€‚

ä¾‹å¦‚:

```js
// æ··åˆå€¼
let arr = [
  "Apple",
  { name: "John" },
  true,
  function () {
    alert("hello");
  },
];

// è·å–ç´¢å¼•ä¸º 1 çš„å¯¹è±¡ç„¶åæ˜¾ç¤ºå®ƒçš„ name
alert(arr[1].name); // John

// è·å–ç´¢å¼•ä¸º 3 çš„å‡½æ•°å¹¶æ‰§è¡Œ
arr[3](); // hello
```

> :information_source:ä»¥é€—å·ç»“å°¾

æ•°ç»„å°±åƒå¯¹è±¡ä¸€æ ·ï¼Œå¯ä»¥ä»¥é€—å·ç»“å°¾ï¼š

```js
let fruits = ["Apple", "Orange", "Plum"];
```

å› ä¸ºæ¯ä¸€è¡Œéƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œæ‰€ä»¥è¿™ç§ä»¥â€œé€—å·ç»“å°¾â€çš„æ–¹å¼ä½¿å¾—æ’å…¥/ç§»é™¤é¡¹å˜å¾—æ›´åŠ ç®€å•ã€‚

## 4.2. pop/push, shift/unshift æ–¹æ³•

[é˜Ÿåˆ—ï¼ˆqueueï¼‰](<https://en.wikipedia.org/wiki/Queue_(abstract_data_type)>)æ˜¯æœ€å¸¸è§çš„ä½¿ç”¨æ•°ç»„çš„æ–¹æ³•ä¹‹ä¸€ã€‚åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œè¿™è¡¨ç¤ºæ”¯æŒä¸¤ä¸ªæ“ä½œçš„ä¸€ä¸ªæœ‰åºå…ƒç´ çš„é›†åˆï¼š

- `push` åœ¨æœ«ç«¯æ·»åŠ ä¸€ä¸ªå…ƒç´ .
- `shift` å–å‡ºé˜Ÿåˆ—é¦–ç«¯çš„ä¸€ä¸ªå…ƒç´ ï¼Œæ•´ä¸ªé˜Ÿåˆ—å¾€å‰ç§»ï¼Œè¿™æ ·åŸå…ˆæ’ç¬¬äºŒçš„å…ƒç´ ç°åœ¨æ’åœ¨äº†ç¬¬ä¸€ã€‚

![](https://zh.javascript.info/article/array/queue.svg)

è¿™ä¸¤ç§æ“ä½œæ•°ç»„éƒ½æ”¯æŒã€‚

é˜Ÿåˆ—çš„åº”ç”¨åœ¨å®è·µä¸­ç»å¸¸ä¼šç¢°åˆ°ã€‚ä¾‹å¦‚éœ€è¦åœ¨å±å¹•ä¸Šæ˜¾ç¤ºæ¶ˆæ¯é˜Ÿåˆ—ã€‚

æ•°ç»„è¿˜æœ‰å¦ä¸€ä¸ªç”¨ä¾‹ï¼Œå°±æ˜¯æ•°æ®ç»“æ„ [æ ˆ](<https://en.wikipedia.org/wiki/Stack_(abstract_data_type)>)ã€‚

å®ƒæ”¯æŒä¸¤ç§æ“ä½œï¼š

- `push` åœ¨æœ«ç«¯æ·»åŠ ä¸€ä¸ªå…ƒç´ .
- `pop` ä»æœ«ç«¯å–å‡ºä¸€ä¸ªå…ƒç´ .

æ‰€ä»¥æ–°å…ƒç´ çš„æ·»åŠ å’Œå–å‡ºéƒ½æ˜¯ä»â€œæœ«ç«¯â€å¼€å§‹çš„ã€‚

æ ˆé€šå¸¸è¢«è¢«å½¢å®¹æˆä¸€å å¡ç‰‡ï¼šè¦ä¹ˆåœ¨æœ€ä¸Šé¢æ·»åŠ å¡ç‰‡ï¼Œè¦ä¹ˆä»æœ€ä¸Šé¢æ‹¿èµ°å¡ç‰‡ï¼š
![](https://zh.javascript.info/article/array/stack.svg)

å¯¹äºæ ˆæ¥è¯´ï¼Œæœ€åæ”¾è¿›å»çš„å†…å®¹æ˜¯æœ€å…ˆæ¥æ”¶çš„ï¼Œä¹Ÿå«åš LIFOï¼ˆLast-In-First-Outï¼‰ï¼Œå³åè¿›å…ˆå‡ºæ³•åˆ™ã€‚è€Œä¸é˜Ÿåˆ—ç›¸å¯¹åº”çš„å«åš FIFOï¼ˆFirst-In-First-Outï¼‰ï¼Œå³å…ˆè¿›å…ˆå‡ºã€‚

JavaScript ä¸­çš„æ•°ç»„æ—¢å¯ä»¥ç”¨ä½œé˜Ÿåˆ—ï¼Œä¹Ÿå¯ä»¥ç”¨ä½œæ ˆã€‚å®ƒä»¬å…è®¸ä½ ä»é¦–ç«¯/æœ«ç«¯æ¥æ·»åŠ /åˆ é™¤å…ƒç´ ã€‚

è¿™åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œå…è®¸è¿™æ ·çš„æ“ä½œçš„æ•°æ®ç»“æ„è¢«ç§°ä¸º [åŒç«¯é˜Ÿåˆ—ï¼ˆdequeï¼‰](https://en.wikipedia.org/wiki/Double-ended_queue)ã€‚

### 4.2.1. ä½œç”¨äºæ•°ç»„æœ«ç«¯çš„æ–¹æ³•

**`pop`** å–å‡ºå¹¶è¿”å›æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼š

```js
let fruits = ["Apple", "Orange", "Pear"];

alert(fruits.pop()); // ç§»é™¤ "Pear" ç„¶å alert æ˜¾ç¤ºå‡ºæ¥

alert(fruits); // Apple, Orange
```

**`push`** åœ¨æ•°ç»„æœ«ç«¯æ·»åŠ å…ƒç´ ï¼š

```js
let fruits = ["Apple", "Orange"];

fruits.push("Pear");

alert(fruits); // Apple, Orange, Pear
```

è°ƒç”¨ `fruits.push(...)` ä¸ `fruits[fruits.length] = ...` æ˜¯ä¸€æ ·çš„ã€‚

### 4.2.2. ä½œç”¨äºæ•°ç»„é¦–ç«¯çš„æ–¹æ³•ï¼š

**`shift`** å–å‡ºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¹¶è¿”å›å®ƒï¼š

```js
let fruits = ["Apple", "Orange", "Pear"];

alert(fruits.shift()); // ç§»é™¤ Apple ç„¶å alert æ˜¾ç¤ºå‡ºæ¥

alert(fruits); // Orange, Pear
```

**`unshift`** åœ¨æ•°ç»„çš„é¦–ç«¯æ·»åŠ å…ƒç´ 

```JS
let fruits = ["Orange", "Pear"];

fruits.unshift('Apple');

alert( fruits ); // Apple, Orange, Pear
```

`push` å’Œ `unshift` æ–¹æ³•éƒ½å¯ä»¥ä¸€æ¬¡æ·»åŠ å¤šä¸ªå…ƒç´ ï¼š

```JS
let fruits = ["Apple"];

fruits.push("Orange", "Peach");
fruits.unshift("Pineapple", "Lemon");

// ["Pineapple", "Lemon", "Apple", "Orange", "Peach"]
alert( fruits );
```

## 4.3. å†…éƒ¨

æ•°ç»„æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡ã€‚ä½¿ç”¨æ–¹æ‹¬å·æ¥è®¿é—®å±æ€§ `arr[0]` å®é™…ä¸Šæ˜¯æ¥è‡ªäºå¯¹è±¡çš„è¯­æ³•ã€‚å®ƒå…¶å®ä¸ `obj[key]` ç›¸åŒï¼Œå…¶ä¸­ `arr` æ˜¯å¯¹è±¡ï¼Œè€Œæ•°å­—ç”¨ä½œé”®ï¼ˆkeyï¼‰ã€‚

å®ƒä»¬æ‰©å±•äº†å¯¹è±¡ï¼Œæä¾›äº†ç‰¹æ®Šçš„æ–¹æ³•æ¥å¤„ç†æœ‰åºçš„æ•°æ®é›†åˆä»¥åŠ `length` å±æ€§ã€‚ä½†ä»æœ¬è´¨ä¸Šè®²ï¼Œå®ƒä»ç„¶æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚

è®°ä½ï¼Œåœ¨ JavaScript ä¸­åªæœ‰ 7 ç§åŸºæœ¬ç±»å‹ã€‚æ•°ç»„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤å…¶è¡Œä¸ºä¹Ÿåƒä¸€ä¸ªå¯¹è±¡ã€‚

ä¾‹å¦‚ï¼Œå®ƒæ˜¯é€šè¿‡å¼•ç”¨æ¥å¤åˆ¶çš„ï¼š

```js
let fruits = ["Banana"];

let arr = fruits; // é€šè¿‡å¼•ç”¨å¤åˆ¶ (ä¸¤ä¸ªå˜é‡å¼•ç”¨çš„æ˜¯ç›¸åŒçš„æ•°ç»„)

alert(arr === fruits); // true

arr.push("Pear"); // é€šè¿‡å¼•ç”¨ä¿®æ”¹æ•°ç»„

alert(fruits); // Banana, Pear â€” ç°åœ¨æœ‰ 2 é¡¹äº†
```

â€¦â€¦ä½†æ˜¯æ•°ç»„çœŸæ­£ç‰¹æ®Šçš„æ˜¯å®ƒä»¬çš„å†…éƒ¨å®ç°ã€‚`JavaScript` å¼•æ“å°è¯•æŠŠè¿™äº›å…ƒç´ ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°å­˜å‚¨åœ¨è¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œå°±åƒæœ¬ç« çš„æ’å›¾æ˜¾ç¤ºçš„ä¸€æ ·ï¼Œè€Œä¸”è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„ä¼˜åŒ–ï¼Œä»¥ä½¿æ•°ç»„è¿è¡Œå¾—éå¸¸å¿«ã€‚

ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸åƒâ€œæœ‰åºé›†åˆâ€é‚£æ ·ä½¿ç”¨æ•°ç»„ï¼Œè€Œæ˜¯åƒå¸¸è§„å¯¹è±¡é‚£æ ·ä½¿ç”¨æ•°ç»„ï¼Œè¿™äº›å°±éƒ½ä¸ç”Ÿæ•ˆäº†ã€‚

ä¾‹å¦‚ï¼Œä»æŠ€æœ¯ä¸Šè®²ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åš:

```js
let fruits = []; // åˆ›å»ºä¸€ä¸ªæ•°ç»„

fruits[99999] = 5; // åˆ†é…ç´¢å¼•è¿œå¤§äºæ•°ç»„é•¿åº¦çš„å±æ€§

fruits.age = 25; // åˆ›å»ºä¸€ä¸ªå…·æœ‰ä»»æ„åç§°çš„å±æ€§
```

è¿™æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºæ•°ç»„æ˜¯åŸºäºå¯¹è±¡çš„ã€‚æˆ‘ä»¬å¯ä»¥ç»™å®ƒä»¬æ·»åŠ ä»»ä½•å±æ€§ã€‚

ä½†æ˜¯ Javascript å¼•æ“ä¼šå‘ç°ï¼Œæˆ‘ä»¬åœ¨åƒä½¿ç”¨å¸¸è§„å¯¹è±¡ä¸€æ ·ä½¿ç”¨æ•°ç»„ï¼Œé‚£ä¹ˆé’ˆå¯¹æ•°ç»„çš„ä¼˜åŒ–å°±ä¸å†é€‚ç”¨äº†ï¼Œç„¶åå¯¹åº”çš„ä¼˜åŒ–å°±ä¼šè¢«å…³é—­ï¼Œè¿™äº›ä¼˜åŒ–æ‰€å¸¦æ¥çš„ä¼˜åŠ¿ä¹Ÿå°±è¡ç„¶æ— å­˜äº†ã€‚

æ•°ç»„è¯¯ç”¨çš„å‡ ç§æ–¹å¼:

- æ·»åŠ ä¸€ä¸ªéæ•°å­—çš„å±æ€§ï¼Œæ¯”å¦‚ `arr.test = 5`ã€‚
- åˆ¶é€ ç©ºæ´ï¼Œæ¯”å¦‚ï¼šæ·»åŠ  `arr[0]`ï¼Œç„¶åæ·»åŠ  `arr[1000]` (å®ƒä»¬ä¸­é—´ä»€ä¹ˆéƒ½æ²¡æœ‰)ã€‚
- ä»¥å€’åºå¡«å……æ•°ç»„ï¼Œæ¯”å¦‚ `arr[1000]`ï¼Œ`arr[999]` ç­‰ç­‰ã€‚

è¯·å°†æ•°ç»„è§†ä¸ºä½œç”¨äº **æœ‰åºæ•°æ®** çš„ç‰¹æ®Šç»“æ„ã€‚å®ƒä»¬ä¸ºæ­¤æä¾›äº†ç‰¹æ®Šçš„æ–¹æ³•ã€‚æ•°ç»„åœ¨ `JavaScript` å¼•æ“å†…éƒ¨æ˜¯ç»è¿‡ç‰¹æ®Šè°ƒæ•´çš„ï¼Œä½¿å¾—æ›´å¥½åœ°ä½œç”¨äºè¿ç»­çš„æœ‰åºæ•°æ®ï¼Œæ‰€ä»¥è¯·ä»¥æ­£ç¡®çš„æ–¹å¼ä½¿ç”¨æ•°ç»„ã€‚å¦‚æœä½ éœ€è¦ä»»æ„é”®å€¼ï¼Œé‚£å¾ˆæœ‰å¯èƒ½å®é™…ä¸Šä½ éœ€è¦çš„æ˜¯å¸¸è§„å¯¹è±¡ {}ã€‚

## 4.4. æ€§èƒ½

`push/pop` æ–¹æ³•è¿è¡Œçš„æ¯”è¾ƒå¿«ï¼Œè€Œ `shift/unshift` æ¯”è¾ƒæ…¢ã€‚
![](https://zh.javascript.info/article/array/array-speed.svg)

ä¸ºä»€ä¹ˆä½œç”¨äºæ•°ç»„çš„æœ«ç«¯ä¼šæ¯”é¦–ç«¯å¿«å‘¢ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹åœ¨æ‰§è¡ŒæœŸé—´éƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼š

```js
fruits.shift(); // ä»é¦–ç«¯å–å‡ºä¸€ä¸ªå…ƒç´ 
```

åªè·å–å¹¶ç§»é™¤æ•°å­— `0` å¯¹åº”çš„å…ƒç´ æ˜¯ä¸å¤Ÿçš„ã€‚å…¶å®ƒå…ƒç´ ä¹Ÿéœ€è¦è¢«é‡æ–°ç¼–å·ã€‚

`shift` æ“ä½œå¿…é¡»åšä¸‰ä»¶äº‹:

1. ç§»é™¤ç´¢å¼•ä¸º `0` çš„å…ƒç´ ã€‚
2. æŠŠæ‰€æœ‰çš„å…ƒç´ å‘å·¦ç§»åŠ¨ï¼ŒæŠŠç´¢å¼• `1` æ”¹æˆ `0`ï¼Œ`2` æ”¹æˆ `1` ä»¥æ­¤ç±»æ¨ï¼Œå¯¹å…¶é‡æ–°ç¼–å·ã€‚
3. æ›´æ–° `length` å±æ€§ã€‚

![](https://zh.javascript.info/article/array/array-shift.svg)

**æ•°ç»„é‡Œçš„å…ƒç´ è¶Šå¤šï¼Œç§»åŠ¨å®ƒä»¬å°±è¦èŠ±è¶Šå¤šçš„æ—¶é—´ï¼Œä¹Ÿå°±æ„å‘³ç€è¶Šå¤šçš„å†…å­˜æ“ä½œã€‚**

`unshift` ä¹Ÿæ˜¯ä¸€æ ·ï¼šä¸ºäº†åœ¨æ•°ç»„çš„é¦–ç«¯æ·»åŠ å…ƒç´ ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å°†ç°æœ‰çš„å…ƒç´ å‘å³ç§»åŠ¨ï¼Œå¢åŠ å®ƒä»¬çš„ç´¢å¼•å€¼ã€‚

é‚£ `push/pop` æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿå®ƒä»¬ä¸éœ€è¦ç§»åŠ¨ä»»ä½•ä¸œè¥¿ã€‚å¦‚æœä»æœ«ç«¯ç§»é™¤ä¸€ä¸ªå…ƒç´ ï¼Œ`pop` æ–¹æ³•åªéœ€è¦æ¸…ç†ç´¢å¼•å€¼å¹¶ç¼©çŸ­ `length` å°±å¯ä»¥äº†ã€‚

`pop` æ“ä½œçš„è¡Œä¸ºï¼š

```js
fruits.pop(); // ä»æœ«ç«¯å–èµ°ä¸€ä¸ªå…ƒç´ 
```

![](https://zh.javascript.info/article/array/array-pop.svg)

**`pop`æ–¹æ³•ä¸éœ€è¦ç§»åŠ¨ä»»ä½•ä¸œè¥¿ï¼Œå› ä¸ºå…¶å®ƒå…ƒç´ éƒ½ä¿ç•™äº†å„è‡ªçš„ç´¢å¼•ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ`pop` ä¼šç‰¹åˆ«å¿«ã€‚**

`push` æ–¹æ³•ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚

## 4.5. å¾ªç¯

éå†æ•°ç»„æœ€å¤è€çš„æ–¹å¼å°±æ˜¯ `for` å¾ªç¯ï¼š

```js
let arr = ["Apple", "Orange", "Pear"];

for (let i = 0; i < arr.length; i++) {
  alert(arr[i]);
}
```

ä½†å¯¹äºæ•°ç»„æ¥è¯´è¿˜æœ‰å¦ä¸€ç§å¾ªç¯æ–¹å¼ï¼Œ`for..of`ï¼š

```js
let fruits = ["Apple", "Orange", "Plum"];

// éå†æ•°ç»„å…ƒç´ 
for (let fruit of fruits) {
  alert(fruit);
}
```

`for..of`ä¸èƒ½è·å–å½“å‰å…ƒç´ çš„ç´¢å¼•ï¼Œåªæ˜¯è·å–å…ƒç´ å€¼ï¼Œä½†å¤§å¤šæ•°æƒ…å†µæ˜¯å¤Ÿç”¨çš„ã€‚è€Œä¸”è¿™æ ·å†™æ›´çŸ­ã€‚

æŠ€æœ¯ä¸Šæ¥è®²ï¼Œå› ä¸ºæ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä½¿ç”¨ `for..in` ä¹Ÿæ˜¯å¯ä»¥çš„ï¼š

```js
let arr = ["Apple", "Orange", "Pear"];

for (let key in arr) {
  alert(arr[key]); // Apple, Orange, Pear
}
```

ä½†è¿™å…¶å®æ˜¯ä¸€ä¸ªå¾ˆä¸å¥½çš„æƒ³æ³•ã€‚ä¼šæœ‰ä¸€äº›æ½œåœ¨é—®é¢˜å­˜åœ¨ï¼š

1. `for..in` å¾ªç¯ä¼šéå† **æ‰€æœ‰å±æ€§**ï¼Œä¸ä»…ä»…æ˜¯è¿™äº›æ•°å­—å±æ€§ã€‚

   åœ¨æµè§ˆå™¨å’Œå…¶å®ƒç¯å¢ƒä¸­æœ‰ä¸€ç§ç§°ä¸ºâ€œç±»æ•°ç»„â€çš„å¯¹è±¡ï¼Œå®ƒä»¬ **çœ‹ä¼¼æ˜¯æ•°ç»„**ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬æœ‰`length` å’Œç´¢å¼•å±æ€§ï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½æœ‰å…¶å®ƒçš„éæ•°å­—çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™é€šå¸¸æ˜¯æˆ‘ä»¬ä¸éœ€è¦çš„ã€‚`for..in`å¾ªç¯ä¼šæŠŠå®ƒä»¬éƒ½åˆ—å‡ºæ¥ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬éœ€è¦å¤„ç†ç±»æ•°ç»„å¯¹è±¡ï¼Œè¿™äº›â€œé¢å¤–â€çš„å±æ€§å°±ä¼šå­˜åœ¨é—®é¢˜ã€‚

2. `for..in` å¾ªç¯é€‚ç”¨äºæ™®é€šå¯¹è±¡ï¼Œå¹¶ä¸”åšäº†å¯¹åº”çš„ä¼˜åŒ–ã€‚ä½†æ˜¯ä¸é€‚ç”¨äºæ•°ç»„ï¼Œå› æ­¤é€Ÿåº¦è¦æ…¢ 10-100 å€ã€‚å½“ç„¶å³ä½¿æ˜¯è¿™æ ·ä¹Ÿä¾ç„¶éå¸¸å¿«ã€‚åªæœ‰åœ¨é‡åˆ°ç“¶é¢ˆæ—¶å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚ä½†æ˜¯æˆ‘ä»¬ä»ç„¶åº”è¯¥äº†è§£è¿™å…¶ä¸­çš„ä¸åŒã€‚

é€šå¸¸æ¥è¯´ï¼Œæˆ‘ä»¬ä¸åº”è¯¥ç”¨ `for..in` æ¥å¤„ç†æ•°ç»„ã€‚

## 4.6. å…³äº â€œlengthâ€

å½“æˆ‘ä»¬ä¿®æ”¹æ•°ç»„çš„æ—¶å€™ï¼Œ`length` å±æ€§ä¼šè‡ªåŠ¨æ›´æ–°ã€‚å‡†ç¡®æ¥è¯´ï¼Œå®ƒå®é™…ä¸Šä¸æ˜¯æ•°ç»„é‡Œå…ƒç´ çš„ä¸ªæ•°ï¼Œè€Œæ˜¯æœ€å¤§çš„æ•°å­—ç´¢å¼•å€¼åŠ ä¸€ã€‚

ä¾‹å¦‚ï¼Œä¸€ä¸ªæ•°ç»„åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œä½†æ˜¯è¿™ä¸ªå…ƒç´ çš„ç´¢å¼•å€¼å¾ˆå¤§ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°ç»„çš„ `length` ä¹Ÿä¼šå¾ˆå¤§ï¼š

```js
let fruits = [];
fruits[123] = "Apple";

alert(fruits.length); // 124
```

è¦çŸ¥é“çš„æ˜¯æˆ‘ä»¬é€šå¸¸ä¸ä¼šè¿™æ ·ä½¿ç”¨æ•°ç»„ã€‚

`length` å±æ€§çš„å¦ä¸€ä¸ªæœ‰æ„æ€çš„ç‚¹æ˜¯å®ƒæ˜¯å¯å†™çš„ã€‚

å¦‚æœæˆ‘ä»¬æ‰‹åŠ¨å¢åŠ å®ƒï¼Œåˆ™ä¸ä¼šå‘ç”Ÿä»»ä½•æœ‰è¶£çš„äº‹å„¿ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬å‡å°‘å®ƒï¼Œæ•°ç»„å°±ä¼šè¢«æˆªæ–­ã€‚è¯¥è¿‡ç¨‹æ˜¯ä¸å¯é€†çš„ï¼Œä¸‹é¢æ˜¯ä¾‹å­ï¼š

```js
let arr = [1, 2, 3, 4, 5];

arr.length = 2; // æˆªæ–­åˆ°åªå‰© 2 ä¸ªå…ƒç´ 
alert(arr); // [1, 2]

arr.length = 5; // åˆæŠŠ length åŠ å›æ¥
alert(arr[3]); // undefinedï¼šè¢«æˆªæ–­çš„é‚£äº›æ•°å€¼å¹¶æ²¡æœ‰å›æ¥
```

æ‰€ä»¥ï¼Œæ¸…ç©ºæ•°ç»„æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ï¼š`arr.length = 0`;ã€‚

## 4.7. new Array()

è¿™æ˜¯åˆ›å»ºæ•°ç»„çš„å¦ä¸€ç§è¯­æ³•ï¼š

```js
let arr = new Array("Apple", "Pear", "etc");
```

å®ƒå¾ˆå°‘è¢«ä½¿ç”¨ï¼Œå› ä¸ºæ–¹æ‹¬å·`[]` æ›´çŸ­æ›´ç®€æ´ã€‚è€Œä¸”è¿™ç§è¯­æ³•è¿˜å­˜åœ¨ä¸€äº›è¯¡å¼‚çš„ç‰¹æ€§ã€‚

å¦‚æœä½¿ç”¨å•ä¸ªå‚æ•°ï¼ˆå³æ•°å­—ï¼‰è°ƒç”¨ new Arrayï¼Œé‚£ä¹ˆå®ƒä¼šåˆ›å»ºä¸€ä¸ª **æŒ‡å®šäº†é•¿åº¦ï¼Œå´æ²¡æœ‰ä»»ä½•é¡¹** çš„æ•°ç»„ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•æ¬èµ·çŸ³å¤´ç ¸è‡ªå·±çš„è„š:

```js
let arr = new Array(2); // ä¼šåˆ›å»ºä¸€ä¸ª [2] çš„æ•°ç»„å—ï¼Ÿ

alert(arr[0]); // undefinedï¼æ²¡æœ‰å…ƒç´ ã€‚

alert(arr.length); // length 2
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`new Array(number)` åˆ›å»ºçš„æ•°ç»„çš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯ `undefined`ã€‚

ä¸ºäº†é¿å…è¿™ç§ä¹Œé¾™äº‹ä»¶ï¼Œæˆ‘ä»¬é€šå¸¸éƒ½æ˜¯ä½¿ç”¨æ–¹æ‹¬å·çš„ï¼Œé™¤éæˆ‘ä»¬æ¸…æ¥šåœ°çŸ¥é“è‡ªå·±æ­£åœ¨åšä»€ä¹ˆã€‚

## 4.8. å¤šç»´æ•°ç»„

æ•°ç»„é‡Œçš„é¡¹ä¹Ÿå¯ä»¥æ˜¯æ•°ç»„ã€‚æˆ‘ä»¬å¯ä»¥å°†å…¶ç”¨äºå¤šç»´æ•°ç»„ï¼Œä¾‹å¦‚å­˜å‚¨çŸ©é˜µï¼š

```js
let matrix = [
  [1, 2, 3],
  [4, 5, 6],
  [7, 8, 9],
];

alert(matrix[1][1]); // æœ€ä¸­é—´çš„é‚£ä¸ªæ•°
```

## 4.9. toString

æ•°ç»„æœ‰è‡ªå·±çš„ `toString` æ–¹æ³•çš„å®ç°ï¼Œä¼šè¿”å›ä»¥é€—å·éš”å¼€çš„å…ƒç´ åˆ—è¡¨ã€‚

ä¾‹å¦‚ï¼š

```js
let arr = [1, 2, 3];

alert(arr); // 1,2,3
alert(String(arr) === "1,2,3"); // true
```

æ­¤å¤–ï¼Œæˆ‘ä»¬è¯•è¯•è¿è¡Œä¸€ä¸‹è¿™ä¸ªï¼š

```js
alert([] + 1); // "1"
alert([1] + 1); // "11"
alert([1, 2] + 1); // "1,21"
```

æ•°ç»„æ²¡æœ‰ `Symbol.toPrimitive`ï¼Œä¹Ÿæ²¡æœ‰ `valueOf`ï¼Œå®ƒä»¬åªèƒ½æ‰§è¡Œ `toString`è¿›è¡Œè½¬æ¢ï¼Œæ‰€ä»¥è¿™é‡Œ `[]` å°±å˜æˆäº†ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œ`[1]` å˜æˆäº† `"1"`ï¼Œ`[1,2]` å˜æˆäº† `"1,2"`ã€‚

å½“ `"+"` è¿ç®—ç¬¦æŠŠä¸€äº›é¡¹åŠ åˆ°å­—ç¬¦ä¸²åé¢æ—¶ï¼ŒåŠ å·åé¢çš„é¡¹ä¹Ÿä¼šè¢«è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸‹ä¸€æ­¥å°±ä¼šæ˜¯è¿™æ ·ï¼š

```js
alert("" + 1); // "1"
alert("1" + 1); // "11"
alert("1,2" + 1); // "1,21"
```

## 4.10. æ€»ç»“

æ•°ç»„æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡ï¼Œé€‚ç”¨äºå­˜å‚¨å’Œç®¡ç†æœ‰åºçš„æ•°æ®é¡¹ã€‚

- å£°æ˜:

  ```js
  // æ–¹æ‹¬å· (å¸¸è§ç”¨æ³•)
  let arr = [item1, item2...];

  // new Array (æå…¶å°‘è§)
  let arr = new Array(item1, item2...);
  ```

  è°ƒç”¨ `new Array(number)` ä¼šåˆ›å»ºä¸€ä¸ªç»™å®šé•¿åº¦çš„æ•°ç»„ï¼Œä½†ä¸å«æœ‰ä»»ä½•é¡¹ã€‚

- `length` å±æ€§æ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œå‡†ç¡®åœ°è¯´ï¼Œå®ƒæ˜¯æ•°ç»„æœ€åä¸€ä¸ªæ•°å­—ç´¢å¼•å€¼åŠ ä¸€ã€‚å®ƒç”±æ•°ç»„æ–¹æ³•è‡ªåŠ¨è°ƒæ•´ã€‚
- å¦‚æœæˆ‘ä»¬æ‰‹åŠ¨ç¼©çŸ­ `length`ï¼Œé‚£ä¹ˆæ•°ç»„å°±ä¼šè¢«æˆªæ–­ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹åˆ—æ“ä½œä»¥åŒç«¯é˜Ÿåˆ—çš„æ–¹å¼ä½¿ç”¨æ•°ç»„ï¼š

- `push(...items)` åœ¨æœ«ç«¯æ·»åŠ  `items`é¡¹ã€‚
- `pop()` ä»æœ«ç«¯ç§»é™¤å¹¶è¿”å›è¯¥å…ƒç´ ã€‚
- `shift()` ä»é¦–ç«¯ç§»é™¤å¹¶è¿”å›è¯¥å…ƒç´ ã€‚
- `unshift(...items)` ä»é¦–ç«¯æ·»åŠ  `items` é¡¹ã€‚

éå†æ•°ç»„çš„å…ƒç´ ï¼š

- `for (let i=0; i<arr.length; i++)` â€” è¿è¡Œå¾—æœ€å¿«ï¼Œå¯å…¼å®¹æ—§ç‰ˆæœ¬æµè§ˆå™¨ã€‚
- `for (let item of arr)` â€” ç°ä»£è¯­æ³•ï¼Œåªèƒ½è®¿é—® itemsã€‚
- `for (let i in arr)` â€” æ°¸è¿œä¸è¦ç”¨è¿™ä¸ªã€‚

# 5. æ•°ç»„æ–¹æ³•

æ•°ç»„æä¾›çš„æ–¹æ³•æœ‰å¾ˆå¤šã€‚ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æŒ‰ç»„è®²è§£ã€‚

## 5.1. æ·»åŠ /ç§»é™¤æ•°ç»„å…ƒç´ 

æˆ‘ä»¬å·²ç»å­¦äº†ä»æ•°ç»„çš„é¦–ç«¯æˆ–å°¾ç«¯æ·»åŠ å’Œåˆ é™¤å…ƒç´ çš„æ–¹æ³•ï¼š

- `arr.push(...items)` â€” ä»å°¾ç«¯æ·»åŠ å…ƒç´ ï¼Œ
- `arr.pop()` â€” ä»å°¾ç«¯æå–å…ƒç´ ï¼Œ
- `arr.shift()` â€” ä»é¦–ç«¯æå–å…ƒç´ ï¼Œ
- `arr.unshift(...items)` â€” ä»é¦–ç«¯æ·»åŠ å…ƒç´ ã€‚

è¿™é‡Œè¿˜æœ‰å…¶ä»–å‡ ç§æ–¹æ³•ã€‚

### 5.1.1. splice

å¦‚ä½•ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ ï¼Ÿ

æ•°ç»„æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ `delete`ï¼š

```js
let arr = ["I", "go", "home"];

delete arr[1]; // remove "go"

alert(arr[1]); // undefined

// now arr = ["I",  , "home"];
alert(arr.length); // 3
```

å…ƒç´ è¢«åˆ é™¤äº†ï¼Œä½†æ•°ç»„ä»ç„¶æœ‰ 3 ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° `arr.length == 3`ã€‚

è¿™å¾ˆæ­£å¸¸ï¼Œå› ä¸º `delete obj.key` æ˜¯é€šè¿‡ `key` æ¥ç§»é™¤å¯¹åº”çš„å€¼ã€‚å¯¹äºå¯¹è±¡æ¥è¯´æ˜¯å¯ä»¥çš„ã€‚ä½†æ˜¯å¯¹äºæ•°ç»„æ¥è¯´ï¼Œæˆ‘ä»¬é€šå¸¸å¸Œæœ›å‰©ä¸‹çš„å…ƒç´ èƒ½å¤Ÿç§»åŠ¨å¹¶å æ®è¢«é‡Šæ”¾çš„ä½ç½®ã€‚æˆ‘ä»¬å¸Œæœ›å¾—åˆ°ä¸€ä¸ªæ›´çŸ­çš„æ•°ç»„ã€‚

æ‰€ä»¥åº”è¯¥ä½¿ç”¨ç‰¹æ®Šçš„æ–¹æ³•ã€‚

[arr.splice(str)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/splice) æ–¹æ³•å¯ä»¥è¯´æ˜¯å¤„ç†æ•°ç»„çš„ç‘å£«å†›åˆ€ã€‚å®ƒå¯ä»¥åšæ‰€æœ‰äº‹æƒ…ï¼šæ·»åŠ ï¼Œåˆ é™¤å’Œæ’å…¥å…ƒç´ ã€‚

è¯­æ³•æ˜¯ï¼š

```js
arr.splice(index[, deleteCount, elem1, ..., elemN])
```

ä» `index` å¼€å§‹ï¼šåˆ é™¤ `deleteCount` ä¸ªå…ƒç´ å¹¶åœ¨å½“å‰ä½ç½®æ’å…¥ `elem1`, ..., `elemN`ã€‚æœ€åè¿”å›å·²åˆ é™¤å…ƒç´ çš„æ•°ç»„ã€‚

é€šè¿‡ä¾‹å­æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°æŒæ¡è¿™ä¸ªæ–¹æ³•ã€‚

è®©æˆ‘ä»¬ä»åˆ é™¤å¼€å§‹ï¼š

```js
let arr = ["I", "study", "JavaScript"];

arr.splice(1, 1); // ä»ç´¢å¼• 1 å¼€å§‹åˆ é™¤ 1 ä¸ªå…ƒç´ 

alert(arr); // ["I", "JavaScript"]
```

ç®€å•ï¼Œå¯¹å§ï¼Ÿä»ç´¢å¼• `1` å¼€å§‹åˆ é™¤ `1` ä¸ªå…ƒç´ ã€‚

åœ¨ä¸‹ä¸€ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ é™¤äº† `3` ä¸ªå…ƒç´ ï¼Œå¹¶ç”¨å¦å¤–ä¸¤ä¸ªå…ƒç´ æ›¿æ¢å®ƒä»¬

```js
let arr = ["I", "study", "JavaScript", "right", "now"];

// remove 3 first elements and replace them with another
arr.splice(0, 3, "Let's", "dance");

alert(arr); // now ["Let's", "dance", "right", "now"]
```

åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° `splice` è¿”å›äº†å·²åˆ é™¤å…ƒç´ çš„æ•°ç»„ï¼š

```js
let arr = ["I", "study", "JavaScript", "right", "now"];

// åˆ é™¤å‰ä¸¤ä¸ªå…ƒç´ 
let removed = arr.splice(0, 2);

alert(removed); // "I", "study" <-- è¢«ä»æ•°ç»„ä¸­åˆ é™¤äº†çš„å…ƒç´ 
```

æˆ‘ä»¬å¯ä»¥å°†`deleteCount` è®¾ç½®ä¸º`0`ï¼Œ`splice` æ–¹æ³•å°±èƒ½å¤Ÿæ’å…¥å…ƒç´ è€Œä¸ç”¨åˆ é™¤ä»»ä½•å…ƒç´ ï¼š

```js
let arr = ["I", "study", "JavaScript"];

// ä»ç´¢å¼• 2 å¼€å§‹
// åˆ é™¤ 0 ä¸ªå…ƒç´ 
// ç„¶åæ’å…¥ "complex" å’Œ "language"
arr.splice(2, 0, "complex", "language");

alert(arr); // "I", "study", "complex", "language", "JavaScript"
```

> :information_source:å…è®¸è´Ÿå‘ç´¢å¼•

åœ¨è¿™é‡Œå’Œå…¶ä»–æ•°ç»„æ–¹æ³•ä¸­ï¼Œè´Ÿå‘ç´¢å¼•éƒ½æ˜¯è¢«å…è®¸çš„ã€‚å®ƒä»¬ä»æ•°ç»„æœ«å°¾è®¡ç®—ä½ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```js
let arr = [1, 2, 5];

// ä»ç´¢å¼• -1ï¼ˆå°¾ç«¯å‰ä¸€ä½ï¼‰
// åˆ é™¤ 0 ä¸ªå…ƒç´ ï¼Œ
// ç„¶åæ’å…¥ 3 å’Œ 4
arr.splice(-1, 0, 3, 4);

alert(arr); // 1,2,3,4,5
```

### 5.1.2. slice

[arr.slice](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/slice) æ–¹æ³•æ¯” arr.splice ç®€å•å¾—å¤šã€‚

è¯­æ³•æ˜¯ï¼š

```js
arr.slice([start], [end]);
```

å®ƒä¼šè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œå°†æ‰€æœ‰ä»ç´¢å¼• `start` åˆ° `end`ï¼ˆä¸åŒ…æ‹¬ `end`ï¼‰çš„æ•°ç»„é¡¹å¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚`start` å’Œ `end` éƒ½å¯ä»¥æ˜¯è´Ÿæ•°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»æœ«å°¾è®¡ç®—ç´¢å¼•ã€‚

å®ƒå’Œå­—ç¬¦ä¸²çš„ `str.slice` æ–¹æ³•æœ‰ç‚¹åƒï¼Œå°±æ˜¯æŠŠå­å­—ç¬¦ä¸²æ›¿æ¢æˆå­æ•°ç»„ã€‚

ä¾‹å¦‚ï¼š

```js
let arr = ["t", "e", "s", "t"];

alert(arr.slice(1, 3)); // e,sï¼ˆå¤åˆ¶ä»ä½ç½® 1 åˆ°ä½ç½® 3 çš„å…ƒç´ ï¼‰

alert(arr.slice(-2)); // s,tï¼ˆå¤åˆ¶ä»ä½ç½® -2 åˆ°å°¾ç«¯çš„å…ƒç´ ï¼‰
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸å¸¦å‚æ•°åœ°è°ƒç”¨å®ƒï¼š`arr.slice()` ä¼šåˆ›å»ºä¸€ä¸ª arr çš„å‰¯æœ¬ã€‚å…¶é€šå¸¸ç”¨äºè·å–å‰¯æœ¬ï¼Œä»¥è¿›è¡Œä¸å½±å“åŸå§‹æ•°ç»„çš„è¿›ä¸€æ­¥è½¬æ¢ã€‚

### 5.1.3. concat

[arr.concat](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/concat) åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«æ¥è‡ªäºå…¶ä»–æ•°ç»„å’Œå…¶ä»–é¡¹çš„å€¼ã€‚

è¯­æ³•ï¼š

```js
arr.concat(arg1, arg2...)
```

å®ƒæ¥å—ä»»æ„æ•°é‡çš„å‚æ•° â€” æ•°ç»„æˆ–å€¼éƒ½å¯ä»¥ã€‚

ç»“æœæ˜¯ä¸€ä¸ªåŒ…å«æ¥è‡ªäº `arr`ï¼Œç„¶åæ˜¯`arg1ï¼Œarg2` çš„å…ƒç´ çš„æ–°æ•°ç»„ã€‚

å¦‚æœå‚æ•° `argN` æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå…¶ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½ä¼šè¢«å¤åˆ¶ã€‚å¦åˆ™ï¼Œå°†å¤åˆ¶å‚æ•°æœ¬èº«ã€‚

ä¾‹å¦‚ï¼š

```js
let arr = [1, 2];

// create an array from: arr and [3,4]
alert(arr.concat([3, 4])); // 1,2,3,4

// create an array from: arr and [3,4] and [5,6]
alert(arr.concat([3, 4], [5, 6])); // 1,2,3,4,5,6

// create an array from: arr and [3,4], then add values 5 and 6
alert(arr.concat([3, 4], 5, 6)); // 1,2,3,4,5,6
```

é€šå¸¸ï¼Œå®ƒåªå¤åˆ¶æ•°ç»„ä¸­çš„å…ƒç´ ã€‚å…¶ä»–å¯¹è±¡ï¼Œå³ä½¿å®ƒä»¬çœ‹èµ·æ¥åƒæ•°ç»„ä¸€æ ·ï¼Œä½†ä»ç„¶ä¼šè¢«ä½œä¸ºä¸€ä¸ªæ•´ä½“æ·»åŠ ï¼š

```js
let arr = [1, 2];

let arrayLike = {
  0: "something",
  length: 1,
};

alert(arr.concat(arrayLike)); // 1,2,[object Object]
```

â€¦â€¦ä½†æ˜¯ï¼Œå¦‚æœç±»ä¼¼æ•°ç»„çš„å¯¹è±¡å…·æœ‰ `Symbol.isConcatSpreadable` å±æ€§ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¢« `concat` å½“ä½œä¸€ä¸ªæ•°ç»„æ¥å¤„ç†ï¼šæ­¤å¯¹è±¡ä¸­çš„å…ƒç´ å°†è¢«æ·»åŠ ï¼š

```js
let arr = [1, 2];

let arrayLike = {
  0: "something",
  1: "else",
  [Symbol.isConcatSpreadable]: true,
  length: 2,
};

alert(arr.concat(arrayLike)); // 1,2,something,else
```

## 5.2. éå†ï¼šforEach

[arr.forEach](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach) æ–¹æ³•å…è®¸ä¸ºæ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½è¿è¡Œä¸€ä¸ªå‡½æ•°ã€‚

è¯­æ³•ï¼š

```js
arr.forEach(function (item, index, array) {
  // ... do something with item
});
```

ä¾‹å¦‚ï¼Œä¸‹é¢è¿™ä¸ªç¨‹åºæ˜¾ç¤ºäº†æ•°ç»„çš„æ¯ä¸ªå…ƒç´ ï¼š

```js
// å¯¹æ¯ä¸ªå…ƒç´ è°ƒç”¨ alert
["Bilbo", "Gandalf", "Nazgul"].forEach(alert);
```

è€Œè¿™æ®µä»£ç æ›´è¯¦ç»†åœ°ä»‹ç»äº†å®ƒä»¬åœ¨ç›®æ ‡æ•°ç»„ä¸­çš„ä½ç½®ï¼š

```js
["Bilbo", "Gandalf", "Nazgul"].forEach((item, index, array) => {
  alert(`${item} is at index ${index} in ${array}`);
});
```

è¯¥å‡½æ•°çš„ç»“æœï¼ˆå¦‚æœå®ƒæœ‰è¿”å›ï¼‰ä¼šè¢«æŠ›å¼ƒå’Œå¿½ç•¥ã€‚

## 5.3. åœ¨æ•°ç»„ä¸­æœç´¢

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»‹ç»åœ¨æ•°ç»„ä¸­è¿›è¡Œæœç´¢çš„æ–¹æ³•ã€‚

### 5.3.1. indexOf/lastIndexOf å’Œ includes

[arr.indexOf](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf)ã€[arr.lastIndexOf](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/lastIndexOf) å’Œ [arr.includes](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/includes) æ–¹æ³•ä¸å­—ç¬¦ä¸²æ“ä½œå…·æœ‰ç›¸åŒçš„è¯­æ³•ï¼Œå¹¶ä¸”ä½œç”¨åŸºæœ¬ä¸Šä¹Ÿä¸å­—ç¬¦ä¸²çš„æ–¹æ³•ç›¸åŒï¼Œåªä¸è¿‡è¿™é‡Œæ˜¯å¯¹æ•°ç»„å…ƒç´ è€Œä¸æ˜¯å­—ç¬¦è¿›è¡Œæ“ä½œï¼š

- `arr.indexOf(item, from)` ä»ç´¢å¼• from å¼€å§‹æœç´¢ itemï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å›ç´¢å¼•ï¼Œå¦åˆ™è¿”å› -1ã€‚
- `arr.lastIndexOf(item, from)` â€” å’Œä¸Šé¢ç›¸åŒï¼Œåªæ˜¯ä»å³å‘å·¦æœç´¢ã€‚
- `arr.includes(item, from)` â€” ä»ç´¢å¼• `from` å¼€å§‹æœç´¢ `item`ï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å› `true`ï¼ˆè¯‘æ³¨ï¼šå¦‚æœæ²¡æ‰¾åˆ°ï¼Œåˆ™è¿”å› falseï¼‰ã€‚

ä¾‹å¦‚ï¼š

```js
let arr = [1, 0, false];

alert(arr.indexOf(0)); // 1
alert(arr.indexOf(false)); // 2
alert(arr.indexOf(null)); // -1

alert(arr.includes(1)); // true
```

è¯·æ³¨æ„ï¼Œè¿™äº›æ–¹æ³•ä½¿ç”¨çš„æ˜¯ä¸¥æ ¼ç›¸ç­‰ `===` æ¯”è¾ƒã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬æœç´¢ `false`ï¼Œä¼šç²¾ç¡®åˆ°çš„ç¡®æ˜¯ `false` è€Œä¸æ˜¯æ•°å­— `0`ã€‚

å¦‚æœæˆ‘ä»¬æƒ³æ£€æŸ¥æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ ï¼Œå¹¶ä¸”ä¸æƒ³çŸ¥é“ç¡®åˆ‡çš„ç´¢å¼•ï¼Œé‚£ä¹ˆ `arr.includes` æ˜¯é¦–é€‰ã€‚

æ­¤å¤–ï¼Œ`includes` çš„ä¸€ä¸ªéå¸¸å°çš„å·®åˆ«æ˜¯å®ƒèƒ½æ­£ç¡®å¤„ç† NaNï¼Œè€Œä¸åƒ `indexOf/lastIndexOf`ï¼š

```js
const arr = [NaN];
alert(arr.indexOf(NaN)); // -1ï¼ˆåº”è¯¥ä¸º 0ï¼Œä½†æ˜¯ä¸¥æ ¼ç›¸ç­‰ === equality å¯¹ NaN æ— æ•ˆï¼‰
alert(arr.includes(NaN)); // trueï¼ˆè¿™ä¸ªç»“æœæ˜¯å¯¹çš„ï¼‰
```

### 5.3.2. find å’Œ findIndex

æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¯¹è±¡æ•°ç»„ã€‚æˆ‘ä»¬å¦‚ä½•æ‰¾åˆ°å…·æœ‰ç‰¹å®šæ¡ä»¶çš„å¯¹è±¡ï¼Ÿ

è¿™æ—¶å¯ä»¥ç”¨ [arr.find](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/find) æ–¹æ³•ã€‚

è¯­æ³•å¦‚ä¸‹ï¼š

```js
let result = arr.find(function (item, index, array) {
  // å¦‚æœè¿”å› trueï¼Œåˆ™è¿”å› item å¹¶åœæ­¢è¿­ä»£
  // å¯¹äº falsy åˆ™è¿”å› undefined
});
```

ä¾æ¬¡å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨è¯¥å‡½æ•°ï¼š

- `item` æ˜¯å…ƒç´ ã€‚
- `index` æ˜¯å®ƒçš„ç´¢å¼•ã€‚
- `array` æ˜¯æ•°ç»„æœ¬èº«ã€‚

å¦‚æœå®ƒè¿”å› `true`ï¼Œåˆ™æœç´¢åœæ­¢ï¼Œå¹¶è¿”å› `item`ã€‚å¦‚æœæ²¡æœ‰æœç´¢åˆ°ï¼Œåˆ™è¿”å› undefinedã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå­˜å‚¨ç”¨æˆ·çš„æ•°ç»„ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ `id` å’Œ `name` å­—æ®µã€‚è®©æˆ‘ä»¬æ‰¾åˆ° `id == 1` çš„é‚£ä¸ªç”¨æˆ·ï¼š

```js
let users = [
  { id: 1, name: "John" },
  { id: 2, name: "Pete" },
  { id: 3, name: "Mary" },
];

let user = users.find((item) => item.id == 1);

alert(user.name); // John
```

åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œå¯¹è±¡æ•°ç»„æ˜¯å¾ˆå¸¸è§çš„ï¼Œæ‰€ä»¥ `find` æ–¹æ³•éå¸¸æœ‰ç”¨ã€‚

æ³¨æ„åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¼ ç»™äº† `find` ä¸€ä¸ªå•å‚æ•°å‡½æ•° `item => item.id == 1`ã€‚è¿™å¾ˆå…¸å‹ï¼Œå¹¶ä¸” find æ–¹æ³•çš„å…¶ä»–å‚æ•°å¾ˆå°‘ä½¿ç”¨ã€‚

[arr.findIndex](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex)æ–¹æ³•ï¼ˆä¸ arr.find æ–¹æ³•ï¼‰åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œä½†å®ƒè¿”å›æ‰¾åˆ°å…ƒç´ çš„ç´¢å¼•ï¼Œè€Œä¸æ˜¯å…ƒç´ æœ¬èº«ã€‚å¹¶ä¸”åœ¨æœªæ‰¾åˆ°ä»»ä½•å†…å®¹æ—¶è¿”å› -1ã€‚

### 5.3.3. filter

`find` æ–¹æ³•æœç´¢çš„æ˜¯ä½¿å‡½æ•°è¿”å› true çš„ç¬¬ä¸€ä¸ªï¼ˆå•ä¸ªï¼‰å…ƒç´ ã€‚

å¦‚æœéœ€è¦åŒ¹é…çš„æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `arr.filter(fn)`ã€‚

è¯­æ³•ä¸ `find` å¤§è‡´ç›¸åŒï¼Œä½†æ˜¯ `filter` è¿”å›çš„æ˜¯æ‰€æœ‰åŒ¹é…å…ƒç´ ç»„æˆçš„æ•°ç»„ï¼š

```js
let results = arr.filter(function (item, index, array) {
  // å¦‚æœ true item è¢« push åˆ° resultsï¼Œè¿­ä»£ç»§ç»­
  // å¦‚æœä»€ä¹ˆéƒ½æ²¡æ‰¾åˆ°ï¼Œåˆ™è¿”å›ç©ºæ•°ç»„
});
```

ä¾‹å¦‚ï¼š

```js
let users = [
  { id: 1, name: "John" },
  { id: 2, name: "Pete" },
  { id: 3, name: "Mary" },
];

// è¿”å›å‰ä¸¤ä¸ªç”¨æˆ·çš„æ•°ç»„
let someUsers = users.filter((item) => item.id < 3);

alert(someUsers.length); // 2
```

## 5.4. è½¬æ¢æ•°ç»„

è®©æˆ‘ä»¬ç»§ç»­å­¦ä¹ è¿›è¡Œæ•°ç»„è½¬æ¢å’Œé‡æ–°æ’åºçš„æ–¹æ³•ã€‚

### 5.4.1. map

[arr.map](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/map) æ–¹æ³•æ˜¯æœ€æœ‰ç”¨å’Œç»å¸¸ä½¿ç”¨çš„æ–¹æ³•ä¹‹ä¸€ã€‚

å®ƒå¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½è°ƒç”¨å‡½æ•°ï¼Œå¹¶è¿”å›ç»“æœæ•°ç»„ã€‚

è¯­æ³•ï¼š

```js
let result = arr.map(function (item, index, array) {
  // è¿”å›æ–°å€¼è€Œä¸æ˜¯å½“å‰å…ƒç´ 
});
```

ä¾‹å¦‚ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºå®ƒçš„å­—ç¬¦ä¸²é•¿åº¦ï¼š

```js
let lengths = ["Bilbo", "Gandalf", "Nazgul"].map((item) => item.length);
alert(lengths); // 5,7,6
```

### 5.4.2. sort(fn)

[arr.sort](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/sort) æ–¹æ³•å¯¹æ•°ç»„è¿›è¡Œ **åŸä½ï¼ˆin-placeï¼‰** æ’åºï¼Œæ›´æ”¹å…ƒç´ çš„é¡ºåºã€‚(è¯‘æ³¨ï¼šåŸä½æ˜¯æŒ‡åœ¨æ­¤æ•°ç»„å†…ï¼Œè€Œéç”Ÿæˆä¸€ä¸ªæ–°æ•°ç»„ã€‚)

å®ƒè¿˜è¿”å›æ’åºåçš„æ•°ç»„ï¼Œä½†æ˜¯è¿”å›å€¼é€šå¸¸ä¼šè¢«å¿½ç•¥ï¼Œå› ä¸ºä¿®æ”¹äº† arr æœ¬èº«ã€‚

è¯­æ³•ï¼š

```js
let arr = [1, 2, 15];

// è¯¥æ–¹æ³•é‡æ–°æ’åˆ— arr çš„å†…å®¹
arr.sort();

alert(arr); // 1, 15, 2
```

ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°ç»“æœæœ‰ä»€ä¹ˆå¥‡æ€ªçš„åœ°æ–¹ï¼Ÿ

é¡ºåºå˜æˆäº† `1, 15, 2`ã€‚ä¸å¯¹ï¼Œä½†ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ

**è¿™äº›å…ƒç´ é»˜è®¤æƒ…å†µä¸‹è¢«æŒ‰å­—ç¬¦ä¸²è¿›è¡Œæ’åºã€‚**

ä»å­—é¢ä¸Šçœ‹ï¼Œæ‰€æœ‰å…ƒç´ éƒ½è¢«è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒã€‚å¯¹äºå­—ç¬¦ä¸²ï¼ŒæŒ‰ç…§è¯å…¸é¡ºåºè¿›è¡Œæ’åºï¼Œå®é™…ä¸Šåº”è¯¥æ˜¯ `"2" > "15"`ã€‚

è¦ä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„æ’åºé¡ºåºï¼Œæˆ‘ä»¬éœ€è¦æä¾›ä¸€ä¸ªå‡½æ•°ä½œä¸º `arr.sort()` çš„å‚æ•°ã€‚

è¯¥å‡½æ•°åº”è¯¥æ¯”è¾ƒä¸¤ä¸ªä»»æ„å€¼å¹¶è¿”å›ï¼š

```js
function compare(a, b) {
  if (a > b) return 1; // å¦‚æœç¬¬ä¸€ä¸ªå€¼æ¯”ç¬¬äºŒä¸ªå€¼å¤§
  if (a == b) return 0; // å¦‚æœä¸¤ä¸ªå€¼ç›¸ç­‰
  if (a < b) return -1; // å¦‚æœç¬¬ä¸€ä¸ªå€¼æ¯”ç¬¬äºŒä¸ªå€¼å°
}
```

ä¾‹å¦‚ï¼ŒæŒ‰æ•°å­—è¿›è¡Œæ’åºï¼š

```js
function compareNumeric(a, b) {
  if (a > b) return 1;
  if (a == b) return 0;
  if (a < b) return -1;
}

let arr = [1, 2, 15];

arr.sort(compareNumeric);

alert(arr); // 1, 2, 15
```

ç°åœ¨ç»“æœç¬¦åˆé¢„æœŸäº†ã€‚

æˆ‘ä»¬æ€è€ƒä¸€ä¸‹è¿™å„¿å‘ç”Ÿäº†ä»€ä¹ˆã€‚`arr` å¯ä»¥æ˜¯ç”±ä»»ä½•å†…å®¹ç»„æˆçš„æ•°ç»„ï¼Œå¯¹å—ï¼Ÿå®ƒå¯èƒ½åŒ…å«æ•°å­—ã€å­—ç¬¦ä¸²ã€å¯¹è±¡æˆ–å…¶ä»–ä»»ä½•å†…å®¹ã€‚æˆ‘ä»¬æœ‰ä¸€ç»„ **ä¸€äº›å…ƒç´ **ã€‚è¦å¯¹å…¶è¿›è¡Œæ’åºï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª **æ’åºå‡½æ•°** æ¥ç¡®è®¤å¦‚ä½•æ¯”è¾ƒè¿™äº›å…ƒç´ ã€‚é»˜è®¤æ˜¯æŒ‰å­—ç¬¦ä¸²è¿›è¡Œæ’åºçš„

`arr.sort(fn)` æ–¹æ³•å®ç°äº†é€šç”¨çš„æ’åºç®—æ³•ã€‚æˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒå®ƒçš„å†…éƒ¨å·¥ä½œåŸç†ï¼ˆå¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯ç»è¿‡ [å¿«é€Ÿæ’åº](https://en.wikipedia.org/wiki/Quicksort) ç®—æ³•ä¼˜åŒ–çš„ï¼‰ã€‚å®ƒå°†éå†æ•°ç»„ï¼Œä½¿ç”¨æä¾›çš„å‡½æ•°æ¯”è¾ƒå…¶å…ƒç´ å¹¶å¯¹å…¶é‡æ–°æ’åºï¼Œæˆ‘ä»¬æ‰€éœ€è¦çš„å°±æ˜¯æä¾›æ‰§è¡Œæ¯”è¾ƒçš„å‡½æ•° fnã€‚

é¡ºä¾¿è¯´ä¸€å¥ï¼Œå¦‚æœæˆ‘ä»¬æƒ³çŸ¥é“è¦æ¯”è¾ƒå“ªäº›å…ƒç´  â€” é‚£ä¹ˆä»€ä¹ˆéƒ½ä¸ä¼šé˜»æ­¢ alert å®ƒä»¬ï¼š

```js
[1, -2, 15, 2, 0, 8].sort(function (a, b) {
  alert(a + " <> " + b);
});
```

è¯¥ç®—æ³•å¯ä»¥åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå°†ä¸€ä¸ªå…ƒç´ ä¸å¤šä¸ªå…¶ä»–å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œä½†æ˜¯å®ƒä¼šå°è¯•è¿›è¡Œå°½å¯èƒ½å°‘çš„æ¯”è¾ƒã€‚

> :information_source:æ¯”è¾ƒå‡½æ•°å¯ä»¥è¿”å›ä»»ä½•æ•°å­—

å®é™…ä¸Šï¼Œæ¯”è¾ƒå‡½æ•°åªéœ€è¦è¿”å›ä¸€ä¸ªæ­£æ•°è¡¨ç¤ºâ€œå¤§äºâ€ï¼Œä¸€ä¸ªè´Ÿæ•°è¡¨ç¤ºâ€œå°äºâ€ã€‚

é€šè¿‡è¿™ä¸ªåŸç†æˆ‘ä»¬å¯ä»¥ç¼–å†™æ›´çŸ­çš„å‡½æ•°ï¼š

```js
let arr = [1, 2, 15];

arr.sort(function (a, b) {
  return a - b;
});

alert(arr); // 1, 2, 15
```

> :information_source:ç®­å¤´å‡½æ•°æœ€å¥½

ä½ è¿˜è®°å¾— ç®­å¤´å‡½æ•° å—ï¼Ÿè¿™é‡Œä½¿ç”¨ç®­å¤´å‡½æ•°ä¼šæ›´åŠ ç®€æ´ï¼š

```js
arr.sort((a, b) => a - b);
```

è¿™ä¸ä¸Šé¢æ›´é•¿çš„ç‰ˆæœ¬å®Œå…¨ç›¸åŒã€‚

> :information_source:ä½¿ç”¨ localeCompare for strings

ä½ è®°å¾— [å­—ç¬¦ä¸²æ¯”è¾ƒ](https://zh.javascript.info/string#correct-comparisons) ç®—æ³•å—ï¼Ÿé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒé€šè¿‡å­—æ¯çš„ä»£ç æ¯”è¾ƒå­—æ¯ã€‚

å¯¹äºè®¸å¤šå­—æ¯ï¼Œæœ€å¥½ä½¿ç”¨ `str.localeCompare` æ–¹æ³•æ­£ç¡®åœ°å¯¹å­—æ¯è¿›è¡Œæ’åºï¼Œä¾‹å¦‚ `Ã–`ã€‚

ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬ç”¨å¾·è¯­å¯¹å‡ ä¸ªå›½å®¶/åœ°åŒºè¿›è¡Œæ’åºï¼š

```js
let countries = ["Ã–sterreich", "Andorra", "Vietnam"];

alert(countries.sort((a, b) => (a > b ? 1 : -1))); // Andorra, Vietnam, Ã–sterreichï¼ˆé”™çš„ï¼‰

alert(countries.sort((a, b) => a.localeCompare(b))); // Andorra,Ã–sterreich,Vietnamï¼ˆå¯¹çš„ï¼ï¼‰
```

### 5.4.3. reverse

[arr.reverse](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/reverse) æ–¹æ³•ç”¨äºé¢ å€’ arr ä¸­å…ƒç´ çš„é¡ºåºã€‚

ä¾‹å¦‚ï¼š

```js
let arr = [1, 2, 3, 4, 5];
arr.reverse();

alert(arr); // 5,4,3,2,1
```

å®ƒä¹Ÿä¼šè¿”å›é¢ å€’åçš„æ•°ç»„ `arr`ã€‚

### 5.4.4. split å’Œ join

ä¸¾ä¸€ä¸ªç°å®ç”Ÿæ´»åœºæ™¯çš„ä¾‹å­ã€‚æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªæ¶ˆæ¯åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥äººå‘˜è¾“å…¥ä»¥é€—å·åˆ†éš”çš„æ¥æ”¶è€…åˆ—è¡¨ï¼š`John, Pete, Mary`ã€‚ä½†å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œåå­—æ•°ç»„æ¯”å•ä¸ªå­—ç¬¦ä¸²èˆ’é€‚å¾—å¤šã€‚æ€ä¹ˆåšæ‰èƒ½è·å¾—è¿™æ ·çš„æ•°ç»„å‘¢ï¼Ÿ

[str.split(delim)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/String/split) æ–¹æ³•å¯ä»¥åšåˆ°ã€‚å®ƒé€šè¿‡ç»™å®šçš„åˆ†éš”ç¬¦ `delim` å°†å­—ç¬¦ä¸²åˆ†å‰²æˆä¸€ä¸ªæ•°ç»„ã€‚

```js
let names = "Bilbo, Gandalf, Nazgul";

let arr = names.split(", ");

for (let name of arr) {
  alert(`A message to ${name}.`); // A message to Bilboï¼ˆå’Œå…¶ä»–åå­—ï¼‰
}
```

`split` æ–¹æ³•æœ‰ä¸€ä¸ªå¯é€‰çš„ç¬¬äºŒä¸ªæ•°å­—å‚æ•° â€” å¯¹æ•°ç»„é•¿åº¦çš„é™åˆ¶ã€‚å¦‚æœæä¾›äº†ï¼Œé‚£ä¹ˆé¢å¤–çš„å…ƒç´ ä¼šè¢«å¿½ç•¥ã€‚ä½†å®é™…ä¸Šå®ƒå¾ˆå°‘ä½¿ç”¨ï¼š

```js
let arr = "Bilbo, Gandalf, Nazgul, Saruman".split(", ", 2);

alert(arr); // Bilbo, Gandalf
```

> :information_source:æ‹†åˆ†ä¸ºå­—æ¯

è°ƒç”¨å¸¦æœ‰ç©ºå‚æ•° `s` çš„ `split(s)`ï¼Œä¼šå°†å­—ç¬¦ä¸²æ‹†åˆ†ä¸ºå­—æ¯æ•°ç»„ï¼š

```js
let str = "test";

alert(str.split("")); // t,e,s,t
```

[arr.join(glue)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/join) ä¸ split ç›¸åã€‚å®ƒä¼šåœ¨å®ƒä»¬ä¹‹é—´åˆ›å»ºä¸€ä¸²ç”± `glue` ç²˜åˆçš„ `arr` é¡¹ã€‚

ä¾‹å¦‚ï¼š

```js
let arr = ["Bilbo", "Gandalf", "Nazgul"];

let str = arr.join(";"); // ä½¿ç”¨åˆ†å· ; å°†æ•°ç»„ç²˜åˆæˆå­—ç¬¦ä¸²

alert(str); // Bilbo;Gandalf;Nazgul
```

### 5.4.5. reduce/reduceRight

å½“æˆ‘ä»¬éœ€è¦éå†ä¸€ä¸ªæ•°ç»„æ—¶ â€” æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `forEach`ï¼Œ`for` æˆ– `for..of`ã€‚

å½“æˆ‘ä»¬éœ€è¦éå†å¹¶è¿”å›æ¯ä¸ªå…ƒç´ çš„æ•°æ®æ—¶ â€” æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`map`ã€‚

[arr.reduce](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce) æ–¹æ³•å’Œ [arr.reduceRight](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/reduceRight) æ–¹æ³•å’Œä¸Šé¢çš„ç§ç±»å·®ä¸å¤šï¼Œä½†ç¨å¾®å¤æ‚ä¸€ç‚¹ã€‚å®ƒä»¬ç”¨äºæ ¹æ®æ•°ç»„è®¡ç®—å•ä¸ªå€¼ã€‚

è¯­æ³•æ˜¯ï¼š

```js
let value = arr.reduce(
  function (accumulator, item, index, array) {
    // ...
  },
  [initial]
);
```

è¯¥å‡½æ•°ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°åº”ç”¨äºæ‰€æœ‰æ•°ç»„å…ƒç´ ï¼Œå¹¶å°†å…¶ç»“æœâ€œæ¬è¿ï¼ˆcarry onï¼‰â€åˆ°ä¸‹ä¸€ä¸ªè°ƒç”¨ã€‚
å‚æ•°ï¼š

- `accumulator` â€“ æ˜¯ä¸Šä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„ç»“æœï¼Œç¬¬ä¸€æ¬¡ç­‰äº initialï¼ˆå¦‚æœæä¾›äº† - initial çš„è¯ï¼‰ã€‚
- `item` â€” å½“å‰çš„æ•°ç»„å…ƒç´ ã€‚
- `index` â€” å½“å‰ç´¢å¼•ã€‚
- `arr` â€” æ•°ç»„æœ¬èº«ã€‚

åº”ç”¨å‡½æ•°æ—¶ï¼Œä¸Šä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„ç»“æœå°†ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå‡½æ•°ã€‚

å› æ­¤ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æœ¬è´¨ä¸Šæ˜¯ç´¯åŠ å™¨ï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰å…ˆå‰æ‰§è¡Œçš„ç»„åˆç»“æœã€‚æœ€åï¼Œå®ƒæˆä¸º `reduce` çš„ç»“æœã€‚

å¬èµ·æ¥å¤æ‚å—ï¼Ÿ

æŒæ¡è¿™ä¸ªçŸ¥è¯†ç‚¹çš„æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯é€šè¿‡ç¤ºä¾‹ã€‚

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ä¸€è¡Œä»£ç å¾—åˆ°ä¸€ä¸ªæ•°ç»„çš„æ€»å’Œï¼š

```js
let arr = [1, 2, 3, 4, 5];

let result = arr.reduce((sum, current) => sum + current, 0);

alert(result); // 15
```

ä¼ é€’ç»™ `reduce` çš„å‡½æ•°ä»…ä½¿ç”¨äº† 2 ä¸ªå‚æ•°ï¼Œé€šå¸¸è¿™å°±è¶³å¤Ÿäº†ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ç»†èŠ‚ï¼Œåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚

1. åœ¨ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ï¼Œ`sum` çš„å€¼ä¸ºåˆå§‹å€¼ `initial`ï¼ˆ`reduce` çš„æœ€åä¸€ä¸ªå‚æ•°ï¼‰ï¼Œç­‰äº 0ï¼Œ`current` æ˜¯ç¬¬ä¸€ä¸ªæ•°ç»„å…ƒç´ ï¼Œç­‰äº `1`ã€‚æ‰€ä»¥å‡½æ•°è¿è¡Œçš„ç»“æœæ˜¯ `1`ã€‚
2. åœ¨ç¬¬äºŒæ¬¡è¿è¡Œæ—¶ï¼Œ`sum = 1`ï¼Œæˆ‘ä»¬å°†ç¬¬äºŒä¸ªæ•°ç»„å…ƒç´ ï¼ˆ`2`ï¼‰ä¸å…¶ç›¸åŠ å¹¶è¿”å›ã€‚
3. åœ¨ç¬¬ä¸‰æ¬¡è¿è¡Œä¸­ï¼Œ`sum = 3`ï¼Œæˆ‘ä»¬ç»§ç»­æŠŠä¸‹ä¸€ä¸ªå…ƒç´ ä¸å…¶ç›¸åŠ ï¼Œä»¥æ­¤ç±»æ¨â€¦â€¦

è®¡ç®—æµç¨‹ï¼š

![](https://zh.javascript.info/article/array-methods/reduce.svg)

æˆ–è€…ä»¥è¡¨æ ¼çš„å½¢å¼è¡¨ç¤ºï¼Œæ¯ä¸€è¡Œä»£è¡¨çš„æ˜¯å¯¹ä¸‹ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„å‡½æ•°è°ƒç”¨ï¼š

  <p></p>|sum	|current	|result
--|--|--|--|--
ç¬¬ 1 æ¬¡è°ƒç”¨	|0	|1	|1
ç¬¬ 2 æ¬¡è°ƒç”¨	|1	|2	|3
ç¬¬ 3 æ¬¡è°ƒç”¨	|3	|3	|6
ç¬¬ 4 æ¬¡è°ƒç”¨	|6	|4	|10
ç¬¬ 5 æ¬¡è°ƒç”¨	|10	|5	|15

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ä¸Šä¸€ä¸ªè°ƒç”¨çš„ç»“æœå¦‚ä½•æˆä¸ºä¸‹ä¸€ä¸ªè°ƒç”¨çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚

æˆ‘ä»¬ä¹Ÿå¯ä»¥çœç•¥åˆå§‹å€¼ï¼š

```js
let arr = [1, 2, 3, 4, 5];

// åˆ é™¤ reduce çš„åˆå§‹å€¼ï¼ˆæ²¡æœ‰ 0ï¼‰
let result = arr.reduce((sum, current) => sum + current);

alert(result); // 15
```

ç»“æœæ˜¯ä¸€æ ·çš„ã€‚è¿™æ˜¯å› ä¸ºå¦‚æœæ²¡æœ‰åˆå§‹å€¼ï¼Œé‚£ä¹ˆ `reduce` ä¼šå°†æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä½œä¸ºåˆå§‹å€¼ï¼Œå¹¶ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹è¿­ä»£ã€‚

è®¡ç®—è¡¨ä¸ä¸Šé¢ç›¸åŒï¼Œåªæ˜¯å»æ‰ç¬¬ä¸€è¡Œã€‚

ä½†æ˜¯è¿™ç§ä½¿ç”¨éœ€è¦éå¸¸å°å¿ƒã€‚å¦‚æœæ•°ç»„ä¸ºç©ºï¼Œé‚£ä¹ˆåœ¨æ²¡æœ‰åˆå§‹å€¼çš„æƒ…å†µä¸‹è°ƒç”¨ `reduce` ä¼šå¯¼è‡´é”™è¯¯ã€‚

ä¾‹å¦‚ï¼š

```js
let arr = [];

// Error: Reduce of empty array with no initial value
// å¦‚æœåˆå§‹å€¼å­˜åœ¨ï¼Œåˆ™ reduce å°†ä¸ºç©º arr è¿”å›å®ƒï¼ˆå³è¿™ä¸ªåˆå§‹å€¼ï¼‰ã€‚
arr.reduce((sum, current) => sum + current);
```

æ‰€ä»¥å»ºè®®å§‹ç»ˆæŒ‡å®šåˆå§‹å€¼ã€‚

`arr.reduceRight` å’Œ `arr.reduce` æ–¹æ³•çš„åŠŸèƒ½ä¸€æ ·ï¼Œåªæ˜¯éå†ä¸ºä»å³åˆ°å·¦ã€‚

## 5.5. Array.isArray

æ•°ç»„æ˜¯åŸºäºå¯¹è±¡çš„ï¼Œä¸æ„æˆå•ç‹¬çš„è¯­è¨€ç±»å‹ã€‚

æ‰€ä»¥ `typeof` ä¸èƒ½å¸®åŠ©ä»æ•°ç»„ä¸­åŒºåˆ†å‡ºæ™®é€šå¯¹è±¡ï¼š

```js
alert(typeof {}); // object
alert(typeof []); // same
```

â€¦â€¦ä½†æ˜¯æ•°ç»„ç»å¸¸è¢«ä½¿ç”¨ï¼Œå› æ­¤æœ‰ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ç”¨äºåˆ¤æ–­ï¼š[Array.isArray(value)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray)ã€‚å¦‚æœ value æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ™è¿”å› `true`ï¼›å¦åˆ™è¿”å› `false`ã€‚

```js
alert(Array.isArray({})); // false

alert(Array.isArray([])); // true
```

## 5.6. å¤§å¤šæ•°æ–¹æ³•éƒ½æ”¯æŒ â€œthisArgâ€

å‡ ä¹æ‰€æœ‰è°ƒç”¨å‡½æ•°çš„æ•°ç»„æ–¹æ³• â€“ æ¯”å¦‚ `find`ï¼Œ`filter`ï¼Œ`map`ï¼Œé™¤äº† `sort` æ˜¯ä¸€ä¸ªç‰¹ä¾‹ï¼Œéƒ½æ¥å—ä¸€ä¸ªå¯é€‰çš„é™„åŠ å‚æ•° `thisArg`

ä¸Šé¢çš„éƒ¨åˆ†ä¸­æ²¡æœ‰è§£é‡Šè¯¥å‚æ•°ï¼Œå› ä¸ºè¯¥å‚æ•°å¾ˆå°‘ä½¿ç”¨ã€‚ä½†æ˜¯ä¸ºäº†å®Œæ•´æ€§ï¼Œæˆ‘ä»¬éœ€è¦è®²è®²å®ƒã€‚

ä»¥ä¸‹æ˜¯è¿™äº›æ–¹æ³•çš„å®Œæ•´è¯­æ³•ï¼š

```js
arr.find(func, thisArg);
arr.filter(func, thisArg);
arr.map(func, thisArg);
// ...
// thisArg æ˜¯å¯é€‰çš„æœ€åä¸€ä¸ªå‚æ•°
```

`thisArg` å‚æ•°çš„å€¼åœ¨ `func` ä¸­å˜ä¸º `this`ã€‚

ä¾‹å¦‚ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ `army` å¯¹è±¡æ–¹æ³•ä½œä¸ºè¿‡æ»¤å™¨ï¼Œ`thisArg` ç”¨äºä¼ é€’ä¸Šä¸‹æ–‡ï¼ˆpasses the contextï¼‰ï¼š

```js
let army = {
  minAge: 18,
  maxAge: 27,
  canJoin(user) {
    return user.age >= this.minAge && user.age < this.maxAge;
  },
};

let users = [{ age: 16 }, { age: 20 }, { age: 23 }, { age: 30 }];

// æ‰¾åˆ° army.canJoin è¿”å› true çš„ user
let soldiers = users.filter(army.canJoin, army);

alert(soldiers.length); // 2
alert(soldiers[0].age); // 20
alert(soldiers[1].age); // 23
```

å¦‚æœåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨äº† `users.filter(army.canJoin)`ï¼Œé‚£ä¹ˆ `army.canJoin` å°†è¢«ä½œä¸ºç‹¬ç«‹å‡½æ•°è°ƒç”¨ï¼Œå¹¶ä¸”è¿™æ—¶ `this=undefined`ï¼Œä»è€Œä¼šå¯¼è‡´å³æ—¶é”™è¯¯ã€‚

å¯ä»¥ç”¨ `users.filter(user => army.canJoin(user))` æ›¿æ¢å¯¹ `users.filter(army.canJoin, army)` çš„è°ƒç”¨ã€‚å‰è€…çš„ä½¿ç”¨é¢‘ç‡æ›´é«˜ï¼Œå› ä¸ºå¯¹äºå¤§å¤šæ•°äººæ¥è¯´ï¼Œå®ƒæ›´å®¹æ˜“ç†è§£ã€‚

## 5.7. æ€»ç»“

æ•°ç»„æ–¹æ³•å¤‡å¿˜å•ï¼š

- æ·»åŠ /åˆ é™¤å…ƒç´ ï¼š
  - `push(...items)` â€” å‘å°¾ç«¯æ·»åŠ å…ƒç´ ï¼Œ
  - `pop()` â€” ä»å°¾ç«¯æå–ä¸€ä¸ªå…ƒç´ ï¼Œ
  - `shift(`) â€” ä»é¦–ç«¯æå–ä¸€ä¸ªå…ƒç´ ï¼Œ
  - `unshift(...items)` â€” å‘é¦–ç«¯æ·»åŠ å…ƒç´ ï¼Œ
  - `splice(pos, deleteCount, ...items)` â€” ä» index å¼€å§‹åˆ é™¤ deleteCount ä¸ªå…ƒç´ ï¼Œå¹¶åœ¨å½“å‰ä½ç½®æ’å…¥ itemsã€‚
  - `slice(start, end)` â€” åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå°†ä»ä½ç½® start åˆ°ä½ç½® endï¼ˆä½†ä¸åŒ…æ‹¬ endï¼‰çš„å…ƒç´ å¤åˆ¶è¿›å»ã€‚
  - `concat(...items)` â€” è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼šå¤åˆ¶å½“å‰æ•°ç»„çš„æ‰€æœ‰å…ƒç´ ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ  itemsã€‚å¦‚æœ items ä¸­çš„ä»»æ„ä¸€é¡¹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå°±å–å…¶å…ƒç´ ã€‚
- æœç´¢å…ƒç´ ï¼š
  - `indexOf/lastIndexOf(item, pos)` â€” ä»ä½ç½® pos å¼€å§‹æœç´¢ itemï¼Œæœç´¢åˆ°åˆ™è¿”å›è¯¥é¡¹çš„ç´¢å¼•ï¼Œå¦åˆ™è¿”å› -1ã€‚
  - `includes(value)` â€” å¦‚æœæ•°ç»„æœ‰ valueï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚
  - `find/filter(func)` â€” é€šè¿‡ func è¿‡æ»¤å…ƒç´ ï¼Œè¿”å›ä½¿ func è¿”å› true çš„ç¬¬ä¸€ä¸ªå€¼/æ‰€æœ‰å€¼ã€‚
  - `findIndex` å’Œ find ç±»ä¼¼ï¼Œä½†è¿”å›ç´¢å¼•è€Œä¸æ˜¯å€¼ã€‚
- éå†å…ƒç´ ï¼š
  - `forEach(func)` â€” å¯¹æ¯ä¸ªå…ƒç´ éƒ½è°ƒç”¨ funcï¼Œä¸è¿”å›ä»»ä½•å†…å®¹ã€‚
- è½¬æ¢æ•°ç»„ï¼š
  - `map(func)` â€” æ ¹æ®å¯¹æ¯ä¸ªå…ƒç´ è°ƒç”¨ func çš„ç»“æœåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ã€‚
  - `sort(func)` â€” å¯¹æ•°ç»„è¿›è¡ŒåŸä½ï¼ˆin-placeï¼‰æ’åºï¼Œç„¶åè¿”å›å®ƒã€‚
  - `reverse()` â€” åŸä½ï¼ˆin-placeï¼‰åè½¬æ•°ç»„ï¼Œç„¶åè¿”å›å®ƒã€‚
  - `split/join` â€” å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°ç»„å¹¶è¿”å›ã€‚
  - `reduce(func, initial)` â€” é€šè¿‡å¯¹æ¯ä¸ªå…ƒç´ è°ƒç”¨ func è®¡ç®—æ•°ç»„ä¸Šçš„å•ä¸ªå€¼ï¼Œå¹¶åœ¨è°ƒç”¨ä¹‹é—´ä¼ é€’ä¸­é—´ç»“æœã€‚
- å…¶ä»–ï¼š
  - `Array.isArray(arr)` æ£€æŸ¥ arr æ˜¯å¦æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚

è¯·æ³¨æ„ï¼Œ`sort`ï¼Œ`reverse` å’Œ `splice` æ–¹æ³•ä¿®æ”¹çš„æ˜¯æ•°ç»„æœ¬èº«ã€‚

è¿™äº›æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œå®ƒä»¬è¦†ç›– 99ï¼… çš„ç”¨ä¾‹ã€‚ä½†æ˜¯è¿˜æœ‰å…¶ä»–å‡ ä¸ªï¼š

- [arr.some(fn)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/some)/[arr.every(fn)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/every) æ£€æŸ¥æ•°ç»„ã€‚
  - ä¸ map ç±»ä¼¼ï¼Œå¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨å‡½æ•° fnã€‚å¦‚æœä»»ä½•/æ‰€æœ‰ç»“æœä¸º trueï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚
- [arr.fill(value, start, end)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/fill) â€” ä»ç´¢å¼• start åˆ° endï¼Œç”¨é‡å¤çš„ value å¡«å……æ•°ç»„ã€‚

- [arr.copyWithin(target, start, end)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/copyWithin) â€” å°†ä»ä½ç½® start åˆ° end çš„æ‰€æœ‰å…ƒç´ å¤åˆ¶åˆ° è‡ªèº« çš„ target ä½ç½®ï¼ˆè¦†ç›–ç°æœ‰å…ƒç´ ï¼‰ã€‚

æœ‰å…³å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚é˜… [æ‰‹å†Œ](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array)ã€‚

ä¹çœ‹èµ·æ¥ï¼Œä¼¼ä¹æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œå¾ˆéš¾è®°ä½ã€‚ä½†å®é™…ä¸Šè¿™æ¯”çœ‹èµ·æ¥è¦å®¹æ˜“å¾—å¤šã€‚

æµè§ˆè¿™ä¸ªå¤‡å¿˜å•ï¼Œä»¥äº†è§£è¿™äº›æ–¹æ³•ã€‚ç„¶åè§£å†³æœ¬ç« ä¸­çš„ä¹ é¢˜æ¥è¿›è¡Œç»ƒä¹ ï¼Œä»¥ä¾¿è®©ä½ æœ‰æ•°ç»„æ–¹æ³•çš„ä½¿ç”¨ç»éªŒã€‚

ç„¶åï¼Œæ¯å½“ä½ éœ€è¦å¯¹æ•°ç»„è¿›è¡ŒæŸäº›æ“ä½œï¼Œè€Œåˆä¸çŸ¥é“æ€ä¹ˆåšçš„æ—¶å€™ï¼Œè¯·å›åˆ°è¿™å„¿ï¼ŒæŸ¥çœ‹è¿™ä¸ªå¤‡å¿˜å•ï¼Œç„¶åæ‰¾åˆ°æ­£ç¡®çš„æ–¹æ³•ã€‚ç¤ºä¾‹å°†å¸®åŠ©ä½ æ­£ç¡®ç¼–å†™å®ƒã€‚ç”¨ä¸äº†å¤šä¹…ï¼Œä½ å°±è‡ªç„¶è€Œç„¶åœ°è®°ä½è¿™äº›æ–¹æ³•äº†ï¼Œæ ¹æœ¬ä¸éœ€è¦ä½ æ­»è®°ç¡¬èƒŒã€‚

# 6. Iterable objectï¼ˆå¯è¿­ä»£å¯¹è±¡ï¼‰

**å¯è¿­ä»£ï¼ˆIterableï¼‰** å¯¹è±¡æ˜¯æ•°ç»„çš„æ³›åŒ–ã€‚è¿™ä¸ªæ¦‚å¿µæ˜¯è¯´ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥è¢«å®šåˆ¶ä¸ºå¯åœ¨ for..of å¾ªç¯ä¸­ä½¿ç”¨çš„å¯¹è±¡ã€‚

æ•°ç»„æ˜¯å¯è¿­ä»£çš„ã€‚ä½†ä¸ä»…ä»…æ˜¯æ•°ç»„ã€‚å¾ˆå¤šå…¶ä»–å†…å»ºå¯¹è±¡ä¹Ÿéƒ½æ˜¯å¯è¿­ä»£çš„ã€‚ä¾‹å¦‚å­—ç¬¦ä¸²ä¹Ÿæ˜¯å¯è¿­ä»£çš„ã€‚

å¦‚æœä»æŠ€æœ¯ä¸Šè®²ï¼Œå¯¹è±¡ä¸æ˜¯æ•°ç»„ï¼Œè€Œæ˜¯è¡¨ç¤ºæŸç‰©çš„é›†åˆï¼ˆåˆ—è¡¨ï¼Œé›†åˆï¼‰ï¼Œfor..of æ˜¯ä¸€ä¸ªèƒ½å¤Ÿéå†å®ƒçš„å¾ˆå¥½çš„è¯­æ³•ï¼Œå› æ­¤ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿å…¶å‘æŒ¥ä½œç”¨ã€‚

## 6.1. Symbol.iterator

é€šè¿‡è‡ªå·±åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥è½»æ¾åœ°æŒæ¡å¯è¿­ä»£çš„æ¦‚å¿µã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå¹¶ä¸æ˜¯æ•°ç»„ï¼Œä½†æ˜¯çœ‹ä¸Šå»å¾ˆé€‚åˆä½¿ç”¨ `for..of` å¾ªç¯ã€‚

æ¯”å¦‚ä¸€ä¸ª `range` å¯¹è±¡ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªæ•°å­—åŒºé—´ï¼š

```js
let range = {
  from: 1,
  to: 5,
};

// æˆ‘ä»¬å¸Œæœ› for..of è¿™æ ·è¿è¡Œï¼š
// for(let num of range) ... num=1,2,3,4,5
```

ä¸ºäº†è®© `range` å¯¹è±¡å¯è¿­ä»£ï¼ˆä¹Ÿå°±è®© `for..of` å¯ä»¥è¿è¡Œï¼‰æˆ‘ä»¬éœ€è¦ä¸ºå¯¹è±¡æ·»åŠ ä¸€ä¸ªåä¸º `Symbol.iterator` çš„æ–¹æ³•ï¼ˆä¸€ä¸ªä¸“é—¨ç”¨äºä½¿å¯¹è±¡å¯è¿­ä»£çš„å†…ç½® symbolï¼‰ã€‚

1. å½“ `for..of` å¾ªç¯å¯åŠ¨æ—¶ï¼Œå®ƒä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼ˆå¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°±ä¼šæŠ¥é”™ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ª **è¿­ä»£å™¨ï¼ˆiteratorï¼‰** â€”â€” ä¸€ä¸ªæœ‰ `next` æ–¹æ³•çš„å¯¹è±¡ã€‚
2. ä»æ­¤å¼€å§‹ï¼Œ`for..of` **ä»…é€‚ç”¨äºè¿™ä¸ªè¢«è¿”å›çš„å¯¹è±¡**ã€‚
3. å½“ `for..of` å¾ªç¯å¸Œæœ›å–å¾—ä¸‹ä¸€ä¸ªæ•°å€¼ï¼Œå®ƒå°±è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„ `next()` æ–¹æ³•ã€‚
4. `next()` æ–¹æ³•è¿”å›çš„ç»“æœçš„æ ¼å¼å¿…é¡»æ˜¯ `{done: Boolean, value: any}`ï¼Œå½“ `done=true` æ—¶ï¼Œè¡¨ç¤ºè¿­ä»£ç»“æŸï¼Œå¦åˆ™ `value` æ˜¯ä¸‹ä¸€ä¸ªå€¼ã€‚

è¿™æ˜¯å¸¦æœ‰æ³¨é‡Šçš„ `range` çš„å®Œæ•´å®ç°ï¼š

```js
let range = {
  from: 1,
  to: 5,
};

// 1. for..of è°ƒç”¨é¦–å…ˆä¼šè°ƒç”¨è¿™ä¸ªï¼š
range[Symbol.iterator] = function () {
  // â€¦â€¦å®ƒè¿”å›è¿­ä»£å™¨å¯¹è±¡ï¼ˆiterator objectï¼‰ï¼š
  // 2. æ¥ä¸‹æ¥ï¼Œfor..of ä»…ä¸æ­¤è¿­ä»£å™¨ä¸€èµ·å·¥ä½œï¼Œè¦æ±‚å®ƒæä¾›ä¸‹ä¸€ä¸ªå€¼
  return {
    current: this.from,
    last: this.to,

    // 3. next() åœ¨ for..of çš„æ¯ä¸€è½®å¾ªç¯è¿­ä»£ä¸­è¢«è°ƒç”¨
    next() {
      // 4. å®ƒå°†ä¼šè¿”å› {done:.., value :...} æ ¼å¼çš„å¯¹è±¡
      if (this.current <= this.last) {
        return { done: false, value: this.current++ };
      } else {
        return { done: true };
      }
    },
  };
};

// ç°åœ¨å®ƒå¯ä»¥è¿è¡Œäº†ï¼
for (let num of range) {
  alert(num); // 1, ç„¶åæ˜¯ 2, 3, 4, 5
}
```

è¯·æ³¨æ„å¯è¿­ä»£å¯¹è±¡çš„æ ¸å¿ƒåŠŸèƒ½ï¼šå…³æ³¨ç‚¹åˆ†ç¦»ã€‚

1. `range` è‡ªèº«æ²¡æœ‰ `next()` æ–¹æ³•ã€‚
2. ç›¸åï¼Œæ˜¯é€šè¿‡è°ƒç”¨ `range[Symbol.iterator]()` åˆ›å»ºäº†å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå³æ‰€è°“çš„â€œè¿­ä»£å™¨â€å¯¹è±¡ï¼Œå¹¶ä¸”å®ƒçš„ `next` ä¼šä¸ºè¿­ä»£ç”Ÿæˆå€¼ã€‚

å› æ­¤ï¼Œè¿­ä»£å™¨å¯¹è±¡å’Œä¸å…¶è¿›è¡Œè¿­ä»£çš„å¯¹è±¡æ˜¯åˆ†å¼€çš„ã€‚

ä»æŠ€æœ¯ä¸Šè¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬åˆå¹¶ï¼Œå¹¶ä½¿ç”¨ `range` è‡ªèº«ä½œä¸ºè¿­ä»£å™¨æ¥ç®€åŒ–ä»£ç ã€‚

å°±åƒè¿™æ ·ï¼š

```js
let range = {
  from: 1,
  to: 5,

  [Symbol.iterator]() {
    this.current = this.from;
    return this;
  },

  next() {
    if (this.current <= this.to) {
      return { done: false, value: this.current++ };
    } else {
      return { done: true };
    }
  },
};

for (let num of range) {
  alert(num); // 1, ç„¶åæ˜¯ 2, 3, 4, 5
}
```

ç°åœ¨`range[Symbol.iterator]()` è¿”å›çš„æ˜¯ `range` å¯¹è±¡è‡ªèº«ï¼šå®ƒåŒ…æ‹¬äº†å¿…éœ€çš„ `next()` æ–¹æ³•ï¼Œå¹¶é€šè¿‡ `this.current` è®°å¿†äº†å½“å‰çš„è¿­ä»£è¿›ç¨‹ã€‚è¿™æ ·æ›´çŸ­ï¼Œå¯¹å—ï¼Ÿæ˜¯çš„ã€‚æœ‰æ—¶è¿™æ ·ä¹Ÿå¯ä»¥ã€‚

ä½†ç¼ºç‚¹æ˜¯ï¼Œç°åœ¨ä¸å¯èƒ½åŒæ—¶åœ¨å¯¹è±¡ä¸Šè¿è¡Œä¸¤ä¸ª `for..of` å¾ªç¯äº†ï¼šå®ƒä»¬å°†å…±äº«è¿­ä»£çŠ¶æ€ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå³å¯¹è±¡æœ¬èº«ã€‚ä½†æ˜¯ä¸¤ä¸ªå¹¶è¡Œçš„ for..of æ˜¯å¾ˆç½•è§çš„ï¼Œå³ä½¿åœ¨å¼‚æ­¥æƒ…å†µä¸‹ã€‚

> :information_source:æ— ç©·è¿­ä»£å™¨ï¼ˆiteratorï¼‰

æ— ç©·è¿­ä»£å™¨ä¹Ÿæ˜¯å¯èƒ½çš„ã€‚ä¾‹å¦‚ï¼Œå°† `range` è®¾ç½®ä¸º `range.to = Infinity`ï¼Œè¿™æ—¶ `range` åˆ™æˆä¸ºäº†æ— ç©·è¿­ä»£å™¨ã€‚æˆ–è€…æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œå®ƒç”Ÿæˆä¸€ä¸ªæ— ç©·ä¼ªéšæœºæ•°åºåˆ—ã€‚ä¹Ÿæ˜¯å¯èƒ½çš„ã€‚

`next` æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Œå®ƒå¯ä»¥è¿”å›è¶Šæ¥è¶Šå¤šçš„å€¼ï¼Œè¿™æ˜¯æ­£å¸¸çš„ã€‚

å½“ç„¶ï¼Œè¿­ä»£è¿™ç§å¯¹è±¡çš„ `for..of` å¾ªç¯å°†ä¸ä¼šåœæ­¢ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ `break` æ¥åœæ­¢å®ƒã€‚

## 6.2. å­—ç¬¦ä¸²æ˜¯å¯è¿­ä»£çš„

æ•°ç»„å’Œå­—ç¬¦ä¸²æ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„å†…å»ºå¯è¿­ä»£å¯¹è±¡ã€‚

å¯¹äºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ`for..of` éå†å®ƒçš„æ¯ä¸ªå­—ç¬¦ï¼š

```js
for (let char of "test") {
  // è§¦å‘ 4 æ¬¡ï¼Œæ¯ä¸ªå­—ç¬¦ä¸€æ¬¡
  alert(char); // t, then e, then s, then t
}
```

å¯¹äºä»£ç†å¯¹ï¼ˆsurrogate pairsï¼‰ï¼Œå®ƒä¹Ÿèƒ½æ­£å¸¸å·¥ä½œï¼ï¼ˆè¯‘æ³¨ï¼šè¿™é‡Œçš„ä»£ç†å¯¹ä¹Ÿå°±æŒ‡çš„æ˜¯ UTF-16 çš„æ‰©å±•å­—ç¬¦ï¼‰

```js
let str = "ğ’³ğŸ˜‚";
for (let char of str) {
  alert(char); // ğ’³ï¼Œç„¶åæ˜¯ ğŸ˜‚
}
```

## 6.3. æ˜¾å¼è°ƒç”¨è¿­ä»£å™¨

ä¸ºäº†æ›´æ·±å±‚åœ°äº†è§£åº•å±‚çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•æ˜¾å¼åœ°ä½¿ç”¨è¿­ä»£å™¨ã€‚

æˆ‘ä»¬å°†ä¼šé‡‡ç”¨ä¸ `for..of` å®Œå…¨ç›¸åŒçš„æ–¹å¼éå†å­—ç¬¦ä¸²ï¼Œä½†ä½¿ç”¨çš„æ˜¯ç›´æ¥è°ƒç”¨ã€‚è¿™æ®µä»£ç åˆ›å»ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²è¿­ä»£å™¨ï¼Œå¹¶â€œæ‰‹åŠ¨â€ä»ä¸­è·å–å€¼ã€‚

```js
let str = "Hello";

// å’Œ for..of åšç›¸åŒçš„äº‹
// for (let char of str) alert(char);

let iterator = str[Symbol.iterator]();

while (true) {
  let result = iterator.next();
  if (result.done) break;
  alert(result.value); // ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¾“å‡ºå­—ç¬¦
}
```

å¾ˆå°‘éœ€è¦æˆ‘ä»¬è¿™æ ·åšï¼Œä½†æ˜¯æ¯” `for..of` ç»™äº†æˆ‘ä»¬æ›´å¤šçš„æ§åˆ¶æƒã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ‹†åˆ†è¿­ä»£è¿‡ç¨‹ï¼šè¿­ä»£ä¸€éƒ¨åˆ†ï¼Œç„¶ååœæ­¢ï¼Œåšä¸€äº›å…¶ä»–å¤„ç†ï¼Œç„¶åå†æ¢å¤è¿­ä»£ã€‚

## 6.4. å¯è¿­ä»£ï¼ˆiterableï¼‰å’Œç±»æ•°ç»„ï¼ˆarray-likeï¼‰

æœ‰ä¸¤ä¸ªçœ‹èµ·æ¥å¾ˆç›¸ä¼¼ï¼Œä½†åˆæœ‰å¾ˆå¤§ä¸åŒçš„æ­£å¼æœ¯è¯­ã€‚è¯·ä½ ç¡®ä¿æ­£ç¡®åœ°æŒæ¡å®ƒä»¬ï¼Œä»¥å…é€ æˆæ··æ·†ã€‚

- `Iterable` å¦‚ä¸Šæ‰€è¿°ï¼Œæ˜¯å®ç° `Symbol.iterator` æ–¹æ³•çš„å¯¹è±¡ã€‚
- `Array-like` æ˜¯æœ‰ç´¢å¼•å’Œ length å±æ€§çš„å¯¹è±¡ï¼Œæ‰€ä»¥å®ƒä»¬çœ‹èµ·æ¥å¾ˆåƒæ•°ç»„ã€‚

å½“æˆ‘ä»¬å°† JavaScript ç”¨äºç¼–å†™åœ¨æµè§ˆå™¨æˆ–å…¶ä»–ç¯å¢ƒä¸­çš„å®é™…ä»»åŠ¡æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°å¯è¿­ä»£å¯¹è±¡æˆ–ç±»æ•°ç»„å¯¹è±¡ï¼Œæˆ–ä¸¤è€…å…¼æœ‰ã€‚

ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²å³æ˜¯å¯è¿­ä»£çš„ï¼ˆ`for..of` å¯¹å®ƒä»¬æœ‰æ•ˆï¼‰ï¼Œåˆæ˜¯ç±»æ•°ç»„çš„ï¼ˆå®ƒä»¬æœ‰æ•°å€¼ç´¢å¼•å’Œ length å±æ€§ï¼‰ã€‚

ä½†æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ä¹Ÿè®¸ä¸æ˜¯ç±»æ•°ç»„å¯¹è±¡ã€‚åä¹‹äº¦ç„¶ï¼Œç±»æ•°ç»„å¯¹è±¡å¯èƒ½ä¸å¯è¿­ä»£ã€‚

ä¾‹å¦‚ï¼Œä¸Šé¢ä¾‹å­ä¸­çš„ `range` æ˜¯å¯è¿­ä»£çš„ï¼Œä½†å¹¶éç±»æ•°ç»„å¯¹è±¡ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ç´¢å¼•å±æ€§ï¼Œä¹Ÿæ²¡æœ‰ `length` å±æ€§ã€‚

ä¸‹é¢è¿™ä¸ªå¯¹è±¡åˆ™æ˜¯ç±»æ•°ç»„çš„ï¼Œä½†æ˜¯ä¸å¯è¿­ä»£ï¼š

```js
let arrayLike = {
  // æœ‰ç´¢å¼•å’Œ length å±æ€§ => ç±»æ•°ç»„å¯¹è±¡
  0: "Hello",
  1: "World",
  length: 2,
};

// Error (no Symbol.iterator)
for (let item of arrayLike) {
}
```

å¯è¿­ä»£å¯¹è±¡å’Œç±»æ•°ç»„å¯¹è±¡é€šå¸¸éƒ½ **ä¸æ˜¯æ•°ç»„**ï¼Œå®ƒä»¬æ²¡æœ‰ **push** å’Œ **pop** ç­‰æ–¹æ³•ã€‚å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªè¿™æ ·çš„å¯¹è±¡ï¼Œå¹¶æƒ³åƒæ•°ç»„é‚£æ ·æ“ä½œå®ƒï¼Œé‚£å°±éå¸¸ä¸æ–¹ä¾¿ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³ä½¿ç”¨æ•°ç»„æ–¹æ³•æ“ä½œ `range`ï¼Œåº”è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿ

## 6.5. Array.from

æœ‰ä¸€ä¸ªå…¨å±€æ–¹æ³• [Array.from](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/from) å¯ä»¥æ¥å—ä¸€ä¸ªå¯è¿­ä»£æˆ–ç±»æ•°ç»„çš„å€¼ï¼Œå¹¶ä»ä¸­è·å–ä¸€ä¸ªâ€œçœŸæ­£çš„â€æ•°ç»„ã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥å¯¹å…¶è°ƒç”¨æ•°ç»„æ–¹æ³•äº†ã€‚

ä¾‹å¦‚ï¼š

```js
let arrayLike = {
  0: "Hello",
  1: "World",
  length: 2,
};

let arr = Array.from(arrayLike); // (*)
alert(arr.pop()); // Worldï¼ˆpop æ–¹æ³•æœ‰æ•ˆï¼‰
```

åœ¨ `(*)` è¡Œçš„ Array.from æ–¹æ³•æ¥å—å¯¹è±¡ï¼Œæ£€æŸ¥å®ƒæ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡æˆ–ç±»æ•°ç»„å¯¹è±¡ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå¹¶å°†è¯¥å¯¹è±¡çš„æ‰€æœ‰å…ƒç´ å¤åˆ¶åˆ°è¿™ä¸ªæ–°æ•°ç»„ã€‚

å¦‚æœæ˜¯å¯è¿­ä»£å¯¹è±¡ï¼Œä¹Ÿæ˜¯åŒæ ·ï¼š

```js
// å‡è®¾ range æ¥è‡ªä¸Šæ–‡çš„ä¾‹å­ä¸­
let arr = Array.from(range);
alert(arr); // 1,2,3,4,5 ï¼ˆæ•°ç»„çš„ toString è½¬åŒ–æ–¹æ³•ç”Ÿæ•ˆï¼‰
```

`Array.from` çš„å®Œæ•´è¯­æ³•å…è®¸æˆ‘ä»¬æä¾›ä¸€ä¸ªå¯é€‰çš„â€œæ˜ å°„ï¼ˆmappingï¼‰â€å‡½æ•°ï¼š

```js
Array.from(obj[, mapFn, thisArg])
```

å¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°`mapFn` å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šåœ¨å¯¹è±¡ä¸­çš„å…ƒç´ è¢«æ·»åŠ åˆ°æ•°ç»„å‰ï¼Œè¢«åº”ç”¨äºæ¯ä¸ªå…ƒç´ ï¼Œæ­¤å¤– `thisArg` å…è®¸æˆ‘ä»¬ä¸ºè¯¥å‡½æ•°è®¾ç½® `this`ã€‚

ä¾‹å¦‚ï¼š

```js
// å‡è®¾ range æ¥è‡ªä¸Šæ–‡ä¾‹å­ä¸­

// æ±‚æ¯ä¸ªæ•°çš„å¹³æ–¹
let arr = Array.from(range, (num) => num * num);

alert(arr); // 1,4,9,16,25
```

ç°åœ¨æˆ‘ä»¬ç”¨ `Array.from`å°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºå•ä¸ªå­—ç¬¦çš„æ•°ç»„ï¼š

```js
let str = "ğ’³ğŸ˜‚";

// å°† str æ‹†åˆ†ä¸ºå­—ç¬¦æ•°ç»„
let chars = Array.from(str);

alert(chars[0]); // ğ’³
alert(chars[1]); // ğŸ˜‚
alert(chars.length); // 2
```

ä¸ `str.split` æ–¹æ³•ä¸åŒï¼Œå®ƒä¾èµ–äºå­—ç¬¦ä¸²çš„å¯è¿­ä»£ç‰¹æ€§ã€‚å› æ­¤ï¼Œå°±åƒ `for..of` ä¸€æ ·ï¼Œå¯ä»¥æ­£ç¡®åœ°å¤„ç†ä»£ç†å¯¹ï¼ˆsurrogate pairï¼‰ã€‚ï¼ˆè¯‘æ³¨ï¼šä»£ç†å¯¹ä¹Ÿå°±æ˜¯ UTF-16 æ‰©å±•å­—ç¬¦ã€‚ï¼‰

æŠ€æœ¯ä¸Šæ¥è¯´ï¼Œå®ƒå’Œä¸‹æ–‡åšäº†åŒæ ·çš„äº‹ï¼š

```js
let str = "ğ’³ğŸ˜‚";

let chars = []; // Array.from å†…éƒ¨æ‰§è¡Œç›¸åŒçš„å¾ªç¯
for (let char of str) {
  chars.push(char);
}

alert(chars);
```

â€¦â€¦ä½† `Array.from` ç²¾ç®€å¾ˆå¤šã€‚

æˆ‘ä»¬ç”šè‡³å¯ä»¥åŸºäº `Array.from` åˆ›å»ºä»£ç†æ„ŸçŸ¥ï¼ˆsurrogate-awareï¼‰çš„`slice` æ–¹æ³•ï¼ˆè¯‘æ³¨ï¼šä¹Ÿå°±æ˜¯èƒ½å¤Ÿå¤„ç† UTF-16 æ‰©å±•å­—ç¬¦çš„ slice æ–¹æ³•ï¼‰ï¼š

```js
function slice(str, start, end) {
  return Array.from(str).slice(start, end).join("");
}

let str = "ğ’³ğŸ˜‚ğ©·¶";

alert(slice(str, 1, 3)); // ğŸ˜‚ğ©·¶

// åŸç”Ÿæ–¹æ³•ä¸æ”¯æŒè¯†åˆ«ä»£ç†å¯¹ï¼ˆè¯‘æ³¨ï¼šUTF-16 æ‰©å±•å­—ç¬¦ï¼‰
alert(str.slice(1, 3)); // ä¹±ç ï¼ˆä¸¤ä¸ªä¸åŒ UTF-16 æ‰©å±•å­—ç¬¦ç¢ç‰‡æ‹¼æ¥çš„ç»“æœï¼‰
```

## 6.6. æ€»ç»“

å¯ä»¥åº”ç”¨ `for..of` çš„å¯¹è±¡è¢«ç§°ä¸º **å¯è¿­ä»£çš„**ã€‚

- æŠ€æœ¯ä¸Šæ¥è¯´ï¼Œå¯è¿­ä»£å¯¹è±¡å¿…é¡»å®ç° `Symbol.iterator` æ–¹æ³•ã€‚
  - `obj[Symbol.iterator]` çš„ç»“æœè¢«ç§°ä¸º **è¿­ä»£å™¨ï¼ˆiteratorï¼‰**ã€‚ç”±å®ƒå¤„ç†è¿›ä¸€æ­¥çš„è¿­ä»£è¿‡ç¨‹ã€‚
  - ä¸€ä¸ªè¿­ä»£å™¨å¿…é¡»æœ‰ `next()` æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ª `{done: Boolean, value: any}` å¯¹è±¡ï¼Œè¿™é‡Œ `done:true` è¡¨æ˜è¿­ä»£ç»“æŸï¼Œå¦åˆ™ `value` å°±æ˜¯ä¸‹ä¸€ä¸ªå€¼ã€‚
  - `Symbol.iterator` æ–¹æ³•ä¼šè¢« `for..of` è‡ªåŠ¨è°ƒç”¨ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨å®ƒã€‚
  - å†…ç½®çš„å¯è¿­ä»£å¯¹è±¡ä¾‹å¦‚å­—ç¬¦ä¸²å’Œæ•°ç»„ï¼Œéƒ½å®ç°äº†`Symbol.iterator`ã€‚
  - å­—ç¬¦ä¸²è¿­ä»£å™¨èƒ½å¤Ÿè¯†åˆ«ä»£ç†å¯¹ï¼ˆsurrogate pairï¼‰ã€‚ï¼ˆè¯‘æ³¨ï¼šä»£ç†å¯¹ä¹Ÿå°±æ˜¯ UTF-16 æ‰©å±•å­—ç¬¦ã€‚ï¼‰
- æœ‰ç´¢å¼•å±æ€§å’Œ length å±æ€§çš„å¯¹è±¡è¢«ç§°ä¸º **ç±»æ•°ç»„å¯¹è±¡**ã€‚è¿™ç§å¯¹è±¡å¯èƒ½è¿˜å…·æœ‰å…¶ä»–å±æ€§å’Œæ–¹æ³•ï¼Œä½†æ˜¯æ²¡æœ‰æ•°ç»„çš„å†…å»ºæ–¹æ³•ã€‚

å¦‚æœæˆ‘ä»¬ä»”ç»†ç ”ç©¶ä¸€ä¸‹è§„èŒƒ â€”â€” å°±ä¼šå‘ç°å¤§å¤šæ•°å†…å»ºæ–¹æ³•éƒ½å‡è®¾å®ƒä»¬éœ€è¦å¤„ç†çš„æ˜¯å¯è¿­ä»£å¯¹è±¡æˆ–è€…ç±»æ•°ç»„å¯¹è±¡ï¼Œè€Œä¸æ˜¯â€œçœŸæ­£çš„â€æ•°ç»„ï¼Œå› ä¸ºè¿™æ ·æŠ½è±¡åº¦æ›´é«˜ã€‚

`Array.from(obj[, mapFn, thisArg])` å°†å¯è¿­ä»£å¯¹è±¡æˆ–ç±»æ•°ç»„å¯¹è±¡ `obj` è½¬åŒ–ä¸ºçœŸæ­£çš„æ•°ç»„ `Array`ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥å¯¹å®ƒåº”ç”¨æ•°ç»„çš„æ–¹æ³•ã€‚å¯é€‰å‚æ•° `mapFn` å’Œ `thisArg` å…è®¸æˆ‘ä»¬å°†å‡½æ•°åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ã€‚

# 7. Map and Setï¼ˆæ˜ å°„å’Œé›†åˆï¼‰

æˆ‘ä»¬å·²ç»äº†è§£äº†ä»¥ä¸‹å¤æ‚çš„æ•°æ®ç»“æ„ï¼š

- å­˜å‚¨å¸¦é”®çš„æ•°æ®ï¼ˆkeyedï¼‰é›†åˆçš„å¯¹è±¡ã€‚
- å­˜å‚¨æœ‰åºé›†åˆçš„æ•°ç»„ã€‚

ä½†è¿™è¿˜ä¸è¶³ä»¥åº”å¯¹ç°å®æƒ…å†µã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå­˜åœ¨ Map å’Œ Setã€‚

## 7.1. Map

[Map](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Map) æ˜¯ä¸€ä¸ªå¸¦é”®çš„æ•°æ®é¡¹çš„é›†åˆï¼Œå°±åƒä¸€ä¸ª `Object` ä¸€æ ·ã€‚ ä½†æ˜¯å®ƒä»¬æœ€å¤§çš„å·®åˆ«æ˜¯ `Map` å…è®¸ä»»ä½•ç±»å‹çš„é”®ï¼ˆkeyï¼‰

å®ƒçš„æ–¹æ³•å’Œå±æ€§å¦‚ä¸‹ï¼š

- `new Map()` â€”â€” åˆ›å»º mapã€‚
- `map.set(key, value)` â€”â€” æ ¹æ®é”®å­˜å‚¨å€¼ã€‚
- `map.get(key)` â€”â€” æ ¹æ®é”®æ¥è¿”å›å€¼ï¼Œå¦‚æœ `map` ä¸­ä¸å­˜åœ¨å¯¹åº”çš„ `key`ï¼Œåˆ™è¿”å› `undefined`ã€‚
- `map.has(key)` â€”â€” å¦‚æœ `key` å­˜åœ¨åˆ™è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚
- `map.delete(key)` â€”â€” åˆ é™¤æŒ‡å®šé”®çš„å€¼ã€‚
- `map.clear()` â€”â€” æ¸…ç©º mapã€‚
- `map.size` â€”â€” è¿”å›å½“å‰å…ƒç´ ä¸ªæ•°ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```js
let map = new Map();

map.set("1", "str1"); // å­—ç¬¦ä¸²é”®
map.set(1, "num1"); // æ•°å­—é”®
map.set(true, "bool1"); // å¸ƒå°”å€¼é”®

// è¿˜è®°å¾—æ™®é€šçš„ Object å—? å®ƒä¼šå°†é”®è½¬åŒ–ä¸ºå­—ç¬¦ä¸²
// Map åˆ™ä¼šä¿ç•™é”®çš„ç±»å‹ï¼Œæ‰€ä»¥ä¸‹é¢è¿™ä¸¤ä¸ªç»“æœä¸åŒï¼š
alert(map.get(1)); // 'num1'
alert(map.get("1")); // 'str1'

alert(map.size); // 3
```

å¦‚æˆ‘ä»¬æ‰€è§ï¼Œä¸å¯¹è±¡ä¸åŒï¼Œé”®ä¸ä¼šè¢«è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚é”®å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ã€‚

> :information_source:`map[key]` ä¸æ˜¯ä½¿ç”¨ Map çš„æ­£ç¡®æ–¹å¼

è™½ç„¶ `map[key]` ä¹Ÿæœ‰æ•ˆï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥è®¾ç½® `map[key] = 2`ï¼Œè¿™æ ·ä¼šå°† `map`è§†ä¸º `JavaScript` çš„ `plain object`ï¼Œå› æ­¤å®ƒæš—å«äº†æ‰€æœ‰ç›¸åº”çš„é™åˆ¶ï¼ˆæ²¡æœ‰å¯¹è±¡é”®ç­‰ï¼‰ã€‚

æ‰€ä»¥æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ map æ–¹æ³•ï¼š`set` å’Œ `get` ç­‰ã€‚

**Map è¿˜å¯ä»¥ä½¿ç”¨å¯¹è±¡ä½œä¸ºé”®ã€‚**

ä¾‹å¦‚ï¼š

```js
let john = { name: "John" };

// å­˜å‚¨æ¯ä¸ªç”¨æˆ·çš„æ¥è®¿æ¬¡æ•°
let visitsCountMap = new Map();

// john æ˜¯ Map ä¸­çš„é”®
visitsCountMap.set(john, 123);

alert(visitsCountMap.get(john)); // 123
```

ä½¿ç”¨å¯¹è±¡ä½œä¸ºé”®æ˜¯ **Map** æœ€å€¼å¾—æ³¨æ„å’Œé‡è¦çš„åŠŸèƒ½ä¹‹ä¸€ã€‚å¯¹äºå­—ç¬¦ä¸²é”®ï¼ŒObjectï¼ˆæ™®é€šå¯¹è±¡ï¼‰ä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨ï¼Œä½†å¯¹äºå¯¹è±¡é”®åˆ™ä¸è¡Œã€‚

æˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹ï¼š

```js
let john = { name: "John" };

let visitsCountObj = {}; // å°è¯•ä½¿ç”¨å¯¹è±¡

visitsCountObj[john] = 123; // å°è¯•å°† john å¯¹è±¡ä½œä¸ºé”®

// æ˜¯å†™æˆäº†è¿™æ ·!
alert(visitsCountObj["[object Object]"]); // 123
```

å› ä¸º `visitsCountObj` æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒä¼šå°†æ‰€æœ‰çš„é”®å¦‚ `john` è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—åˆ°å­—ç¬¦ä¸²é”® `"[object Object]"`ã€‚è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚

> :information_source:Map æ˜¯æ€ä¹ˆæ¯”è¾ƒé”®çš„ï¼Ÿ

Map ä½¿ç”¨ [SameValueZero](https://tc39.github.io/ecma262/#sec-samevaluezero) ç®—æ³•æ¥æ¯”è¾ƒé”®æ˜¯å¦ç›¸ç­‰ã€‚å®ƒå’Œä¸¥æ ¼ç­‰äº `===` å·®ä¸å¤šï¼Œä½†åŒºåˆ«æ˜¯ `NaN` è¢«çœ‹æˆæ˜¯ç­‰äº `NaN`ã€‚æ‰€ä»¥ NaN ä¹Ÿå¯ä»¥è¢«ç”¨ä½œé”®ã€‚

> :information_source:é“¾å¼è°ƒç”¨

æ¯ä¸€æ¬¡ map.set è°ƒç”¨éƒ½ä¼šè¿”å› map æœ¬èº«ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œâ€œé“¾å¼â€è°ƒç”¨ï¼š

```js
map.set("1", "str1").set(1, "num1").set(true, "bool1");
```

## 7.2. Map è¿­ä»£

å¦‚æœè¦åœ¨ `map` é‡Œä½¿ç”¨å¾ªç¯ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ï¼š

- `map.keys()` â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„é”®ï¼ˆreturns an iterable for keysï¼‰ï¼Œ
- `map.values()` â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„å€¼ï¼ˆreturns an iterable for valuesï¼‰ï¼Œ
- `map.entries()` â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„å®ä½“ï¼ˆreturns an iterable for entriesï¼‰`[key, value]`ï¼Œ`for..of` åœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„å°±æ˜¯è¿™ä¸ªã€‚

ä¾‹å¦‚ï¼š

```js
let recipeMap = new Map([
  ["cucumber", 500],
  ["tomatoes", 350],
  ["onion", 50],
]);

// éå†æ‰€æœ‰çš„é”®ï¼ˆvegetablesï¼‰
for (let vegetable of recipeMap.keys()) {
  alert(vegetable); // cucumber, tomatoes, onion
}

// éå†æ‰€æœ‰çš„å€¼ï¼ˆamountsï¼‰
for (let amount of recipeMap.values()) {
  alert(amount); // 500, 350, 50
}

// éå†æ‰€æœ‰çš„å®ä½“ [key, value]
for (let entry of recipeMap) {
  // ä¸ recipeMap.entries() ç›¸åŒ
  alert(entry); // cucumber,500 (and so on)
}
```

> :information_source:ä½¿ç”¨æ’å…¥é¡ºåº

è¿­ä»£çš„é¡ºåºä¸æ’å…¥å€¼çš„é¡ºåºç›¸åŒã€‚ä¸æ™®é€šçš„ `Object` ä¸åŒï¼ŒMap ä¿ç•™äº†æ­¤é¡ºåºã€‚

é™¤æ­¤ä¹‹å¤–ï¼ŒMap æœ‰å†…ç½®çš„ `forEach` æ–¹æ³•ï¼Œä¸ `Array` ç±»ä¼¼ï¼š

```js
// å¯¹æ¯ä¸ªé”®å€¼å¯¹ (key, value) è¿è¡Œ forEach å‡½æ•°
recipeMap.forEach((value, key, map) => {
  alert(`${key}: ${value}`); // cucumber: 500 etc
});
```

## 7.3. Object.entriesï¼šä»å¯¹è±¡åˆ›å»º Map

å½“åˆ›å»ºä¸€ä¸ª `Map` åï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªå¸¦æœ‰é”®å€¼å¯¹çš„æ•°ç»„ï¼ˆæˆ–å…¶å®ƒå¯è¿­ä»£å¯¹è±¡ï¼‰æ¥è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```js
// é”®å€¼å¯¹ [key, value] æ•°ç»„
let map = new Map([
  ["1", "str1"],
  [1, "num1"],
  [true, "bool1"],
]);

alert(map.get("1")); // str1
```

å¦‚æœæˆ‘ä»¬æƒ³ä»ä¸€ä¸ªå·²æœ‰çš„æ™®é€šå¯¹è±¡ï¼ˆplain objectï¼‰æ¥åˆ›å»ºä¸€ä¸ª Mapï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†…å»ºæ–¹æ³• [Object.entries(obj)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/entries)ï¼Œè¯¥è¿”å›å¯¹è±¡çš„é”®/å€¼å¯¹æ•°ç»„ï¼Œè¯¥æ•°ç»„æ ¼å¼å®Œå…¨æŒ‰ç…§ Map æ‰€éœ€çš„æ ¼å¼ã€‚

æ‰€ä»¥å¯ä»¥åƒä¸‹é¢è¿™æ ·ä»ä¸€ä¸ªå¯¹è±¡åˆ›å»ºä¸€ä¸ª Mapï¼š

```js
let obj = {
  name: "John",
  age: 30,
};

let map = new Map(Object.entries(obj));

alert(map.get("name")); // John
```

è¿™é‡Œï¼Œ`Object.entries` è¿”å›é”®/å€¼å¯¹æ•°ç»„ï¼š`[ ["name","John"], ["age", 30] ]`ã€‚è¿™å°±æ˜¯ Map æ‰€éœ€è¦çš„æ ¼å¼ã€‚

## 7.4. Object.fromEntriesï¼šä» Map åˆ›å»ºå¯¹è±¡

æˆ‘ä»¬åˆšåˆšå·²ç»å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ `Object.entries(obj)` ä»æ™®é€šå¯¹è±¡ï¼ˆplain objectï¼‰åˆ›å»º Mapã€‚

`Object.fromEntries` æ–¹æ³•çš„ä½œç”¨æ˜¯ç›¸åçš„ï¼šç»™å®šä¸€ä¸ªå…·æœ‰ `[key, value]` é”®å€¼å¯¹çš„æ•°ç»„ï¼Œå®ƒä¼šæ ¹æ®ç»™å®šæ•°ç»„åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼š

```js
let prices = Object.fromEntries([
  ["banana", 1],
  ["orange", 2],
  ["meat", 4],
]);

// ç°åœ¨ prices = { banana: 1, orange: 2, meat: 4 }

alert(prices.orange); // 2
```

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `Object.fromEntries` ä» `Map` å¾—åˆ°ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼ˆplain objectï¼‰ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨ `Map` ä¸­å­˜å‚¨äº†ä¸€äº›æ•°æ®ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æŠŠè¿™äº›æ•°æ®ä¼ ç»™éœ€è¦æ™®é€šå¯¹è±¡ï¼ˆplain objectï¼‰çš„ç¬¬ä¸‰æ–¹ä»£ç ã€‚

æˆ‘ä»¬æ¥å¼€å§‹ï¼š

```js
let map = new Map();
map.set("banana", 1);
map.set("orange", 2);
map.set("meat", 4);

let obj = Object.fromEntries(map.entries()); // åˆ›å»ºä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼ˆplain objectï¼‰(*)

// å®Œæˆäº†ï¼
// obj = { banana: 1, orange: 2, meat: 4 }

alert(obj.orange); // 2
```

è°ƒç”¨ `map.entries()` å°†è¿”å›é”®/å€¼å¯¹æ•°ç»„ï¼Œè¿™åˆšå¥½æ˜¯ `Object.fromEntries` æ‰€éœ€è¦çš„æ ¼å¼ã€‚

æˆ‘ä»¬å¯ä»¥æŠŠå¸¦ `(*)` è¿™ä¸€è¡Œå†™å¾—æ›´çŸ­ï¼š

```js
let obj = Object.fromEntries(map); // çœæ‰ .entries()
```

ä¸Šé¢çš„ä»£ç ä½œç”¨ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸º `Object.fromEntries` æœŸæœ›å¾—åˆ°ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè€Œä¸ä¸€å®šæ˜¯æ•°ç»„ã€‚å¹¶ä¸” `map` çš„æ ‡å‡†è¿­ä»£ä¼šè¿”å›è·Ÿ`map.entries()` ä¸€æ ·çš„é”®/å€¼å¯¹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼ˆplain objectï¼‰ï¼Œå…¶é”®/å€¼å¯¹ä¸ map ç›¸åŒã€‚

## 7.5. Set

`Set` æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹é›†åˆ ï¼ â€œå€¼çš„é›†åˆâ€ï¼ˆæ²¡æœ‰é”®ï¼‰ï¼Œå®ƒçš„æ¯ä¸€ä¸ªå€¼åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚

å®ƒçš„ä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š

- `new Set(iterable)` â€”â€” åˆ›å»ºä¸€ä¸ª setï¼Œå¦‚æœæä¾›äº†ä¸€ä¸ª iterable å¯¹è±¡ï¼ˆé€šå¸¸æ˜¯æ•°ç»„ï¼‰ï¼Œå°†ä¼šä»æ•°ç»„é‡Œé¢å¤åˆ¶å€¼åˆ° set ä¸­ã€‚
- `set.add(value)` â€”â€” æ·»åŠ ä¸€ä¸ªå€¼ï¼Œè¿”å› set æœ¬èº«
- `set.delete(value)` â€”â€” åˆ é™¤å€¼ï¼Œå¦‚æœ value åœ¨è¿™ä¸ªæ–¹æ³•è°ƒç”¨çš„æ—¶å€™å­˜åœ¨åˆ™è¿”å› true ï¼Œå¦åˆ™è¿”å› falseã€‚
- `set.has(value)` â€”â€” å¦‚æœ value åœ¨ set ä¸­ï¼Œè¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚
- `set.clear()` â€”â€” æ¸…ç©º setã€‚
- `set.size` â€”â€” è¿”å›å…ƒç´ ä¸ªæ•°ã€‚

å®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼Œé‡å¤ä½¿ç”¨åŒä¸€ä¸ªå€¼è°ƒç”¨ `set.add(value)`å¹¶ä¸ä¼šå‘ç”Ÿä»€ä¹ˆæ”¹å˜ã€‚è¿™å°±æ˜¯ `Set` é‡Œé¢çš„æ¯ä¸€ä¸ªå€¼åªå‡ºç°ä¸€æ¬¡çš„åŸå› ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰å®¢äººæ¥è®¿ï¼Œæˆ‘ä»¬æƒ³è®°ä½ä»–ä»¬æ¯ä¸€ä¸ªäººã€‚ä½†æ˜¯å·²ç»æ¥è®¿è¿‡çš„å®¢äººå†æ¬¡æ¥è®¿ï¼Œä¸åº”é€ æˆé‡å¤è®°å½•ã€‚æ¯ä¸ªè®¿å®¢å¿…é¡»åªè¢«â€œè®¡æ•°â€ä¸€æ¬¡ã€‚

`Set` å¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ï¼š

```js
let set = new Set();

let john = { name: "John" };
let pete = { name: "Pete" };
let mary = { name: "Mary" };

// visitsï¼Œä¸€äº›è®¿å®¢æ¥è®¿å¥½å‡ æ¬¡
set.add(john);
set.add(pete);
set.add(mary);
set.add(john);
set.add(mary);

// set åªä¿ç•™ä¸é‡å¤çš„å€¼
alert(set.size); // 3

for (let user of set) {
  alert(user.name); // Johnï¼ˆç„¶å Pete å’Œ Maryï¼‰
}
```

Set çš„æ›¿ä»£æ–¹æ³•å¯ä»¥æ˜¯ä¸€ä¸ªç”¨æˆ·æ•°ç»„ï¼Œç”¨ [arr.find](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Array/find) åœ¨æ¯æ¬¡æ’å…¥å€¼æ—¶æ£€æŸ¥æ˜¯å¦é‡å¤ã€‚ä½†æ˜¯è¿™æ ·æ€§èƒ½ä¼šå¾ˆå·®ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•ä¼šéå†æ•´ä¸ªæ•°ç»„æ¥æ£€æŸ¥æ¯ä¸ªå…ƒç´ ã€‚Set å†…éƒ¨å¯¹å”¯ä¸€æ€§æ£€æŸ¥è¿›è¡Œäº†æ›´å¥½çš„ä¼˜åŒ–ã€‚

## 7.6. Set è¿­ä»£ï¼ˆiterationï¼‰

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `for..of` æˆ– `forEach` æ¥éå† Setï¼š

```js
let set = new Set(["oranges", "apples", "bananas"]);

for (let value of set) alert(value);

// ä¸ forEach ç›¸åŒï¼š
set.forEach((value, valueAgain, set) => {
  alert(value);
});
```

æ³¨æ„ä¸€ä»¶æœ‰è¶£çš„äº‹å„¿ã€‚forEach çš„å›è°ƒå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼šä¸€ä¸ª `value`ï¼Œç„¶åæ˜¯ **åŒä¸€ä¸ªå€¼** `valueAgain`ï¼Œæœ€åæ˜¯ç›®æ ‡å¯¹è±¡ã€‚æ²¡é”™ï¼ŒåŒä¸€ä¸ªå€¼åœ¨å‚æ•°é‡Œå‡ºç°äº†ä¸¤æ¬¡ã€‚

forEach çš„å›è°ƒå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œæ˜¯ä¸ºäº†ä¸ `Map` å…¼å®¹ã€‚å½“ç„¶ï¼Œè¿™çœ‹èµ·æ¥ç¡®å®æœ‰äº›å¥‡æ€ªã€‚ä½†æ˜¯è¿™å¯¹åœ¨ç‰¹å®šæƒ…å†µä¸‹è½»æ¾åœ°ç”¨ Set ä»£æ›¿ Map å¾ˆæœ‰å¸®åŠ©ï¼Œåä¹‹äº¦ç„¶ã€‚

`Map` ä¸­ç”¨äºè¿­ä»£çš„æ–¹æ³•åœ¨ `Set` ä¸­ä¹ŸåŒæ ·æ”¯æŒï¼š

- `set.keys()` â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„å€¼ï¼ˆreturns an iterable object for valuesï¼‰ï¼Œ
- `set.values()` â€”â€” ä¸ set.keys() ä½œç”¨ç›¸åŒï¼Œè¿™æ˜¯ä¸ºäº†å…¼å®¹ Mapï¼Œ
- `set.entries()` â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„å®ä½“ï¼ˆreturns an iterable object for entriesï¼‰`[value, value]`ï¼Œå®ƒçš„å­˜åœ¨ä¹Ÿæ˜¯ä¸ºäº†å…¼å®¹ Mapã€‚

## 7.7. æ€»ç»“

`Map` ï¼ æ˜¯ä¸€ä¸ªå¸¦é”®çš„æ•°æ®é¡¹çš„é›†åˆã€‚

æ–¹æ³•å’Œå±æ€§å¦‚ä¸‹ï¼š

- `new Map([iterable])` â€”â€” åˆ›å»º mapï¼Œå¯é€‰æ‹©å¸¦æœ‰ `[key,value]` å¯¹çš„ iterableï¼ˆä¾‹å¦‚æ•°ç»„ï¼‰æ¥è¿›è¡Œåˆå§‹åŒ–ã€‚
- `map.set(key, value)` â€”â€” æ ¹æ®é”®å­˜å‚¨å€¼ã€‚
- `map.get(key)` â€”â€” æ ¹æ®é”®æ¥è¿”å›å€¼ï¼Œå¦‚æœ map ä¸­ä¸å­˜åœ¨å¯¹åº”çš„ keyï¼Œåˆ™è¿”å› undefinedã€‚
- `map.has(key)` â€”â€” å¦‚æœ key å­˜åœ¨åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚
- `map.delete(key)` â€”â€” åˆ é™¤æŒ‡å®šé”®çš„å€¼ã€‚
- `map.clear()` â€”â€” æ¸…ç©º map ã€‚
- `map.size` â€”â€” è¿”å›å½“å‰å…ƒç´ ä¸ªæ•°ã€‚

ä¸æ™®é€šå¯¹è±¡ `Object` çš„ä¸åŒç‚¹ï¼š

- ä»»ä½•é”®ã€å¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºé”®ã€‚
- æœ‰å…¶ä»–çš„ä¾¿æ·æ–¹æ³•ï¼Œå¦‚ `size` å±æ€§ã€‚

`Set` â€”â€” æ˜¯ä¸€ç»„å”¯ä¸€å€¼çš„é›†åˆã€‚

æ–¹æ³•å’Œå±æ€§ï¼š

- `new Set([iterable])` â€”â€” åˆ›å»º setï¼Œå¯é€‰æ‹©å¸¦æœ‰ `iterable`ï¼ˆä¾‹å¦‚æ•°ç»„ï¼‰æ¥è¿›è¡Œåˆå§‹åŒ–ã€‚
- `set.add(value)` â€”â€” æ·»åŠ ä¸€ä¸ªå€¼ï¼ˆå¦‚æœ value å­˜åœ¨åˆ™ä¸åšä»»ä½•ä¿®æ”¹ï¼‰ï¼Œè¿”å› set æœ¬èº«ã€‚
- `set.delete(value)` â€”â€” åˆ é™¤å€¼ï¼Œå¦‚æœ value åœ¨è¿™ä¸ªæ–¹æ³•è°ƒç”¨çš„æ—¶å€™å­˜åœ¨åˆ™è¿”å› true ï¼Œå¦åˆ™è¿”å› falseã€‚
- `set.has(value)` â€”â€” å¦‚æœ value åœ¨ set ä¸­ï¼Œè¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚
- `set.clear()` â€”â€” æ¸…ç©º setã€‚
- `set.size` â€”â€” å…ƒç´ çš„ä¸ªæ•°ã€‚

åœ¨ `Map` å’Œ `Set` ä¸­è¿­ä»£æ€»æ˜¯æŒ‰ç…§å€¼æ’å…¥çš„é¡ºåºè¿›è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½è¯´è¿™äº›é›†åˆæ˜¯æ— åºçš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½å¯¹å…ƒç´ è¿›è¡Œé‡æ–°æ’åºï¼Œä¹Ÿä¸èƒ½ç›´æ¥æŒ‰å…¶ç¼–å·æ¥è·å–å…ƒç´ ã€‚

# 8. WeakMap and WeakSetï¼ˆå¼±æ˜ å°„å’Œå¼±é›†åˆï¼‰

æˆ‘ä»¬ä»å‰é¢çš„ åƒåœ¾å›æ”¶ ç« èŠ‚ä¸­çŸ¥é“ï¼ŒJavaScript å¼•æ“åœ¨å€¼å¯è®¿é—®ï¼ˆå¹¶å¯èƒ½è¢«ä½¿ç”¨ï¼‰æ—¶å°†å…¶å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚

ä¾‹å¦‚:

```js
let john = { name: "John" };

// è¯¥å¯¹è±¡èƒ½è¢«è®¿é—®ï¼Œjohn æ˜¯å®ƒçš„å¼•ç”¨

// è¦†ç›–å¼•ç”¨
john = null;

// è¯¥å¯¹è±¡å°†ä¼šè¢«ä»å†…å­˜ä¸­æ¸…é™¤
```

é€šå¸¸ï¼Œå½“å¯¹è±¡ã€æ•°ç»„è¿™ç±»æ•°æ®ç»“æ„åœ¨å†…å­˜ä¸­æ—¶ï¼Œå®ƒä»¬çš„å­å…ƒç´ ï¼Œå¦‚å¯¹è±¡çš„å±æ€§ã€æ•°ç»„çš„å…ƒç´ éƒ½æ˜¯å¯ä»¥è®¿é—®çš„ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæŠŠä¸€ä¸ªå¯¹è±¡æ”¾å…¥åˆ°æ•°ç»„ä¸­ï¼Œé‚£ä¹ˆåªè¦è¿™ä¸ªæ•°ç»„å­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ä¹Ÿå°±å­˜åœ¨ï¼Œå³ä½¿æ²¡æœ‰å…¶ä»–å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ã€‚

å°±åƒè¿™æ ·:

```js
let john = { name: "John" };

let array = [john];

john = null; // è¦†ç›–å¼•ç”¨

// john è¢«å­˜å‚¨åœ¨æ•°ç»„é‡Œ, æ‰€ä»¥å®ƒä¸ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶
// æˆ‘ä»¬å¯ä»¥é€šè¿‡ array[0] æ¥è·å–å®ƒ
```

ç±»ä¼¼çš„ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å¯¹è±¡ä½œä¸ºå¸¸è§„ Map çš„é”®ï¼Œé‚£ä¹ˆå½“ Map å­˜åœ¨æ—¶ï¼Œè¯¥å¯¹è±¡ä¹Ÿå°†å­˜åœ¨ã€‚å®ƒä¼šå ç”¨å†…å­˜ï¼Œå¹¶ä¸”åº”è¯¥ä¸ä¼šè¢«ï¼ˆåƒåœ¾å›æ”¶æœºåˆ¶ï¼‰å›æ”¶ã€‚

ä¾‹å¦‚ï¼š

```js
let john = { name: "John" };

let map = new Map();
map.set(john, "...");

john = null; // è¦†ç›–å¼•ç”¨

// john è¢«å­˜å‚¨åœ¨ map ä¸­ï¼Œ
// æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ map.keys() æ¥è·å–å®ƒ
```

`WeakMap` åœ¨è¿™æ–¹é¢æœ‰ç€æ ¹æœ¬ä¸Šçš„ä¸åŒã€‚å®ƒä¸ä¼šé˜»æ­¢åƒåœ¾å›æ”¶æœºåˆ¶å¯¹ä½œä¸ºé”®çš„å¯¹è±¡ï¼ˆkey objectï¼‰çš„å›æ”¶ã€‚

è®©æˆ‘ä»¬é€šè¿‡ä¾‹å­æ¥çœ‹çœ‹è¿™æŒ‡çš„åˆ°åº•æ˜¯ä»€ä¹ˆã€‚

## 8.1. WeakMap

`WeakMap` å’Œ `Map` çš„ç¬¬ä¸€ä¸ªä¸åŒç‚¹å°±æ˜¯ï¼Œ`WeakMap` çš„é”®å¿…é¡»æ˜¯å¯¹è±¡ï¼Œä¸èƒ½æ˜¯åŸå§‹å€¼ï¼š

```js
let weakMap = new WeakMap();

let obj = {};

weakMap.set(obj, "ok"); // æ­£å¸¸å·¥ä½œï¼ˆä»¥å¯¹è±¡ä½œä¸ºé”®ï¼‰

// ä¸èƒ½ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºé”®
weakMap.set("test", "Whoops"); // Errorï¼Œå› ä¸º "test" ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡
```

ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ weakMap ä¸­ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡ä½œä¸ºé”®ï¼Œå¹¶ä¸”æ²¡æœ‰å…¶ä»–å¯¹è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ â€” è¯¥å¯¹è±¡å°†ä¼šè¢«ä»å†…å­˜ï¼ˆå’Œ mapï¼‰ä¸­è‡ªåŠ¨æ¸…é™¤ã€‚

```js
let john = { name: "John" };

let weakMap = new WeakMap();
weakMap.set(john, "...");

john = null; // è¦†ç›–å¼•ç”¨

// john è¢«ä»å†…å­˜ä¸­åˆ é™¤äº†ï¼
```

ä¸ä¸Šé¢å¸¸è§„çš„ `Map` çš„ä¾‹å­ç›¸æ¯”ï¼Œç°åœ¨å¦‚æœ `john` ä»…ä»…æ˜¯ä½œä¸º WeakMap çš„é”®è€Œå­˜åœ¨ â€” å®ƒå°†ä¼šè¢«ä» mapï¼ˆå’Œå†…å­˜ï¼‰ä¸­è‡ªåŠ¨åˆ é™¤ã€‚

`WeakMap`ä¸æ”¯æŒè¿­ä»£ä»¥åŠ keys()ï¼Œvalues() å’Œ entries() æ–¹æ³•ã€‚æ‰€ä»¥æ²¡æœ‰åŠæ³•è·å– WeakMap çš„æ‰€æœ‰é”®æˆ–å€¼ã€‚

`WeakMap` åªæœ‰ä»¥ä¸‹çš„æ–¹æ³•ï¼š

- `weakMap.get(key)`
- `weakMap.set(key, value)`
- `weakMap.delete(key)`
- `weakMap.has(key)`

ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§é™åˆ¶å‘¢ï¼Ÿè¿™æ˜¯æŠ€æœ¯çš„åŸå› ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸¢å¤±äº†å…¶å®ƒæ‰€æœ‰å¼•ç”¨ï¼ˆå°±åƒä¸Šé¢ç¤ºä¾‹ä¸­çš„ johnï¼‰ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶è‡ªåŠ¨å›æ”¶ã€‚ä½†æ˜¯åœ¨ä»æŠ€æœ¯çš„è§’åº¦å¹¶ä¸èƒ½å‡†ç¡®çŸ¥é“ **ä½•æ—¶ä¼šè¢«å›æ”¶**ã€‚

è¿™äº›éƒ½æ˜¯ç”± JavaScript å¼•æ“å†³å®šçš„ã€‚JavaScript å¼•æ“å¯èƒ½ä¼šé€‰æ‹©ç«‹å³æ‰§è¡Œå†…å­˜æ¸…ç†ï¼Œå¦‚æœç°åœ¨æ­£åœ¨å‘ç”Ÿå¾ˆå¤šåˆ é™¤æ“ä½œï¼Œé‚£ä¹ˆ JavaScript å¼•æ“å¯èƒ½å°±ä¼šé€‰æ‹©ç­‰ä¸€ç­‰ï¼Œç¨åå†è¿›è¡Œå†…å­˜æ¸…ç†ã€‚å› æ­¤ï¼Œä»æŠ€æœ¯ä¸Šè®²ï¼ŒWeakMap çš„å½“å‰å…ƒç´ çš„æ•°é‡æ˜¯æœªçŸ¥çš„ã€‚JavaScript å¼•æ“å¯èƒ½æ¸…ç†äº†å…¶ä¸­çš„åƒåœ¾ï¼Œå¯èƒ½æ²¡æ¸…ç†ï¼Œä¹Ÿå¯èƒ½æ¸…ç†äº†ä¸€éƒ¨åˆ†ã€‚å› æ­¤ï¼Œæš‚ä¸æ”¯æŒè®¿é—® WeakMap çš„æ‰€æœ‰é”®/å€¼çš„æ–¹æ³•ã€‚

é‚£ä¹ˆï¼Œåœ¨å“ªé‡Œæˆ‘ä»¬ä¼šéœ€è¦è¿™æ ·çš„æ•°æ®ç»“æ„å‘¢ï¼Ÿ

## 8.2. ä½¿ç”¨æ¡ˆä¾‹ï¼šé¢å¤–çš„æ•°æ®

`WeakMap` çš„ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯ **é¢å¤–æ•°æ®çš„å­˜å‚¨**ã€‚

å‡å¦‚æˆ‘ä»¬æ­£åœ¨å¤„ç†ä¸€ä¸ªâ€œå±äºâ€å¦ä¸€ä¸ªä»£ç çš„ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿå¯èƒ½æ˜¯ç¬¬ä¸‰æ–¹åº“ï¼Œå¹¶æƒ³å­˜å‚¨ä¸€äº›ä¸ä¹‹ç›¸å…³çš„æ•°æ®ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®å°±åº”è¯¥ä¸è¿™ä¸ªå¯¹è±¡å…±å­˜äº¡ â€” è¿™æ—¶å€™ WeakMap æ­£æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„åˆ©å™¨ã€‚

æˆ‘ä»¬å°†è¿™äº›æ•°æ®æ”¾åˆ° `WeakMap` ä¸­ï¼Œå¹¶ä½¿ç”¨è¯¥å¯¹è±¡ä½œä¸ºè¿™äº›æ•°æ®çš„é”®ï¼Œé‚£ä¹ˆå½“è¯¥å¯¹è±¡è¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶åï¼Œè¿™äº›æ•°æ®ä¹Ÿä¼šè¢«è‡ªåŠ¨æ¸…é™¤ã€‚

```js
weakMap.set(john, "secret documents");
// å¦‚æœ john æ¶ˆå¤±ï¼Œsecret documents å°†ä¼šè¢«è‡ªåŠ¨æ¸…é™¤
```

è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ç”¨äºå¤„ç†ç”¨æˆ·è®¿é—®è®¡æ•°çš„ä»£ç ã€‚æ”¶é›†åˆ°çš„ä¿¡æ¯è¢«å­˜å‚¨åœ¨ map ä¸­ï¼šä¸€ä¸ªç”¨æˆ·å¯¹è±¡ä½œä¸ºé”®ï¼Œå…¶è®¿é—®æ¬¡æ•°ä¸ºå€¼ã€‚å½“ä¸€ä¸ªç”¨æˆ·ç¦»å¼€æ—¶ï¼ˆè¯¥ç”¨æˆ·å¯¹è±¡å°†è¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ï¼‰ï¼Œè¿™æ—¶æˆ‘ä»¬å°±ä¸å†éœ€è¦ä»–çš„è®¿é—®æ¬¡æ•°äº†ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ Map çš„è®¡æ•°å‡½æ•°çš„ä¾‹å­ï¼š

```js
// ğŸ“ visitsCount.js
let visitsCountMap = new Map(); // map: user => visits count

// é€’å¢ç”¨æˆ·æ¥è®¿æ¬¡æ•°
function countUser(user) {
  let count = visitsCountMap.get(user) || 0;
  visitsCountMap.set(user, count + 1);
}
```

ä¸‹é¢æ˜¯å…¶ä»–éƒ¨åˆ†çš„ä»£ç ï¼Œå¯èƒ½æ˜¯ä½¿ç”¨å®ƒçš„å…¶å®ƒä»£ç ï¼š

```js
// ğŸ“ main.js
let john = { name: "John" };

countUser(john); // count his visits

// ä¸ä¹…ä¹‹åï¼Œjohn ç¦»å¼€äº†
john = null;
```

ç°åœ¨ john è¿™ä¸ªå¯¹è±¡åº”è¯¥è¢«åƒåœ¾å›æ”¶ï¼Œä½†ä»–ä»åœ¨å†…å­˜ä¸­ï¼Œå› ä¸ºå®ƒæ˜¯ visitsCountMap ä¸­çš„ä¸€ä¸ªé”®ã€‚

å½“æˆ‘ä»¬ç§»é™¤ç”¨æˆ·æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ¸…ç† `visitsCountMap`ï¼Œå¦åˆ™å®ƒå°†åœ¨å†…å­˜ä¸­æ— é™å¢å¤§ã€‚åœ¨å¤æ‚çš„æ¶æ„ä¸­ï¼Œè¿™ç§æ¸…ç†ä¼šæˆä¸ºä¸€é¡¹ç¹é‡çš„ä»»åŠ¡ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ `WeakMap` æ¥é¿å…è¿™æ ·çš„é—®é¢˜ï¼š

```js
// ğŸ“ visitsCount.js
let visitsCountMap = new WeakMap(); // weakmap: user => visits count

// é€’å¢ç”¨æˆ·æ¥è®¿æ¬¡æ•°
function countUser(user) {
  let count = visitsCountMap.get(user) || 0;
  visitsCountMap.set(user, count + 1);
}
```

ç°åœ¨æˆ‘ä»¬ä¸éœ€è¦å»æ¸…ç† `visitsCountMap` äº†ã€‚å½“ john å¯¹è±¡å˜æˆä¸å¯è®¿é—®æ—¶ï¼Œå³ä¾¿å®ƒæ˜¯ WeakMap é‡Œçš„ä¸€ä¸ªé”®ï¼Œå®ƒä¹Ÿä¼šè¿åŒå®ƒä½œä¸º WeakMap é‡Œçš„é”®æ‰€å¯¹åº”çš„ä¿¡æ¯ä¸€åŒè¢«ä»å†…å­˜ä¸­åˆ é™¤ã€‚

## 8.3. ä½¿ç”¨æ¡ˆä¾‹ï¼šç¼“å­˜

å¦å¤–ä¸€ä¸ªæ™®éçš„ä¾‹å­æ˜¯ç¼“å­˜ï¼šå½“ä¸€ä¸ªå‡½æ•°çš„ç»“æœéœ€è¦è¢«è®°ä½ï¼ˆâ€œç¼“å­˜â€ï¼‰ï¼Œè¿™æ ·åœ¨åç»­çš„å¯¹åŒä¸€ä¸ªå¯¹è±¡çš„è°ƒç”¨æ—¶ï¼Œå°±å¯ä»¥é‡ç”¨è¿™ä¸ªè¢«ç¼“å­˜çš„ç»“æœã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `Map` æ¥å­˜å‚¨ç»“æœï¼Œå°±åƒè¿™æ ·ï¼š

```js
// ğŸ“ cache.js
let cache = new Map();

// è®¡ç®—å¹¶è®°ä½ç»“æœ
function process(obj) {
  if (!cache.has(obj)) {
    let result = /* calculations of the result for */ obj;

    cache.set(obj, result);
  }

  return cache.get(obj);
}

// ç°åœ¨æˆ‘ä»¬åœ¨å…¶å®ƒæ–‡ä»¶ä¸­ä½¿ç”¨ process()

// ğŸ“ main.js
let obj = {
  /* å‡è®¾æˆ‘ä»¬æœ‰ä¸ªå¯¹è±¡ */
};

let result1 = process(obj); // è®¡ç®—å®Œæˆ

// â€¦â€¦ç¨åï¼Œæ¥è‡ªä»£ç çš„å¦å¤–ä¸€ä¸ªåœ°æ–¹â€¦â€¦
let result2 = process(obj); // å–è‡ªç¼“å­˜çš„è¢«è®°å¿†çš„ç»“æœ

// â€¦â€¦ç¨åï¼Œæˆ‘ä»¬ä¸å†éœ€è¦è¿™ä¸ªå¯¹è±¡æ—¶ï¼š
obj = null;

alert(cache.size); // 1ï¼ˆå•Šï¼è¯¥å¯¹è±¡ä¾ç„¶åœ¨ cache ä¸­ï¼Œå¹¶å æ®ç€å†…å­˜ï¼ï¼‰
```

å¯¹äºå¤šæ¬¡è°ƒç”¨åŒä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåªéœ€åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶è®¡ç®—å‡ºç»“æœï¼Œä¹‹åçš„è°ƒç”¨å¯ä»¥ç›´æ¥ä» `cache` ä¸­è·å–ã€‚è¿™æ ·åšçš„ç¼ºç‚¹æ˜¯ï¼Œå½“æˆ‘ä»¬ä¸å†éœ€è¦è¿™ä¸ªå¯¹è±¡çš„æ—¶å€™éœ€è¦æ¸…ç† `cache`ã€‚

å¦‚æœæˆ‘ä»¬ç”¨ `WeakMap` æ›¿ä»£`Map`ï¼Œè¿™ä¸ªé—®é¢˜ä¾¿ä¼šæ¶ˆå¤±ï¼šå½“å¯¹è±¡è¢«åƒåœ¾å›æ”¶æ—¶ï¼Œå¯¹åº”çš„ç¼“å­˜çš„ç»“æœä¹Ÿä¼šè¢«è‡ªåŠ¨åœ°ä»å†…å­˜ä¸­æ¸…é™¤ã€‚

```js
// ğŸ“ cache.js
let cache = new WeakMap();

// è®¡ç®—å¹¶è®°ç»“æœ
function process(obj) {
  if (!cache.has(obj)) {
    let result = /* calculate the result for */ obj;

    cache.set(obj, result);
  }

  return cache.get(obj);
}

// ğŸ“ main.js
let obj = {
  /* some object */
};

let result1 = process(obj);
let result2 = process(obj);

// â€¦â€¦ç¨åï¼Œæˆ‘ä»¬ä¸å†éœ€è¦è¿™ä¸ªå¯¹è±¡æ—¶ï¼š
obj = null;

// æ— æ³•è·å– cache.sizeï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ª WeakMapï¼Œ
// è¦ä¹ˆæ˜¯ 0ï¼Œæˆ–å³å°†å˜ä¸º 0
// å½“ obj è¢«åƒåœ¾å›æ”¶ï¼Œç¼“å­˜çš„æ•°æ®ä¹Ÿä¼šè¢«æ¸…é™¤
```

## 8.4. WeakSet

`WeakSet` çš„è¡¨ç°ç±»ä¼¼ï¼š

- ä¸ `Set` ç±»ä¼¼ï¼Œä½†æ˜¯æˆ‘ä»¬åªèƒ½å‘ `WeakSet` æ·»åŠ å¯¹è±¡ï¼ˆè€Œä¸èƒ½æ˜¯åŸå§‹å€¼ï¼‰ã€‚
- å¯¹è±¡åªæœ‰åœ¨å…¶å®ƒæŸä¸ªï¼ˆäº›ï¼‰åœ°æ–¹èƒ½è¢«è®¿é—®çš„æ—¶å€™ï¼Œæ‰èƒ½ç•™åœ¨ set ä¸­ã€‚
- è·Ÿ `Set` ä¸€æ ·ï¼ŒWeakSet æ”¯æŒ addï¼Œhas å’Œ delete æ–¹æ³•ï¼Œä½†ä¸æ”¯æŒ size å’Œ keys()ï¼Œå¹¶ä¸”ä¸å¯è¿­ä»£ã€‚

å˜â€œå¼±ï¼ˆweakï¼‰â€çš„åŒæ—¶ï¼Œå®ƒä¹Ÿå¯ä»¥ä½œä¸ºé¢å¤–çš„å­˜å‚¨ç©ºé—´ã€‚ä½†å¹¶éé’ˆå¯¹ä»»æ„æ•°æ®ï¼Œè€Œæ˜¯é’ˆå¯¹â€œæ˜¯/å¦â€çš„äº‹å®ã€‚WeakSet çš„å…ƒç´ å¯èƒ½ä»£è¡¨ç€æœ‰å…³è¯¥å¯¹è±¡çš„æŸäº›ä¿¡æ¯ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç”¨æˆ·æ·»åŠ åˆ° WeakSet ä¸­ï¼Œä»¥è¿½è¸ªè®¿é—®è¿‡æˆ‘ä»¬ç½‘ç«™çš„ç”¨æˆ·ï¼š

```js
let visitedSet = new WeakSet();

let john = { name: "John" };
let pete = { name: "Pete" };
let mary = { name: "Mary" };

visitedSet.add(john); // John è®¿é—®äº†æˆ‘ä»¬
visitedSet.add(pete); // ç„¶åæ˜¯ Pete
visitedSet.add(john); // John å†æ¬¡è®¿é—®

// visitedSet ç°åœ¨æœ‰ä¸¤ä¸ªç”¨æˆ·äº†

// æ£€æŸ¥ John æ˜¯å¦æ¥è®¿è¿‡ï¼Ÿ
alert(visitedSet.has(john)); // true

// æ£€æŸ¥ Mary æ˜¯å¦æ¥è®¿è¿‡ï¼Ÿ
alert(visitedSet.has(mary)); // false

john = null;

// visitedSet å°†è¢«è‡ªåŠ¨æ¸…ç†
```

`WeakMap` å’Œ `WeakSet` æœ€æ˜æ˜¾çš„å±€é™æ€§å°±æ˜¯ä¸èƒ½è¿­ä»£ï¼Œå¹¶ä¸”æ— æ³•è·å–æ‰€æœ‰å½“å‰å†…å®¹ã€‚é‚£æ ·å¯èƒ½ä¼šé€ æˆä¸ä¾¿ï¼Œä½†æ˜¯å¹¶ä¸ä¼šé˜»æ­¢ WeakMap/WeakSet å®Œæˆå…¶ä¸»è¦å·¥ä½œ â€” æˆä¸ºåœ¨å…¶å®ƒåœ°æ–¹ç®¡ç†/å­˜å‚¨â€œé¢å¤–â€çš„å¯¹è±¡æ•°æ®ã€‚

## 8.5. æ€»ç»“

`WeakMap` æ˜¯ç±»ä¼¼äº `Map` çš„é›†åˆï¼Œå®ƒä»…å…è®¸å¯¹è±¡ä½œä¸ºé”®ï¼Œå¹¶ä¸”ä¸€æ—¦é€šè¿‡å…¶ä»–æ–¹å¼æ— æ³•è®¿é—®å®ƒä»¬ï¼Œä¾¿ä¼šå°†å®ƒä»¬ä¸å…¶å…³è”å€¼ä¸€åŒåˆ é™¤ã€‚

`WeakSet` æ˜¯ç±»ä¼¼äº `Set` çš„é›†åˆï¼Œå®ƒä»…å­˜å‚¨å¯¹è±¡ï¼Œå¹¶ä¸”ä¸€æ—¦é€šè¿‡å…¶ä»–æ–¹å¼æ— æ³•è®¿é—®å®ƒä»¬ï¼Œä¾¿ä¼šå°†å…¶åˆ é™¤ã€‚

å®ƒä»¬éƒ½ä¸æ”¯æŒå¼•ç”¨æ‰€æœ‰é”®æˆ–å…¶è®¡æ•°çš„æ–¹æ³•å’Œå±æ€§ã€‚ä»…å…è®¸å•ä¸ªæ“ä½œã€‚

`WeakMap` å’Œ `WeakSet` è¢«ç”¨ä½œâ€œä¸»è¦â€å¯¹è±¡å­˜å‚¨ä¹‹å¤–çš„â€œè¾…åŠ©â€æ•°æ®ç»“æ„ã€‚ä¸€æ—¦å°†å¯¹è±¡ä»ä¸»å­˜å‚¨å™¨ä¸­åˆ é™¤ï¼Œå¦‚æœè¯¥å¯¹è±¡ä»…è¢«ç”¨ä½œ `WeakMap` æˆ– `WeakSet` çš„é”®ï¼Œé‚£ä¹ˆå®ƒå°†è¢«è‡ªåŠ¨æ¸…é™¤ã€‚

# 9. Object.keysï¼Œvaluesï¼Œentries

å¯¹å„ä¸ªæ•°æ®ç»“æ„çš„å­¦ä¹ è‡³æ­¤å‘Šä¸€æ®µè½ï¼Œä¸‹é¢è®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹å¦‚ä½•è¿­ä»£å®ƒä»¬ã€‚

åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬è®¤è¯†äº† `map.keys()`ï¼Œ`map.values()` å’Œ `map.entries()` æ–¹æ³•ã€‚

è¿™äº›æ–¹æ³•æ˜¯é€šç”¨çš„ï¼Œæœ‰ä¸€ä¸ªå…±åŒçš„çº¦å®šæ¥å°†å®ƒä»¬ç”¨äºå„ç§æ•°æ®ç»“æ„ã€‚å¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥å®ç°è¿™äº›æ–¹æ³•ã€‚

å®ƒä»¬æ”¯æŒï¼š

- `Map`
- `Set`
- `Array`

æ™®é€šå¯¹è±¡ä¹Ÿæ”¯æŒç±»ä¼¼çš„æ–¹æ³•ï¼Œä½†æ˜¯è¯­æ³•ä¸Šæœ‰ä¸€äº›ä¸åŒã€‚

## 9.1. Object.keysï¼Œvaluesï¼Œentries

å¯¹äºæ™®é€šå¯¹è±¡ï¼Œä¸‹åˆ—è¿™äº›æ–¹æ³•æ˜¯å¯ç”¨çš„ï¼š

- [`Object.keys(obj)`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/keys) â€”â€” è¿”å›ä¸€ä¸ªåŒ…å«è¯¥å¯¹è±¡æ‰€æœ‰çš„é”®çš„æ•°ç»„ã€‚
- [`Object.values(obj)`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/values) â€”â€” è¿”å›ä¸€ä¸ªåŒ…å«è¯¥å¯¹è±¡æ‰€æœ‰çš„å€¼çš„æ•°ç»„ã€‚
- [`Object.entries(obj)`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/entries) â€”â€” è¿”å›ä¸€ä¸ªåŒ…å«è¯¥å¯¹è±¡æ‰€æœ‰ [key, value] é”®å€¼å¯¹çš„æ•°ç»„ã€‚

â€¦â€¦ä½†æ˜¯è¯·æ³¨æ„åŒºåˆ«ï¼ˆæ¯”å¦‚è¯´è·Ÿ map çš„åŒºåˆ«ï¼‰ï¼š

<p></p>|	Map	|Object
--|--|--
è°ƒç”¨è¯­æ³•	|`map.keys()`	|`Object.keys(obj)`ï¼Œè€Œä¸æ˜¯ `obj.keys()`
è¿”å›å€¼	|å¯è¿­ä»£é¡¹	|â€œçœŸæ­£çš„â€æ•°ç»„

ç¬¬ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œå¯¹äºå¯¹è±¡æˆ‘ä»¬ä½¿ç”¨çš„è°ƒç”¨è¯­æ³•æ˜¯ `Object.keys(obj)`ï¼Œè€Œä¸æ˜¯ `obj.keys()`ã€‚

ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿä¸»è¦åŸå› æ˜¯çµæ´»æ€§ã€‚è¯·è®°ä½ï¼Œåœ¨ JavaScript ä¸­ï¼Œå¯¹è±¡æ˜¯æ‰€æœ‰å¤æ‚ç»“æ„çš„åŸºç¡€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯èƒ½æœ‰ä¸€ä¸ªè‡ªå·±åˆ›å»ºçš„å¯¹è±¡ï¼Œæ¯”å¦‚ dataï¼Œå¹¶å®ç°äº†å®ƒè‡ªå·±çš„ data.values() æ–¹æ³•ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥å¯¹å®ƒè°ƒç”¨ Object.values(data) æ–¹æ³•ã€‚

ç¬¬äºŒä¸ªåŒºåˆ«æ˜¯ `Object.*` æ–¹æ³•è¿”å›çš„æ˜¯â€œçœŸæ­£çš„â€æ•°ç»„å¯¹è±¡ï¼Œè€Œä¸åªæ˜¯ä¸€ä¸ªå¯è¿­ä»£é¡¹ã€‚è¿™ä¸»è¦æ˜¯å†å²åŸå› ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```js
let user = {
  name: "John",
  age: 30,
};
```

- `Object.keys(user) = ["name", "age"]`
- `Object.values(user) = ["John", 30]`
- `Object.entries(user) = [ ["name","John"], ["age",30] ]`

è¿™é‡Œæœ‰ä¸€ä¸ªä½¿ç”¨ `Object.values` æ¥éå†å±æ€§å€¼çš„ä¾‹å­ï¼š

```js
let user = {
  name: "John",
  age: 30,
};

// éå†æ‰€æœ‰çš„å€¼
for (let value of Object.values(user)) {
  alert(value); // John, then 30
}
```

> :warning:**Object.keys/values/entries ä¼šå¿½ç•¥ symbol å±æ€§**

å°±åƒ `for..in` å¾ªç¯ä¸€æ ·ï¼Œè¿™äº›æ–¹æ³•ä¼šå¿½ç•¥ä½¿ç”¨ `Symbol(...)` ä½œä¸ºé”®çš„å±æ€§ã€‚

é€šå¸¸è¿™å¾ˆæ–¹ä¾¿ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¹Ÿæƒ³è¦ Symbol ç±»å‹çš„é”®ï¼Œé‚£ä¹ˆè¿™å„¿æœ‰ä¸€ä¸ªå•ç‹¬çš„æ–¹æ³• [Object.getOwnPropertySymbols](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertySymbols)ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªåªåŒ…å« Symbol ç±»å‹çš„é”®çš„æ•°ç»„ã€‚å¦å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ–¹æ³• [Reflect.ownKeys(obj)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Reflect/ownKeys)ï¼Œå®ƒä¼šè¿”å› **æ‰€æœ‰** é”®ã€‚

## 9.2. è½¬æ¢å¯¹è±¡

å¯¹è±¡ç¼ºå°‘æ•°ç»„å­˜åœ¨çš„è®¸å¤šæ–¹æ³•ï¼Œä¾‹å¦‚ `map` å’Œ `filter` ç­‰ã€‚

å¦‚æœæˆ‘ä»¬æƒ³åº”ç”¨å®ƒä»¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ `Object.entries` ä¹‹åä½¿ç”¨ `Object.fromEntries`ï¼š

1. ä½¿ç”¨ `Object.entries(obj)` ä» obj è·å–ç”±é”®/å€¼å¯¹ç»„æˆçš„æ•°ç»„ã€‚
2. å¯¹è¯¥æ•°ç»„ä½¿ç”¨æ•°ç»„æ–¹æ³•ï¼Œä¾‹å¦‚ `map`ã€‚
3. å¯¹ç»“æœæ•°ç»„ä½¿ç”¨ `Object.fromEntries(array)` æ–¹æ³•ï¼Œå°†ç»“æœè½¬å›æˆå¯¹è±¡ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¸¦æœ‰ä»·æ ¼çš„å¯¹è±¡ï¼Œå¹¶æƒ³å°†å®ƒä»¬åŠ å€ï¼š

```js
let prices = {
  banana: 1,
  orange: 2,
  meat: 4,
};

let doublePrices = Object.fromEntries(
  // è½¬æ¢ä¸ºæ•°ç»„ï¼Œä¹‹åä½¿ç”¨ map æ–¹æ³•ï¼Œç„¶åé€šè¿‡ fromEntries å†è½¬å›åˆ°å¯¹è±¡
  Object.entries(prices).map(([key, value]) => [key, value * 2])
);

alert(doublePrices.meat); // 8
```

ä¹ä¸€çœ‹ï¼Œå¯èƒ½çœ‹èµ·æ¥å¾ˆå›°éš¾ï¼Œä½†æ˜¯ä½¿ç”¨ä¸€æ¬¡æˆ–ä¸¤æ¬¡åï¼Œå°±å¾ˆå®¹æ˜“ç†è§£äº†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼å»ºç«‹å¼ºå¤§çš„è½¬æ¢é“¾ã€‚

# 10. è§£æ„èµ‹å€¼

JavaScript ä¸­æœ€å¸¸ç”¨çš„ä¸¤ç§æ•°æ®ç»“æ„æ˜¯ `Object` å’Œ `Array`ã€‚

å¯¹è±¡è®©æˆ‘ä»¬èƒ½å¤Ÿåˆ›å»ºé€šè¿‡é”®æ¥å­˜å‚¨æ•°æ®é¡¹çš„å•ä¸ªå®ä½“ï¼Œæ•°ç»„åˆ™è®©æˆ‘ä»¬èƒ½å¤Ÿå°†æ•°æ®æ”¶é›†åˆ°ä¸€ä¸ªæœ‰åºçš„é›†åˆä¸­ã€‚

ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬æŠŠå®ƒä»¬ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œå®ƒå¯èƒ½ä¸éœ€è¦ä¸€ä¸ªæ•´ä½“çš„å¯¹è±¡/æ•°ç»„ï¼Œè€Œæ˜¯éœ€è¦å•ä¸ªå—ã€‚

**è§£æ„èµ‹å€¼**æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¯­æ³•ï¼Œå®ƒä½¿æˆ‘ä»¬å¯ä»¥å°†æ•°ç»„æˆ–å¯¹è±¡â€œæ‹†åŒ…â€ä¸ºåˆ°ä¸€ç³»åˆ—å˜é‡ä¸­ï¼Œå› ä¸ºæœ‰æ—¶å€™ä½¿ç”¨å˜é‡æ›´åŠ æ–¹ä¾¿ã€‚è§£æ„æ“ä½œå¯¹é‚£äº›å…·æœ‰å¾ˆå¤šå‚æ•°å’Œé»˜è®¤å€¼ç­‰çš„å‡½æ•°ä¹Ÿå¾ˆå¥æ•ˆã€‚

## 10.1. æ•°ç»„è§£æ„

ä¸‹é¢æ˜¯ä¸€ä¸ªå°†æ•°ç»„è§£æ„åˆ°å˜é‡ä¸­çš„ä¾‹å­ï¼š

```js
// æˆ‘ä»¬æœ‰ä¸€ä¸ªå­˜æ”¾äº†åå­—å’Œå§“æ°çš„æ•°ç»„
let arr = ["Ilya", "Kantor"];

// è§£æ„èµ‹å€¼
// sets firstName = arr[0]
// and surname = arr[1]
let [firstName, surname] = arr;

alert(firstName); // Ilya
alert(surname); // Kantor
```

ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹è¿™äº›å˜é‡è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯é’ˆå¯¹åŸæ¥çš„æ•°ç»„å…ƒç´ ã€‚

å½“ä¸ `split` å‡½æ•°ï¼ˆæˆ–å…¶ä»–è¿”å›å€¼æ˜¯æ•°ç»„çš„å‡½æ•°ï¼‰ç»“åˆä½¿ç”¨æ—¶ï¼Œçœ‹èµ·æ¥å°±æ›´ä¼˜é›…äº†ï¼š

```js
let [firstName, surname] = "Ilya Kantor".split(" ");
```

> :information_source:â€œè§£æ„â€å¹¶ä¸æ„å‘³ç€â€œç ´åâ€

è¿™ç§è¯­æ³•å«åšâ€œè§£æ„èµ‹å€¼â€ï¼Œå› ä¸ºå®ƒé€šè¿‡å°†ç»“æ„ä¸­çš„å„å…ƒç´ å¤åˆ¶åˆ°å˜é‡ä¸­æ¥è¾¾åˆ°â€œè§£æ„â€çš„ç›®çš„ã€‚ä½†æ•°ç»„æœ¬èº«æ˜¯æ²¡æœ‰è¢«ä¿®æ”¹çš„ã€‚

è¿™åªæ˜¯ä¸‹é¢è¿™äº›ä»£ç çš„æ›´ç²¾ç®€çš„å†™æ³•è€Œå·²ï¼š

```js
// let [firstName, surname] = arr;
let firstName = arr[0];
let surname = arr[1];
```

> :information_source:å¿½ç•¥ä½¿ç”¨é€—å·çš„å…ƒç´ 

æ•°ç»„ä¸­ä¸æƒ³è¦çš„å…ƒç´ ä¹Ÿå¯ä»¥é€šè¿‡æ·»åŠ é¢å¤–çš„é€—å·æ¥æŠŠå®ƒä¸¢å¼ƒï¼š

```js
// ä¸éœ€è¦ç¬¬äºŒä¸ªå…ƒç´ 
let [firstName, , title] = [
  "Julius",
  "Caesar",
  "Consul",
  "of the Roman Republic",
];

alert(title); // Consul
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ è¢«è·³è¿‡äº†ï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ è¢«èµ‹å€¼ç»™äº† title å˜é‡ï¼Œæ•°ç»„ä¸­å‰©ä¸‹çš„å…ƒç´ ä¹Ÿéƒ½è¢«è·³è¿‡äº†ï¼ˆå› ä¸ºåœ¨è¿™æ²¡æœ‰å¯¹åº”ç»™å®ƒä»¬çš„å˜é‡ï¼‰ã€‚

> :information_source:ç­‰å·å³ä¾§å¯ä»¥æ˜¯ä»»ä½•å¯è¿­ä»£å¯¹è±¡

â€¦å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ä¸ä»»ä½•å¯è¿­ä»£çš„æ•°ç»„ä¸€èµ·ä½¿ç”¨ï¼Œè€Œä¸ä»…é™äºæ•°ç»„ï¼š

```js
let [a, b, c] = "abc"; // ["a", "b", "c"]
let [one, two, three] = new Set([1, 2, 3]);
```

> :information_source:èµ‹å€¼ç»™ç­‰å·å·¦ä¾§çš„ä»»ä½•å†…å®¹

æˆ‘ä»¬å¯ä»¥åœ¨ç­‰å·å·¦ä¾§ä½¿ç”¨ä»»ä½•â€œå¯ä»¥è¢«èµ‹å€¼çš„â€ä¸œè¥¿ã€‚

ä¾‹å¦‚ï¼Œä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼š

```js
let user = {};
[user.name, user.surname] = "Ilya Kantor".split(" ");

alert(user.name); // Ilya
```

> :information_source:ä¸ .entries() æ–¹æ³•è¿›è¡Œå¾ªç¯æ“ä½œ

åœ¨å‰é¢çš„ç« èŠ‚ä¸­æˆ‘ä»¬å·²ç»è§è¿‡äº† Object.entries(obj) æ–¹æ³•ã€‚

æˆ‘ä»¬å¯ä»¥å°† `.entries()` æ–¹æ³•ä¸è§£æ„è¯­æ³•ä¸€åŒä½¿ç”¨ï¼Œæ¥éå†ä¸€ä¸ªå¯¹è±¡çš„â€œé”®â€”å€¼â€å¯¹ï¼š

```js
let user = {
  name: "John",
  age: 30,
};

// å¾ªç¯éå†é”®â€”å€¼å¯¹
for (let [key, value] of Object.entries(user)) {
  alert(`${key}:${value}`); // name:John, then age:30
}
```

â€¦â€¦å¯¹äº map å¯¹è±¡ä¹Ÿç±»ä¼¼ï¼š

```js
let user = new Map();
user.set("name", "John");
user.set("age", "30");

for (let [key, value] of user) {
  alert(`${key}:${value}`); // name:John, then age:30
}
```

## 10.2. å‰©ä½™çš„ â€˜â€¦â€™

å¦‚æœæˆ‘ä»¬ä¸åªæ˜¯è¦è·å¾—ç¬¬ä¸€ä¸ªå€¼ï¼Œè¿˜è¦å°†åç»­çš„æ‰€æœ‰å…ƒç´ éƒ½æ”¶é›†èµ·æ¥ â€” æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‰ä¸ªç‚¹ `"..."` æ¥å†åŠ ä¸€ä¸ªå‚æ•°æ¥æ¥æ”¶â€œå‰©ä½™çš„â€å…ƒç´ ï¼š

```js
let [name1, name2, ...rest] = [
  "Julius",
  "Caesar",
  "Consul",
  "of the Roman Republic",
];

alert(name1); // Julius
alert(name2); // Caesar

// è¯·æ³¨æ„ï¼Œ`rest` çš„ç±»å‹æ˜¯æ•°ç»„
alert(rest[0]); // Consul
alert(rest[1]); // of the Roman Republic
alert(rest.length); // 2
```

`rest` çš„å€¼å°±æ˜¯æ•°ç»„ä¸­å‰©ä¸‹çš„å…ƒç´ ç»„æˆçš„æ•°ç»„ã€‚ä¸ä¸€å®šè¦ä½¿ç”¨å˜é‡å `rest`ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„å˜é‡åï¼Œåªè¦ç¡®ä¿å®ƒå‰é¢æœ‰ä¸‰ä¸ªç‚¹ï¼Œå¹¶ä¸”åœ¨è§£æ„èµ‹å€¼çš„æœ€åä¸€ä¸ªå‚æ•°ä½ç½®ä¸Šå°±è¡Œäº†ã€‚

## 10.3. é»˜è®¤å€¼

å¦‚æœèµ‹å€¼è¯­å¥ä¸­ï¼Œå˜é‡çš„æ•°é‡å¤šäºæ•°ç»„ä¸­å®é™…å…ƒç´ çš„æ•°é‡ï¼Œèµ‹å€¼ä¸ä¼šæŠ¥é”™ã€‚æœªèµ‹å€¼çš„å˜é‡è¢«è®¤ä¸ºæ˜¯ `undefined`ï¼š

```js
let [firstName, surname] = [];

alert(firstName); // undefined
alert(surname); // undefined
```

å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªâ€œé»˜è®¤â€å€¼ç»™æœªèµ‹å€¼çš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `=` æ¥æä¾›ï¼š

```js
// é»˜è®¤å€¼
let [name = "Guest", surname = "Anonymous"] = ["Julius"];

alert(name); // Juliusï¼ˆæ¥è‡ªæ•°ç»„çš„å€¼ï¼‰
alert(surname); // Anonymousï¼ˆé»˜è®¤å€¼è¢«ä½¿ç”¨äº†ï¼‰
```

é»˜è®¤å€¼å¯ä»¥æ˜¯æ›´åŠ å¤æ‚çš„è¡¨è¾¾å¼ç”šè‡³å¯ä»¥æ˜¯å‡½æ•°è°ƒç”¨ï¼Œè¿™äº›è¡¨è¾¾å¼æˆ–å‡½æ•°åªä¼šåœ¨è¿™ä¸ªå˜é‡æœªè¢«èµ‹å€¼çš„æ—¶å€™æ‰ä¼šè¢«è®¡ç®—ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† `prompt` å‡½æ•°æ¥æä¾›ä¸¤ä¸ªé»˜è®¤å€¼ï¼Œä½†å®ƒåªä¼šåœ¨æœªè¢«èµ‹å€¼çš„é‚£ä¸ªå˜é‡ä¸Šè¿›è¡Œè°ƒç”¨ï¼š

```js
// åªä¼šæç¤ºè¾“å…¥å§“æ°
let [name = prompt("name?"), surname = prompt("surname?")] = ["Julius"];

alert(name); // Juliusï¼ˆæ¥è‡ªæ•°ç»„ï¼‰
alert(surname); // ä½ è¾“å…¥çš„å€¼
```

## 10.4. å¯¹è±¡è§£æ„

è§£æ„èµ‹å€¼åŒæ ·é€‚ç”¨äºå¯¹è±¡ã€‚

åŸºæœ¬è¯­æ³•æ˜¯ï¼š

```js
let {var1, var2} = {var1:â€¦, var2:â€¦}
```

åœ¨ç­‰å·å³ä¾§æœ‰ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡ï¼Œæˆ‘ä»¬æƒ³æŠŠå®ƒæ‹†å¼€åˆ°å˜é‡ä¸­ã€‚ç­‰å·å·¦ä¾§åŒ…å«äº†å¯¹è±¡ç›¸åº”å±æ€§çš„ä¸€ä¸ªâ€œæ¨¡å¼ï¼ˆpatternï¼‰â€ã€‚åœ¨ç®€å•çš„æƒ…å†µä¸‹ï¼Œç­‰å·å·¦ä¾§çš„å°±æ˜¯ {...} ä¸­çš„å˜é‡ååˆ—è¡¨ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```js
let options = {
  title: "Menu",
  width: 100,
  height: 200,
};

let { title, width, height } = options;

alert(title); // Menu
alert(width); // 100
alert(height); // 200
```

å±æ€§ `options.title`ã€`options.width` å’Œ `options.height` å€¼è¢«èµ‹ç»™äº†å¯¹åº”çš„å˜é‡ã€‚å˜é‡çš„é¡ºåºå¹¶ä¸é‡è¦ï¼Œä¸‹é¢è¿™ä¸ªä»£ç ä¹Ÿå¥æ•ˆï¼š

```js
// æ”¹å˜ let {...} ä¸­å…ƒç´ çš„é¡ºåº
let { height, width, title } = { title: "Menu", height: 200, width: 100 };
```

ç­‰å·å·¦ä¾§çš„æ¨¡å¼ï¼ˆpatternï¼‰å¯ä»¥æ›´åŠ å¤æ‚ï¼Œå¹¶ä¸”æŒ‡å®šäº†å±æ€§å’Œå˜é‡ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚

å¦‚æœæˆ‘ä»¬æƒ³æŠŠä¸€ä¸ªå±æ€§èµ‹å€¼ç»™å¦ä¸€ä¸ªåå­—çš„å˜é‡ï¼Œæ¯”å¦‚æŠŠ `options.width` å±æ€§èµ‹å€¼ç»™å˜é‡ wï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†’å·æ¥æŒ‡å®šï¼š

```js
let options = {
  title: "Menu",
  width: 100,
  height: 200,
};

// { sourceProperty: targetVariable }
let { width: w, height: h, title } = options;

// width -> w
// height -> h
// title -> title

alert(title); // Menu
alert(w); // 100
alert(h); // 200
```

å†’å·è¡¨ç¤ºâ€œä»€ä¹ˆå€¼ï¼šèµ‹å€¼ç»™è°â€ã€‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå±æ€§ `width` è¢«èµ‹å€¼ç»™äº† `w`ï¼Œå±æ€§ `height` è¢«èµ‹å€¼ç»™äº† `h`ï¼Œå±æ€§ `title` è¢«èµ‹å€¼ç»™äº†åŒåå˜é‡ã€‚

å¯¹äºå¯èƒ½ç¼ºå¤±çš„å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `"="` è®¾ç½®é»˜è®¤å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```js
let options = {
  title: "Menu",
};

let { width = 100, height = 200, title } = options;

alert(title); // Menu
alert(width); // 100
alert(height); // 200
```

å°±åƒæ•°ç»„æˆ–å‡½æ•°å‚æ•°ä¸€æ ·ï¼Œé»˜è®¤å€¼å¯ä»¥æ˜¯ä»»æ„è¡¨è¾¾å¼ç”šè‡³å¯ä»¥æ˜¯å‡½æ•°è°ƒç”¨ã€‚å®ƒä»¬åªä¼šåœ¨æœªæä¾›å¯¹åº”çš„å€¼æ—¶æ‰ä¼šè¢«è®¡ç®—/è°ƒç”¨ã€‚

åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œ`prompt` æç¤ºè¾“å…¥ `width` å€¼ï¼Œä½†ä¸ä¼šæç¤ºè¾“å…¥ `title` å€¼ï¼š

```js
let options = {
  title: "Menu",
};

let { width = prompt("width?"), title = prompt("title?") } = options;

alert(title); // Menu
alert(width); //ï¼ˆæ— è®º prompt çš„ç»“æœæ˜¯ä»€ä¹ˆï¼‰
```

æˆ‘ä»¬è¿˜å¯ä»¥å°†å†’å·å’Œç­‰å·ç»“åˆèµ·æ¥ï¼š

```js
let options = {
  title: "Menu",
};

let { width: w = 100, height: h = 200, title } = options;

alert(title); // Menu
alert(w); // 100
alert(h); // 200
```

å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå…·æœ‰å¾ˆå¤šå±æ€§çš„å¤æ‚å¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åªæå–æ‰€éœ€çš„å†…å®¹ï¼š

```js
let options = {
  title: "Menu",
  width: 100,
  height: 200,
};

// ä»…æå– title ä½œä¸ºå˜é‡
let { title } = options;

alert(title); // Menu
```

## 10.5. å‰©ä½™æ¨¡å¼ï¼ˆpatternï¼‰"â€¦"

å¦‚æœå¯¹è±¡æ‹¥æœ‰çš„å±æ€§æ•°é‡æ¯”æˆ‘ä»¬æä¾›çš„å˜é‡æ•°é‡è¿˜å¤šï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¯ä»¥åªå–å…¶ä¸­çš„æŸä¸€äº›å±æ€§ï¼Œç„¶åæŠŠâ€œå‰©ä½™çš„â€èµ‹å€¼åˆ°å…¶ä»–åœ°æ–¹å—ï¼Ÿ

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‰©ä½™æ¨¡å¼ï¼ˆpatternï¼‰ï¼Œå°±åƒæˆ‘ä»¬å¯¹æ•°ç»„é‚£æ ·ã€‚ä¸€äº›è¾ƒæ—§çš„æµè§ˆå™¨ä¸æ”¯æŒæ­¤åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ Babel å¯¹å…¶è¿›è¡Œå¡«å……ï¼‰ï¼Œä½†å¯ä»¥åœ¨ç°ä»£æµè§ˆå™¨ä¸­ä½¿ç”¨ã€‚

çœ‹èµ·æ¥å°±åƒè¿™æ ·ï¼š

```js
let options = {
  title: "Menu",
  height: 200,
  width: 100,
};

// title = åä¸º title çš„å±æ€§
// rest = å­˜æœ‰å‰©ä½™å±æ€§çš„å¯¹è±¡
let { title, ...rest } = options;

// ç°åœ¨ title="Menu", rest={height: 200, width: 100}
alert(rest.height); // 200
alert(rest.width); // 100
```

> :information_source:ä¸ä½¿ç”¨ `let` æ—¶çš„é™·é˜±

åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå˜é‡éƒ½æ˜¯åœ¨èµ‹å€¼ä¸­é€šè¿‡æ­£ç¡®æ–¹å¼å£°æ˜çš„ï¼šlet {â€¦} = {â€¦}ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å·²æœ‰çš„å˜é‡ï¼Œè€Œä¸ç”¨ letï¼Œä½†è¿™é‡Œæœ‰ä¸€ä¸ªé™·é˜±ã€‚

ä»¥ä¸‹ä»£ç æ— æ³•æ­£å¸¸è¿è¡Œï¼š

```js
let title, width, height;

// è¿™ä¸€è¡Œå‘ç”Ÿäº†é”™è¯¯
{title, width, height} = {title: "Menu", width: 200, height: 100};
```

é—®é¢˜åœ¨äº JavaScript æŠŠä¸»ä»£ç æµï¼ˆå³ä¸åœ¨å…¶ä»–è¡¨è¾¾å¼ä¸­ï¼‰çš„ `{...}` å½“åšä¸€ä¸ªä»£ç å—ã€‚è¿™æ ·çš„ä»£ç å—å¯ä»¥ç”¨äºå¯¹è¯­å¥åˆ†ç»„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```js
{
  // ä¸€ä¸ªä»£ç å—
  let message = "Hello";
  // ...
  alert(message);
}
```

å› æ­¤ï¼Œè¿™é‡Œ JavaScript å‡å®šæˆ‘ä»¬æœ‰ä¸€ä¸ªä»£ç å—ï¼Œè¿™å°±æ˜¯æŠ¥é”™çš„åŸå› ã€‚æˆ‘ä»¬éœ€è¦è§£æ„å®ƒã€‚

ä¸ºäº†å‘Šè¯‰ JavaScript è¿™ä¸æ˜¯ä¸€ä¸ªä»£ç å—ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•´ä¸ªèµ‹å€¼è¡¨è¾¾å¼ç”¨æ‹¬å· `(...)` åŒ…èµ·æ¥ï¼š

```js
let title, width, height;

// ç°åœ¨å°±å¯ä»¥äº†
({ title, width, height } = { title: "Menu", width: 200, height: 100 });

alert(title); // Menu
```

## 10.6. åµŒå¥—è§£æ„

å¦‚æœä¸€ä¸ªå¯¹è±¡æˆ–æ•°ç»„åµŒå¥—äº†å…¶ä»–çš„å¯¹è±¡å’Œæ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç­‰å·å·¦ä¾§ä½¿ç”¨æ›´å¤æ‚çš„æ¨¡å¼ï¼ˆpatternï¼‰æ¥æå–æ›´æ·±å±‚çš„æ•°æ®ã€‚

åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œ`options` çš„å±æ€§ `size` æ˜¯å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå±æ€§ `items` æ˜¯å¦ä¸€ä¸ªæ•°ç»„ã€‚èµ‹å€¼è¯­å¥ä¸­ç­‰å·å·¦ä¾§çš„æ¨¡å¼ï¼ˆpatternï¼‰å…·æœ‰ç›¸åŒçš„ç»“æ„ä»¥ä»ä¸­æå–å€¼ï¼š

```js
let options = {
  size: {
    width: 100,
    height: 200,
  },
  items: ["Cake", "Donut"],
  extra: true,
};

// ä¸ºäº†æ¸…æ™°èµ·è§ï¼Œè§£æ„èµ‹å€¼è¯­å¥è¢«å†™æˆå¤šè¡Œçš„å½¢å¼
let {
  size: {
    // æŠŠ size èµ‹å€¼åˆ°è¿™é‡Œ
    width,
    height,
  },
  items: [item1, item2], // æŠŠ items èµ‹å€¼åˆ°è¿™é‡Œ
  title = "Menu", // åœ¨å¯¹è±¡ä¸­ä¸å­˜åœ¨ï¼ˆä½¿ç”¨é»˜è®¤å€¼ï¼‰
} = options;

alert(title); // Menu
alert(width); // 100
alert(height); // 200
alert(item1); // Cake
alert(item2); // Donut
```

å¯¹è±¡ `options` çš„æ‰€æœ‰å±æ€§ï¼Œé™¤äº† `extra` å±æ€§åœ¨ç­‰å·å·¦ä¾§ä¸å­˜åœ¨ï¼Œéƒ½è¢«èµ‹å€¼ç»™äº†å¯¹åº”çš„å˜é‡ï¼š

![](https://zh.javascript.info/article/destructuring-assignment/destructuring-complex.svg)

æœ€ç»ˆï¼Œæˆ‘ä»¬å¾—åˆ°äº† `width`ã€`height`ã€`item1`ã€`item2` å’Œå…·æœ‰é»˜è®¤å€¼çš„`title` å˜é‡ã€‚

æ³¨æ„ï¼Œ`size` å’Œ `items` æ²¡æœ‰å¯¹åº”çš„å˜é‡ï¼Œå› ä¸ºæˆ‘ä»¬å–çš„æ˜¯å®ƒä»¬çš„å†…å®¹ã€‚

## 10.7. æ™ºèƒ½å‡½æ•°å‚æ•°

æœ‰æ—¶ï¼Œä¸€ä¸ªå‡½æ•°æœ‰å¾ˆå¤šå‚æ•°ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†çš„å‚æ•°éƒ½æ˜¯å¯é€‰çš„ã€‚å¯¹ç”¨æˆ·ç•Œé¢æ¥è¯´æ›´æ˜¯å¦‚æ­¤ã€‚æƒ³è±¡ä¸€ä¸ªåˆ›å»ºèœå•çš„å‡½æ•°ã€‚å®ƒå¯èƒ½å…·æœ‰å®½åº¦å‚æ•°ï¼Œé«˜åº¦å‚æ•°ï¼Œæ ‡é¢˜å‚æ•°å’Œé¡¹ç›®åˆ—è¡¨ç­‰ã€‚

ä¸‹é¢æ˜¯å®ç°è¿™ç§å‡½æ•°çš„ä¸€ä¸ªå¾ˆä¸å¥½çš„å†™æ³•ï¼š

```js
function showMenu(title = "Untitled", width = 200, height = 100, items = []) {
  // ...
}
```

åœ¨å®é™…å¼€å‘ä¸­å­˜åœ¨ä¸€ä¸ªé—®é¢˜å°±æ˜¯ä½ æ€ä¹ˆè®°å¾—ä½è¿™ä¹ˆå¤šå‚æ•°çš„é¡ºåºã€‚é€šå¸¸é›†æˆå¼€å‘ç¯å¢ƒå·¥å…·ï¼ˆIDEï¼‰ä¼šå°½åŠ›å¸®åŠ©æˆ‘ä»¬ï¼Œç‰¹åˆ«æ˜¯å½“ä»£ç æœ‰è‰¯å¥½çš„æ–‡æ¡£æ³¨é‡Šçš„æ—¶å€™ï¼Œä½†æ˜¯â€¦â€¦ å¦ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œå½“å¤§éƒ¨åˆ†çš„å‚æ•°é‡‡ç”¨é»˜è®¤å€¼å°±å¥½çš„æƒ…å†µä¸‹ï¼Œæ€ä¹ˆè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚

éš¾é“åƒè¿™æ ·ï¼Ÿ

```js
// åœ¨é‡‡ç”¨é»˜è®¤å€¼å°±å¯ä»¥çš„ä½ç½®è®¾ç½® undefined
showMenu("My Menu", undefined, undefined, ["Item1", "Item2"]);
```

è¿™å¤ªéš¾çœ‹äº†ã€‚è€Œä¸”ï¼Œå½“æˆ‘ä»¬å¤„ç†æ›´å¤šå‚æ•°çš„æ—¶å€™å¯è¯»æ€§ä¼šå˜å¾—å¾ˆå·®ã€‚

è§£æ„èµ‹å€¼è¯­æ³•å‰æ¥æ•‘æ´ï¼

æˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰å‚æ•°å½“ä½œä¸€ä¸ªå¯¹è±¡æ¥ä¼ é€’ï¼Œç„¶åå‡½æ•°é©¬ä¸ŠæŠŠè¿™ä¸ªå¯¹è±¡è§£æ„æˆå¤šä¸ªå˜é‡ï¼š

```js
// æˆ‘ä»¬ä¼ é€’ä¸€ä¸ªå¯¹è±¡ç»™å‡½æ•°
let options = {
  title: "My menu",
  items: ["Item1", "Item2"],
};

// â€¦â€¦ç„¶åå‡½æ•°é©¬ä¸ŠæŠŠå¯¹è±¡å±•å¼€æˆå˜é‡
function showMenu({
  title = "Untitled",
  width = 200,
  height = 100,
  items = [],
}) {
  // title, items â€“ æå–äº optionsï¼Œ
  // width, height â€“ ä½¿ç”¨é»˜è®¤å€¼
  alert(`${title} ${width} ${height}`); // My Menu 200 100
  alert(items); // Item1, Item2
}

showMenu(options);
```

æˆ‘ä»¬åŒæ ·å¯ä»¥ä½¿ç”¨å¸¦æœ‰åµŒå¥—å¯¹è±¡å’Œå†’å·æ˜ å°„çš„æ›´åŠ å¤æ‚çš„è§£æ„ï¼š

```js
let options = {
  title: "My menu",
  items: ["Item1", "Item2"],
};

function showMenu({
  title = "Untitled",
  width: w = 100, // width goes to w
  height: h = 200, // height goes to h
  items: [item1, item2], // items first element goes to item1, second to item2
}) {
  alert(`${title} ${w} ${h}`); // My Menu 100 200
  alert(item1); // Item1
  alert(item2); // Item2
}

showMenu(options);
```

å®Œæ•´è¯­æ³•å’Œè§£æ„èµ‹å€¼æ˜¯ä¸€æ ·çš„ï¼š

```js
function({
  incomingProperty: varName = defaultValue
  ...
})
```

å¯¹äºå‚æ•°å¯¹è±¡ï¼Œå±æ€§ `incomingProperty` å¯¹åº”çš„å˜é‡æ˜¯ `varName`ï¼Œé»˜è®¤å€¼æ˜¯ `defaultValue`ã€‚

è¯·æ³¨æ„ï¼Œè¿™ç§è§£æ„å‡å®šäº† `showMenu()` å‡½æ•°ç¡®å®å­˜åœ¨å‚æ•°ã€‚å¦‚æœæˆ‘ä»¬æƒ³è®©æ‰€æœ‰çš„å‚æ•°éƒ½ä½¿ç”¨é»˜è®¤å€¼ï¼Œé‚£æˆ‘ä»¬åº”è¯¥ä¼ é€’ä¸€ä¸ªç©ºå¯¹è±¡ï¼š

```js
showMenu({}); // ä¸é”™ï¼Œæ‰€æœ‰å€¼éƒ½å–é»˜è®¤å€¼

showMenu(); // è¿™æ ·ä¼šå¯¼è‡´é”™è¯¯
```

æˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šç©ºå¯¹è±¡ `{}` ä¸ºæ•´ä¸ªå‚æ•°å¯¹è±¡çš„é»˜è®¤å€¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š

```js
function showMenu({ title = "Menu", width = 100, height = 200 } = {}) {
  alert(`${title} ${width} ${height}`);
}

showMenu(); // Menu 100 200
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ•´ä¸ªå‚æ•°å¯¹è±¡çš„é»˜è®¤æ˜¯ `{}`ï¼Œå› æ­¤æ€»ä¼šæœ‰å†…å®¹å¯ä»¥ç”¨æ¥è§£æ„ã€‚

## 10.8. æ€»ç»“

- è§£æ„èµ‹å€¼å¯ä»¥ç«‹å³å°†ä¸€ä¸ªå¯¹è±¡æˆ–æ•°ç»„æ˜ å°„åˆ°å¤šä¸ªå˜é‡ä¸Šã€‚
- è§£æ„å¯¹è±¡çš„å®Œæ•´è¯­æ³•ï¼š

  ```js
  let {prop : varName = default, ...rest} = object
  ```

  è¿™è¡¨ç¤ºå±æ€§ `prop` ä¼šè¢«èµ‹å€¼ç»™å˜é‡ `varName`ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªå±æ€§çš„è¯ï¼Œå°±ä¼šä½¿ç”¨é»˜è®¤å€¼ `default`ã€‚

  æ²¡æœ‰å¯¹åº”æ˜ å°„é¥¿å¯¹è±¡å±æ€§è¢«å¤åˆ¶åˆ° `rest` å¯¹è±¡ã€‚

- è§£æ„æ•°ç»„çš„å®Œæ•´è¯­æ³•ï¼š
  ```js
  let [item1 = default, item2, ...rest] = array
  ```
  æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¢«èµ‹å€¼ç»™ `item1`ï¼Œç¬¬äºŒä¸ªå…ƒç´ è¢«èµ‹å€¼ç»™ `item2`ï¼Œå‰©ä¸‹çš„æ‰€æœ‰å…ƒç´ è¢«å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ•°ç»„ `rest`ã€‚
- ä»åµŒå¥—æ•°ç»„/å¯¹è±¡ä¸­æå–æ•°æ®ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ­¤æ—¶ç­‰å·å·¦ä¾§å¿…é¡»å’Œç­‰å·å³ä¾§æœ‰ç›¸åŒçš„ç»“æ„ã€‚

# 11. æ—¥æœŸå’Œæ—¶é—´

è®©æˆ‘ä¸€èµ·å­¦ä¹ ä¸€ä¸ªæ–°çš„å†…å»ºå¯¹è±¡ï¼š[æ—¥æœŸï¼ˆDateï¼‰](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date)ã€‚è¯¥å¯¹è±¡å­˜å‚¨æ—¥æœŸå’Œæ—¶é—´ï¼Œå¹¶æä¾›äº†æ—¥æœŸ/æ—¶é—´çš„ç®¡ç†æ–¹æ³•ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥å­˜å‚¨åˆ›å»º/ä¿®æ”¹æ—¶é—´ï¼Œæˆ–è€…ç”¨æ¥æµ‹é‡æ—¶é—´ï¼Œå†æˆ–è€…ä»…ç”¨æ¥æ‰“å°å½“å‰æ—¶é—´ã€‚

## 11.1. åˆ›å»º

åˆ›å»ºä¸€ä¸ªæ–°çš„ `Date` å¯¹è±¡ï¼Œåªéœ€è¦è°ƒç”¨ `new Date()`ï¼Œåœ¨è°ƒç”¨æ—¶å¯ä»¥å¸¦æœ‰ä¸‹é¢è¿™äº›å‚æ•°ä¹‹ä¸€ï¼š

**`new Date()`**

ä¸å¸¦å‚æ•° â€”â€” åˆ›å»ºä¸€ä¸ªè¡¨ç¤ºå½“å‰æ—¥æœŸå’Œæ—¶é—´çš„`Date` å¯¹è±¡ï¼š

```js
let now = new Date();
alert(now); // æ˜¾ç¤ºå½“å‰çš„æ—¥æœŸ/æ—¶é—´
```

**`new Date(milliseconds)`**

åˆ›å»ºä¸€ä¸ª `Date` å¯¹è±¡ï¼Œå…¶æ—¶é—´ç­‰äº 1970-01-01 00:00:00 UTC+0 å†è¿‡ä¸€æ¯«ç§’ï¼ˆ1/1000 ç§’ï¼‰ã€‚

```js
// 0 è¡¨ç¤º 01.01.1970 UTC+0
let Jan01_1970 = new Date(0);
alert(Jan01_1970);

// ç°åœ¨å¢åŠ  24 å°æ—¶ï¼Œå¾—åˆ° 02.01.1970 UTC+0
let Jan02_1970 = new Date(24 * 3600 * 1000);
alert(Jan02_1970);
```

ä¼ å…¥çš„æ•´æ•°å‚æ•°ä»£è¡¨çš„æ˜¯è‡ª 1970-01-01 00:00:00 ä»¥æ¥ç»è¿‡çš„æ¯«ç§’æ•°ï¼Œè¯¥æ•´æ•°è¢«ç§°ä¸º **æ—¶é—´æˆ³**ã€‚

è¿™æ˜¯ä¸€ç§æ—¥æœŸçš„è½»é‡çº§æ•°å­—è¡¨ç¤ºå½¢å¼ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ **new Date(timestamp)** é€šè¿‡æ—¶é—´æˆ³æ¥åˆ›å»ºæ—¥æœŸï¼Œå¹¶å¯ä»¥ä½¿ç”¨ **date.getTime()** å°†ç°æœ‰çš„ `Date` å¯¹è±¡è½¬åŒ–ä¸ºæ—¶é—´æˆ³ï¼ˆä¸‹æ–‡ä¼šè®²åˆ°ï¼‰ã€‚

åœ¨ 01.01.1970 ä¹‹å‰çš„æ—¥æœŸå¸¦æœ‰è´Ÿçš„æ—¶é—´æˆ³ï¼Œä¾‹å¦‚ï¼š

```js
// 31 Dec 1969
let Dec31_1969 = new Date(-24 * 3600 * 1000);
alert(Dec31_1969);
```

**`new Date(datestring)`**

å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«è‡ªåŠ¨è§£æã€‚è¯¥ç®—æ³•ä¸ `Date.parse` æ‰€ä½¿ç”¨çš„ç®—æ³•ç›¸åŒï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹æ–‡ä¸­è¿›è¡Œä»‹ç»ã€‚

```js
let date = new Date("2017-01-26");
alert(date);æ—¶é—´æœªè®¾ç½®ï¼Œå› æ­¤å‡å®šä¸ºæ ¼æ—å°¼æ²»æ ‡å‡†æ—¶é—´åˆå¤œ 50  //æ ¹æ®è¿è¡Œä»£ç çš„æ—¶åŒºè¿›è¡Œè°ƒæ•´
// è¯¥æ—¶é—´æœªè¢«è®¾å®šï¼Œå› æ­¤è¢«å‡å®šä¸ºæ ¼æ—å°¼æ²»æ ‡å‡†æ—¶é—´ï¼ˆGMTï¼‰çš„åˆå¤œï¼ˆmidnightï¼‰
// å¹¶ä¼šæ ¹æ®ä½ è¿è¡Œä»£ç æ—¶çš„æ—¶åŒºè¿›è¡Œè°ƒæ•´
// å› æ­¤ï¼Œç»“æœå¯èƒ½æ˜¯
// Thu Jan 26 2017 11:00:00 GMT+1100 (Australian Eastern Daylight Time)
// æˆ–
// Wed Jan 25 2017 16:00:00 GMT-0800 (Pacific Standard Time)
```

**`new Date(year, month, date, hours, minutes, seconds, ms)`**

ä½¿ç”¨å½“å‰æ—¶åŒºä¸­çš„ç»™å®šç»„ä»¶åˆ›å»ºæ—¥æœŸã€‚åªæœ‰å‰ä¸¤ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚

- `year` å¿…é¡»æ˜¯å››ä½æ•°ï¼š`2013` æ˜¯åˆæ³•çš„ï¼Œ98 æ˜¯ä¸åˆæ³•çš„ã€‚
- `month` è®¡æ•°ä» `0`ï¼ˆä¸€æœˆï¼‰å¼€å§‹ï¼Œåˆ° `11`ï¼ˆåäºŒæœˆï¼‰ç»“æŸã€‚
- `date` æ˜¯å½“æœˆçš„å…·ä½“æŸä¸€å¤©ï¼Œå¦‚æœç¼ºå¤±ï¼Œåˆ™ä¸ºé»˜è®¤å€¼ `1`ã€‚
- `å¦‚æœ`hours/minutes/seconds/ms` ç¼ºå¤±ï¼Œåˆ™å‡ä¸ºé»˜è®¤å€¼ 0ã€‚

ä¾‹å¦‚ï¼š

```js
new Date(2011, 0, 1, 0, 0, 0, 0); // 1 Jan 2011, 00:00:00
new Date(2011, 0, 1); // åŒæ ·ï¼Œæ—¶åˆ†ç§’ç­‰å‡ä¸ºé»˜è®¤å€¼ 0
```

æ—¶é—´åº¦é‡æœ€å°ç²¾ç¡®åˆ° 1 æ¯«ç§’ï¼ˆ1/1000 ç§’ï¼‰ï¼š

```js
let date = new Date(2011, 0, 1, 2, 3, 4, 567);
alert(date); // 1.01.2011, 02:03:04.567
```

## 11.2. è®¿é—®æ—¥æœŸç»„ä»¶

ä» `Date` å¯¹è±¡ä¸­è®¿é—®å¹´ã€æœˆç­‰ä¿¡æ¯æœ‰å¤šç§æ–¹å¼ï¼š

- [getFullYear()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getFullYear) è·å–å¹´ä»½ï¼ˆ4 ä½æ•°ï¼‰
- [getMonth()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getMonth) è·å–æœˆä»½ï¼Œä» 0 åˆ° 11ã€‚
- [getDate()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getDate) è·å–å½“æœˆçš„å…·ä½“æ—¥æœŸï¼Œä» 1 åˆ° 31ï¼Œè¿™ä¸ªæ–¹æ³•åç§°å¯èƒ½çœ‹èµ·æ¥æœ‰äº›ä»¤äººç–‘æƒ‘ã€‚
- [getHours()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getHours)ï¼Œ[getMinutes()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getMinutes)ï¼Œ[getSeconds()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getSeconds)ï¼Œ[getMilliseconds()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getMilliseconds)
  è·å–ç›¸åº”çš„æ—¶é—´ç»„ä»¶ã€‚

> :warning:**ä¸æ˜¯ getYear()ï¼Œè€Œæ˜¯ getFullYear()**

å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è·å–ä¸€å‘¨ä¸­çš„ç¬¬å‡ å¤©ï¼š

- [getDay()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getDay)
  è·å–ä¸€å‘¨ä¸­çš„ç¬¬å‡ å¤©ï¼Œä» 0ï¼ˆæ˜ŸæœŸæ—¥ï¼‰åˆ° 6ï¼ˆæ˜ŸæœŸå…­ï¼‰ã€‚ç¬¬ä¸€å¤©å§‹ç»ˆæ˜¯æ˜ŸæœŸæ—¥ï¼Œåœ¨æŸäº›å›½å®¶å¯èƒ½ä¸æ˜¯è¿™æ ·çš„ä¹ æƒ¯ï¼Œä½†æ˜¯è¿™ä¸èƒ½è¢«æ”¹å˜ã€‚

**ä»¥ä¸Šçš„æ‰€æœ‰æ–¹æ³•è¿”å›çš„ç»„ä»¶éƒ½æ˜¯åŸºäºå½“åœ°æ—¶åŒºçš„ã€‚**

å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸å½“åœ°æ—¶åŒºçš„ UTC å¯¹åº”é¡¹ï¼Œå®ƒä»¬ä¼šè¿”å›åŸºäº UTC+0 æ—¶åŒºçš„æ—¥ã€æœˆã€å¹´ç­‰ï¼š[getUTCFullYear()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getUTCFullYear)ï¼Œ[getUTCMonth()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getUTCMonth)ï¼Œ[getUTCDay()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getUTCDay)ã€‚åªéœ€è¦åœ¨ `"get"` ä¹‹åæ’å…¥ `"UTC"` å³å¯ã€‚

å¦‚æœä½ å½“åœ°æ—¶åŒºç›¸å¯¹äº UTC æœ‰åç§»ï¼Œé‚£ä¹ˆä¸‹é¢ä»£ç ä¼šæ˜¾ç¤ºä¸åŒçš„å°æ—¶æ•°ï¼š

```js
//  å½“å‰æ—¥æœŸ
let date = new Date();

// å½“åœ°æ—¶åŒºçš„å°æ—¶æ•°
alert(date.getHours());

// åœ¨ UTC+0 æ—¶åŒºçš„å°æ—¶æ•°ï¼ˆéå¤ä»¤æ—¶çš„ä¼¦æ•¦æ—¶é—´ï¼‰
alert(date.getUTCHours());
```

é™¤äº†ä¸Šè¿°ç»™å®šçš„æ–¹æ³•ï¼Œè¿˜æœ‰ä¸¤ä¸ªæ²¡æœ‰ UTC å˜ä½“çš„ç‰¹æ®Šæ–¹æ³•ï¼š

- [getTime()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getTime)
  è¿”å›æ—¥æœŸçš„æ—¶é—´æˆ³ â€”â€” ä» 1970-1-1 00:00:00 UTC+0 å¼€å§‹åˆ°ç°åœ¨æ‰€ç»è¿‡çš„æ¯«ç§’æ•°ã€‚

- [getTimezoneOffset()](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset)
  è¿”å› UTC ä¸æœ¬åœ°æ—¶åŒºä¹‹é—´çš„æ—¶å·®ï¼Œä»¥åˆ†é’Ÿä¸ºå•ä½ï¼š

```js
// å¦‚æœä½ åœ¨æ—¶åŒº UTC-1ï¼Œè¾“å‡º 60
// å¦‚æœä½ åœ¨æ—¶åŒº UTC+3ï¼Œè¾“å‡º -180
alert(new Date().getTimezoneOffset());
```

## 11.3. è®¾ç½®æ—¥æœŸç»„ä»¶

ä¸‹åˆ—æ–¹æ³•å¯ä»¥è®¾ç½®æ—¥æœŸ/æ—¶é—´ç»„ä»¶ï¼š

- [`setFullYear(year, [month], [date])`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setFullYear)
- [`setMonth(month, [date])`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setMonth)
- [`setDate(date)`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setDate)
- [`setHours(hour, [min], [sec], [ms])`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setHours)
- [`setMinutes(min, [sec], [ms])`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setMinutes)
- [`setSeconds(sec, [ms])`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setSeconds)
- [`setMilliseconds(ms)`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setMilliseconds)
- [`setTime(milliseconds)`](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/setTime)ï¼ˆä½¿ç”¨è‡ª 1970-01-01 00:00:00 UTC+0 ä»¥æ¥çš„æ¯«ç§’æ•°æ¥è®¾ç½®æ•´ä¸ªæ—¥æœŸï¼‰

ä»¥ä¸Šæ–¹æ³•é™¤äº† `setTime()` éƒ½æœ‰ UTC å˜ä½“ï¼Œä¾‹å¦‚ï¼š`setUTCHours()`ã€‚

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ‰äº›æ–¹æ³•å¯ä»¥ä¸€æ¬¡æ€§è®¾ç½®å¤šä¸ªç»„ä»¶ï¼Œæ¯”å¦‚ `setHours`ã€‚æœªæåŠçš„ç»„ä»¶ä¸ä¼šè¢«ä¿®æ”¹ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```js
let today = new Date();

today.setHours(0);
alert(today); // æ—¥æœŸä¾ç„¶æ˜¯ä»Šå¤©ï¼Œä½†æ˜¯å°æ—¶æ•°è¢«æ”¹ä¸ºäº† 0

today.setHours(0, 0, 0, 0);
alert(today); // æ—¥æœŸä¾ç„¶æ˜¯ä»Šå¤©ï¼Œæ—¶é—´ä¸º 00:00:00ã€‚
```

## 11.4. è‡ªåŠ¨æ ¡å‡†ï¼ˆAutocorrectionï¼‰

**è‡ªåŠ¨æ ¡å‡†** æ˜¯ Date å¯¹è±¡çš„ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„ç‰¹æ€§ã€‚æˆ‘ä»¬å¯ä»¥è®¾ç½®è¶…èŒƒå›´çš„æ•°å€¼ï¼Œå®ƒä¼šè‡ªåŠ¨æ ¡å‡†ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```js
let date = new Date(2013, 0, 32); // 32 Jan 2013 ?!?
alert(date); // â€¦â€¦æ˜¯ 1st Feb 2013!
```

è¶…å‡ºèŒƒå›´çš„æ—¥æœŸç»„ä»¶å°†ä¼šè¢«è‡ªåŠ¨åˆ†é…ã€‚

å‡è®¾æˆ‘ä»¬è¦åœ¨æ—¥æœŸ â€œ28 Feb 2016â€ ä¸ŠåŠ  2 å¤©ã€‚ç»“æœå¯èƒ½æ˜¯ â€œ2 Marâ€ æˆ– â€œ1 Marâ€ï¼Œå› ä¸ºå­˜åœ¨é—°å¹´ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸éœ€è¦å»è€ƒè™‘è¿™äº›ï¼Œåªéœ€è¦ç›´æ¥åŠ  2 å¤©ï¼Œå‰©ä¸‹çš„ Date å¯¹è±¡ä¼šå¸®æˆ‘ä»¬å¤„ç†ï¼š

```js
let date = new Date(2016, 1, 28);
date.setDate(date.getDate() + 2);

alert(date); // 1 Mar 2016
```

è¿™ä¸ªç‰¹æ€§ç»å¸¸è¢«ç”¨æ¥è·å–ç»™å®šæ—¶é—´æ®µåçš„æ—¥æœŸã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³è·å–â€œç°åœ¨ 70 ç§’åâ€çš„æ—¥æœŸï¼š

```js
let date = new Date();
date.setSeconds(date.getSeconds() + 70);

alert(date); // æ˜¾ç¤ºæ­£ç¡®çš„æ—¥æœŸä¿¡æ¯
```

æˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½® 0 ç”šè‡³å¯ä»¥è®¾ç½®è´Ÿå€¼ã€‚ä¾‹å¦‚ï¼š

```js
let date = new Date(2016, 0, 2); // 2016 å¹´ 1 æœˆ 2 æ—¥

date.setDate(1); // è®¾ç½®ä¸ºå½“æœˆçš„ç¬¬ä¸€å¤©
alert(date);

date.setDate(0); // å¤©æ•°æœ€å°å¯ä»¥è®¾ç½®ä¸º 1ï¼Œæ‰€ä»¥è¿™é‡Œè®¾ç½®çš„æ˜¯ä¸Šä¸€æœˆçš„æœ€åä¸€å¤©
alert(date); // 31 Dec 2015
```

## 11.5. æ—¥æœŸè½¬åŒ–ä¸ºæ•°å­—ï¼Œæ—¥æœŸå·®å€¼

å½“ `Date`å¯¹è±¡è¢«è½¬åŒ–ä¸ºæ•°å­—æ—¶ï¼Œå¾—åˆ°çš„æ˜¯å¯¹åº”çš„æ—¶é—´æˆ³ï¼Œä¸ä½¿ç”¨ `date.getTime()` çš„ç»“æœç›¸åŒï¼š

```js
let date = new Date();
alert(+date); // ä»¥æ¯«ç§’ä¸ºå•ä½çš„æ•°å€¼ï¼Œä¸ä½¿ç”¨ date.getTime() çš„ç»“æœç›¸åŒ
```

æœ‰ä¸€ä¸ªé‡è¦çš„å‰¯ä½œç”¨ï¼šæ—¥æœŸå¯ä»¥ç›¸å‡ï¼Œç›¸å‡çš„ç»“æœæ˜¯ä»¥æ¯«ç§’ä¸ºå•ä½æ—¶é—´å·®ã€‚

è¿™ä¸ªä½œç”¨å¯ä»¥ç”¨äºæ—¶é—´æµ‹é‡ï¼š

```js
let start = new Date(); // å¼€å§‹æµ‹é‡æ—¶é—´

// do the job
for (let i = 0; i < 100000; i++) {
  let doSomething = i * i * i;
}

let end = new Date(); // ç»“æŸæµ‹é‡æ—¶é—´

alert(`The loop took ${end - start} ms`);
```

## 11.6. Date.now()

å¦‚æœæˆ‘ä»¬ä»…ä»…æƒ³è¦æµ‹é‡æ—¶é—´é—´éš”ï¼Œæˆ‘ä»¬ä¸éœ€è¦ `Date` å¯¹è±¡ã€‚

æœ‰ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³• `Date.now()`ï¼Œå®ƒä¼šè¿”å›å½“å‰çš„æ—¶é—´æˆ³ã€‚

å®ƒç›¸å½“äº `new Date().getTime()`ï¼Œä½†å®ƒä¸ä¼šåˆ›å»ºä¸­é—´çš„ Date å¯¹è±¡ã€‚å› æ­¤å®ƒæ›´å¿«ï¼Œè€Œä¸”ä¸ä¼šå¯¹åƒåœ¾å¤„ç†é€ æˆé¢å¤–çš„å‹åŠ›ã€‚

è¿™ç§æ–¹æ³•å¾ˆå¤šæ—¶å€™å› ä¸ºæ–¹ä¾¿ï¼Œåˆæˆ–æ˜¯å› æ€§èƒ½æ–¹é¢çš„è€ƒè™‘è€Œè¢«é‡‡ç”¨ï¼Œä¾‹å¦‚ä½¿ç”¨ JavaScript ç¼–å†™æ¸¸æˆæˆ–å…¶ä»–çš„ç‰¹æ®Šåº”ç”¨åœºæ™¯ã€‚

å› æ­¤è¿™æ ·åšå¯èƒ½ä¼šæ›´å¥½ï¼š

```JS
let start = Date.now(); // ä» 1 Jan 1970 è‡³ä»Šçš„æ—¶é—´æˆ³

// do the job
for (let i = 0; i < 100000; i++) {
  let doSomething = i * i * i;
}

let end = Date.now(); // å®Œæˆ

alert( `The loop took ${end - start} ms` ); // ç›¸å‡çš„æ˜¯æ—¶é—´æˆ³ï¼Œè€Œä¸æ˜¯æ—¥æœŸ
```

## 11.7. åº¦é‡ï¼ˆBenchmarkingï¼‰

å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸ºä¸€ä¸ªå¾ˆè€— CPU æ€§èƒ½çš„å‡½æ•°æä¾›ä¸€ä¸ªå¯é çš„åº¦é‡ï¼ˆbenchmarkï¼‰ï¼Œæˆ‘ä»¬åº”è¯¥å°å¿ƒä¸€ç‚¹ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³åˆ¤æ–­ä¸¤ä¸ªè®¡ç®—æ—¥æœŸå·®å€¼çš„å‡½æ•°ï¼šå“ªä¸ªæ›´å¿«ï¼Ÿ

è¿™ç§æ€§èƒ½æµ‹é‡é€šå¸¸ç§°ä¸ºâ€œåº¦é‡ï¼ˆbenchmarkï¼‰â€ã€‚

```js
// æˆ‘ä»¬æœ‰ date1 å’Œ date2ï¼Œå“ªä¸ªå‡½æ•°ä¼šæ›´å¿«åœ°è¿”å›ä¸¤è€…çš„æ—¶é—´å·®ï¼Ÿ
function diffSubtract(date1, date2) {
  return date2 - date1;
}

// or
function diffGetTime(date1, date2) {
  return date2.getTime() - date1.getTime();
}
```

è¿™ä¸¤ä¸ªå‡½æ•°åšçš„äº‹æƒ…å®Œå…¨ç›¸åŒï¼Œä½†æ˜¯å…¶ä¸­ä¸€ä¸ªå‡½æ•°ä½¿ç”¨æ˜¾æ€§çš„ date.getTime() æ¥è·å–æ¯«ç§’å½¢å¼çš„æ—¥æœŸï¼Œå¦ä¸€ä¸ªåˆ™ä¾èµ–äºâ€œæ—¥æœŸ â€” æ•°å­—â€çš„è½¬æ¢ã€‚å®ƒä»¬çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚

é‚£ä¹ˆï¼Œå“ªä¸ªæ›´å¿«å‘¢ï¼Ÿ

é¦–å…ˆæƒ³åˆ°çš„æ–¹æ³•å¯èƒ½æ˜¯è¿ç»­è¿è¡Œå®ƒä»¬å¾ˆå¤šæ¬¡ï¼Œå¹¶è®¡ç®—æ—¶é—´å·®ã€‚å°±æˆ‘ä»¬çš„ä¾‹å­è€Œè¨€ï¼Œå‡½æ•°éå¸¸ç®€å•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æ‰§è¡Œè‡³å°‘ 100000 æ¬¡ã€‚

è®©æˆ‘ä»¬å¼€å§‹æµ‹é‡ï¼š

```js
function diffSubtract(date1, date2) {
  return date2 - date1;
}

function diffGetTime(date1, date2) {
  return date2.getTime() - date1.getTime();
}

function bench(f) {
  let date1 = new Date(0);
  let date2 = new Date();

  let start = Date.now();
  for (let i = 0; i < 100000; i++) f(date1, date2);
  return Date.now() - start;
}

alert("Time of diffSubtract: " + bench(diffSubtract) + "ms");
alert("Time of diffGetTime: " + bench(diffGetTime) + "ms");
```

å“‡ï¼ä½¿ç”¨ `getTime()` è¿™ç§æ–¹å¼å¿«å¾—å¤šï¼åŸå› æ˜¯å®ƒæ²¡æœ‰ç±»å‹è½¬åŒ–ï¼Œè¿™æ ·å¯¹å¼•æ“ä¼˜åŒ–æ¥è¯´æ›´åŠ ç®€å•ã€‚

å¥½ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ç»“è®ºï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åº¦é‡çš„ä¾‹å­ã€‚

æƒ³è±¡ä¸€ä¸‹å½“è¿è¡Œ`bench(diffSubtract)` çš„åŒæ—¶ï¼ŒCPU è¿˜åœ¨å¹¶è¡Œå¤„ç†å…¶ä»–äº‹åŠ¡ï¼Œå¹¶ä¸”è¿™ä¹Ÿä¼šå ç”¨èµ„æºã€‚ç„¶è€Œï¼Œè¿è¡Œ `bench(diffGetTime)` çš„æ—¶å€™ï¼Œå¹¶è¡Œå¤„ç†çš„äº‹åŠ¡å®Œæˆäº†ã€‚

è¿™æ˜¯å¯¹äºç°ä»£å¤šè¿›ç¨‹æ“ä½œç³»ç»Ÿæ¥è¯´çš„ä¸€ä¸ªéå¸¸çœŸå®çš„åœºæ™¯ã€‚

ç»“æœå°±æ˜¯ï¼Œç¬¬ä¸€ä¸ªå‡½æ•°ç›¸æ¯”äºç¬¬äºŒä¸ªå‡½æ•°ï¼Œç¼ºå°‘ CPU èµ„æºã€‚è¿™å¯èƒ½å¯¼è‡´é”™è¯¯çš„ç»“è®ºã€‚

**ä¸ºäº†å¾—åˆ°æ›´åŠ å¯é çš„åº¦é‡ï¼Œæ•´ä¸ªåº¦é‡æµ‹è¯•åŒ…åº”è¯¥é‡æ–°è¿è¡Œå¤šæ¬¡ã€‚**

ä¾‹å¦‚ï¼Œåƒä¸‹é¢çš„ä»£ç è¿™æ ·ï¼š

```js
function diffSubtract(date1, date2) {
  return date2 - date1;
}

function diffGetTime(date1, date2) {
  return date2.getTime() - date1.getTime();
}

function bench(f) {
  let date1 = new Date(0);
  let date2 = new Date();

  let start = Date.now();
  for (let i = 0; i < 100000; i++) f(date1, date2);
  return Date.now() - start;
}

let time1 = 0;
let time2 = 0;

// äº¤æ›¿è¿è¡Œ bench(upperSlice) å’Œ bench(upperLoop) å„ 10 æ¬¡
for (let i = 0; i < 10; i++) {
  time1 += bench(diffSubtract);
  time2 += bench(diffGetTime);
}

alert("Total time for diffSubtract: " + time1);
alert("Total time for diffGetTime: " + time2);
```

ç°ä»£çš„ JavaScript å¼•æ“çš„å…ˆè¿›ä¼˜åŒ–ç­–ç•¥åªå¯¹æ‰§è¡Œå¾ˆå¤šæ¬¡çš„ â€œhot codeâ€ æœ‰æ•ˆï¼ˆå¯¹äºæ‰§è¡Œå¾ˆå°‘æ¬¡æ•°çš„ä»£ç æ²¡æœ‰å¿…è¦ä¼˜åŒ–ï¼‰ã€‚å› æ­¤ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œçš„ä¼˜åŒ–ç¨‹åº¦ä¸é«˜ã€‚æˆ‘ä»¬å¯èƒ½éœ€è¦å¢åŠ ä¸€ä¸ªå‡æ¸©æ­¥éª¤ï¼š

```js
// åœ¨ä¸»å¾ªç¯ä¸­å¢åŠ â€œå‡æ¸©â€ç¯èŠ‚
bench(diffSubtract);
bench(diffGetTime);

// å¼€å§‹åº¦é‡
for (let i = 0; i < 10; i++) {
  time1 += bench(diffSubtract);
  time2 += bench(diffGetTime);
}
```

> :information_source:è¿›è¡Œå¾®åº¦é‡æµ‹è¯•æ—¶è¦å°å¿ƒ

ç°ä»£çš„ JavaScript å¼•æ“æ‰§è¡Œäº†å¾ˆå¤šä¼˜åŒ–ã€‚ä¸â€œæ­£å¸¸ä½¿ç”¨â€ç›¸æ¯”ï¼Œå®ƒä»¬å¯èƒ½ä¼šæ”¹å˜â€œäººä¸ºæµ‹è¯•â€çš„ç»“æœï¼Œç‰¹åˆ«æ˜¯åœ¨æˆ‘ä»¬å¯¹å¾ˆç»†å¾®çš„ä¸œè¥¿è¿›è¡Œåº¦é‡æµ‹è¯•æ—¶ï¼Œä¾‹å¦‚ operator çš„å·¥ä½œæ–¹å¼æˆ–å†…å»ºå‡½æ•°ã€‚å› æ­¤ï¼Œå¦‚æœä½ æƒ³å¥½å¥½äº†è§£ä¸€ä¸‹æ€§èƒ½ï¼Œè¯·å­¦ä¹  JavaScript å¼•æ“çš„å·¥ä½œåŸç†ã€‚åœ¨é‚£ä¹‹åï¼Œä½ å¯èƒ½å†ä¹Ÿä¸éœ€è¦å¾®åº¦é‡äº†ã€‚

å…³äº V8 å¼•æ“çš„å¤§é‡æ–‡ç« ï¼Œå¯ä»¥åœ¨ http://mrale.ph æ‰¾åˆ°ã€‚

## 11.8. å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨ Date.parse

[Date.parse(str)](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date/parse) æ–¹æ³•å¯ä»¥ä»ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­è¯»å–æ—¥æœŸã€‚

å­—ç¬¦ä¸²çš„æ ¼å¼åº”è¯¥ä¸ºï¼š`YYYY-MM-DDTHH:mm:ss.sssZ`ï¼Œå…¶ä¸­ï¼š

- `YYYY-MM-DD` â€”â€” æ—¥æœŸï¼šå¹´-æœˆ-æ—¥ã€‚
- å­—ç¬¦ `"T"` æ˜¯ä¸€ä¸ªåˆ†éš”ç¬¦ã€‚
- `HH:mm:ss.sss` â€”â€” æ—¶é—´ï¼šå°æ—¶ï¼Œåˆ†é’Ÿï¼Œç§’ï¼Œæ¯«ç§’ã€‚
- å¯é€‰å­—ç¬¦ `'Z'`ä¸º `+-hh:mm` æ ¼å¼çš„æ—¶åŒºã€‚å•ä¸ªå­—ç¬¦ `Z`ä»£è¡¨`UTC+0` æ—¶åŒºã€‚

ç®€çŸ­å½¢å¼ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ¯”å¦‚ `YYYY-MM-DD` æˆ– `YYYY-MM`ï¼Œç”šè‡³å¯ä»¥æ˜¯ `YYYY`ã€‚

`Date.parse(str)` è°ƒç”¨ä¼šè§£æç»™å®šæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›æ—¶é—´æˆ³ï¼ˆè‡ª 1970-01-01 00:00:00 èµ·æ‰€ç»è¿‡çš„æ¯«ç§’æ•°ï¼‰ã€‚å¦‚æœç»™å®šå­—ç¬¦ä¸²çš„æ ¼å¼ä¸æ­£ç¡®ï¼Œåˆ™è¿”å› `NaN`ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```js
let ms = Date.parse("2012-01-26T13:51:50.417-07:00");

alert(ms); // 1327611110417  (æ—¶é—´æˆ³)
```

æˆ‘ä»¬å¯ä»¥é€šè¿‡æ—¶é—´æˆ³æ¥ç«‹å³åˆ›å»ºä¸€ä¸ª `new Date` å¯¹è±¡ï¼š

```js
let date = new Date(Date.parse("2012-01-26T13:51:50.417-07:00"));

alert(date);
```

## 11.9. æ€»ç»“

- åœ¨ JavaScript ä¸­ï¼Œæ—¥æœŸå’Œæ—¶é—´ä½¿ç”¨ [Date](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Date) å¯¹è±¡æ¥è¡¨ç¤ºã€‚æˆ‘ä»¬ä¸èƒ½åªåˆ›å»ºæ—¥æœŸï¼Œæˆ–è€…åªåˆ›å»ºæ—¶é—´ï¼ŒDate å¯¹è±¡æ€»æ˜¯åŒæ—¶åˆ›å»ºä¸¤è€…ã€‚
- æœˆä»½ä» 0 å¼€å§‹è®¡æ•°ï¼ˆå¯¹ï¼Œä¸€æœˆæ˜¯ 0ï¼‰ã€‚
- ä¸€å‘¨ä¸­çš„æŸä¸€å¤© getDay() åŒæ ·ä» 0 å¼€å§‹è®¡ç®—ï¼ˆ0 ä»£è¡¨æ˜ŸæœŸæ—¥ï¼‰ã€‚
- å½“è®¾ç½®äº†è¶…å‡ºèŒƒå›´çš„ç»„ä»¶æ—¶ï¼ŒDate ä¼šè¿›è¡Œè‡ªæˆ‘æ ¡å‡†ã€‚è¿™ä¸€ç‚¹å¯¹äºæ—¥/æœˆ/å°æ—¶çš„åŠ å‡å¾ˆæœ‰ç”¨ã€‚
- æ—¥æœŸå¯ä»¥ç›¸å‡ï¼Œå¾—åˆ°çš„æ˜¯ä»¥æ¯«ç§’è¡¨ç¤ºçš„ä¸¤è€…çš„å·®å€¼ã€‚å› ä¸ºå½“ Date è¢«è½¬æ¢ä¸ºæ•°å­—æ—¶ï¼ŒDate å¯¹è±¡ä¼šè¢«è½¬æ¢ä¸ºæ—¶é—´æˆ³ã€‚
- ä½¿ç”¨ Date.now() å¯ä»¥æ›´å¿«åœ°è·å–å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ã€‚

å’Œå…¶ä»–ç³»ç»Ÿä¸åŒï¼ŒJavaScript ä¸­æ—¶é—´æˆ³ä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œè€Œä¸æ˜¯ç§’ã€‚

æœ‰æ—¶æˆ‘ä»¬éœ€è¦æ›´åŠ ç²¾å‡†çš„æ—¶é—´åº¦é‡ã€‚JavaScript è‡ªèº«å¹¶æ²¡æœ‰æµ‹é‡å¾®ç§’çš„æ–¹æ³•ï¼ˆç™¾ä¸‡åˆ†ä¹‹ä¸€ç§’ï¼‰ï¼Œä½†å¤§å¤šæ•°è¿è¡Œç¯å¢ƒä¼šæä¾›ã€‚ä¾‹å¦‚ï¼šæµè§ˆå™¨æœ‰ [performance.now()](https://developer.mozilla.org/zh/docs/Web/API/Performance/now) æ–¹æ³•æ¥ç»™å‡ºä»é¡µé¢åŠ è½½å¼€å§‹çš„ä»¥æ¯«ç§’ä¸ºå•ä½çš„å¾®ç§’æ•°ï¼ˆç²¾ç¡®åˆ°æ¯«ç§’çš„å°æ•°ç‚¹åä¸‰ä½ï¼‰ï¼š

```js
alert(`Loading started ${performance.now()}ms ago`);
// ç±»ä¼¼äº "Loading started 34731.26000000001ms ago"
// .26 è¡¨ç¤ºçš„æ˜¯å¾®ç§’ï¼ˆ260 å¾®ç§’ï¼‰
// å°æ•°ç‚¹åè¶…è¿‡ 3 ä½çš„æ•°å­—æ˜¯ç²¾åº¦é”™è¯¯ï¼Œåªæœ‰å‰ä¸‰ä½æ•°å­—æ˜¯æ­£ç¡®çš„
```

Node.js æœ‰ `microtime` æ¨¡å—ä»¥åŠå…¶ä»–æ–¹æ³•ã€‚ä»æŠ€æœ¯ä¸Šè®²ï¼Œå‡ ä¹æ‰€æœ‰çš„è®¾å¤‡å’Œç¯å¢ƒéƒ½å…è®¸è·å–æ›´é«˜ç²¾åº¦çš„æ•°å€¼ï¼Œåªæ˜¯ä¸æ˜¯é€šè¿‡ `Date` å¯¹è±¡ã€‚

# 12. JSON æ–¹æ³•ï¼ŒtoJSON

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä»¥é€šè¿‡ç½‘ç»œå‘é€ï¼Œæˆ–è€…åªæ˜¯ä¸ºäº†åœ¨æ—¥å¿—ä¸­è¾“å‡ºå®ƒã€‚

å½“ç„¶ï¼Œè¿™æ ·çš„å­—ç¬¦ä¸²åº”è¯¥åŒ…å«æ‰€æœ‰é‡è¦çš„å±æ€§ã€‚

æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·å®ç°è½¬æ¢ï¼š

```js
let user = {
  name: "John",
  age: 30,

  toString() {
    return `{name: "${this.name}", age: ${this.age}}`;
  },
};

alert(user); // {name: "John", age: 30}
```

â€¦â€¦ä½†åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¼šæ–°å¢ä¸€äº›å±æ€§ï¼Œæ—§çš„å±æ€§ä¼šè¢«é‡å‘½åå’Œåˆ é™¤ã€‚æ¯æ¬¡æ›´æ–°è¿™ç§ toString éƒ½ä¼šéå¸¸ç—›è‹¦ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•éå†å…¶ä¸­çš„å±æ€§ï¼Œä½†æ˜¯å¦‚æœå¯¹è±¡å¾ˆå¤æ‚ï¼Œå¹¶ä¸”åœ¨å±æ€§ä¸­åµŒå¥—äº†å¯¹è±¡å‘¢ï¼Ÿæˆ‘ä»¬ä¹Ÿéœ€è¦å¯¹å®ƒä»¬è¿›è¡Œè½¬æ¢ã€‚

å¹¸è¿çš„æ˜¯ï¼Œä¸éœ€è¦ç¼–å†™ä»£ç æ¥å¤„ç†æ‰€æœ‰è¿™äº›é—®é¢˜ã€‚è¿™é¡¹ä»»åŠ¡å·²ç»è§£å†³äº†ã€‚

## 12.1. JSON.stringify

[JSON](http://en.wikipedia.org/wiki/JSON)ï¼ˆJavaScript Object Notationï¼‰æ˜¯è¡¨ç¤ºå€¼å’Œå¯¹è±¡çš„é€šç”¨æ ¼å¼ã€‚åœ¨ [RFC 4627](http://tools.ietf.org/html/rfc4627) æ ‡å‡†ä¸­æœ‰å¯¹å…¶çš„æè¿°ã€‚æœ€åˆå®ƒæ˜¯ä¸º JavaScript è€Œåˆ›å»ºçš„ï¼Œä½†è®¸å¤šå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¹Ÿæœ‰ç”¨äºå¤„ç†å®ƒçš„åº“ã€‚å› æ­¤ï¼Œå½“å®¢æˆ·ç«¯ä½¿ç”¨ JavaScript è€ŒæœåŠ¡å™¨ç«¯æ˜¯ä½¿ç”¨ Ruby/PHP/Java ç­‰è¯­è¨€ç¼–å†™çš„æ—¶ï¼Œä½¿ç”¨ JSON å¯ä»¥å¾ˆå®¹æ˜“åœ°è¿›è¡Œæ•°æ®äº¤æ¢ã€‚

JavaScript æä¾›äº†å¦‚ä¸‹æ–¹æ³•ï¼š

- `JSON.stringify` å°†å¯¹è±¡è½¬æ¢ä¸º JSONã€‚
- `JSON.parse` å°† JSON è½¬æ¢å›å¯¹è±¡ã€‚

ä¾‹å¦‚ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ `JSON.stringify` ä¸€ä¸ª student å¯¹è±¡ï¼š

```js
let student = {
  name: "John",
  age: 30,
  isAdmin: false,
  courses: ["html", "css", "js"],
  wife: null,
};

let json = JSON.stringify(student);

alert(typeof json); // we've got a string!

alert(json);
/* JSON ç¼–ç çš„å¯¹è±¡ï¼š
{
  "name": "John",
  "age": 30,
  "isAdmin": false,
  "courses": ["html", "css", "js"],
  "wife": null
}
*/
```

æ–¹æ³• `JSON.stringify(student)` æ¥æ”¶å¯¹è±¡å¹¶å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚

å¾—åˆ°çš„ `json` å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªè¢«ç§°ä¸º **JSON ç¼–ç **ï¼ˆJSON-encodedï¼‰ æˆ– **åºåˆ—åŒ–ï¼ˆserializedï¼‰** æˆ– **å­—ç¬¦ä¸²åŒ–ï¼ˆstringifiedï¼‰** æˆ– **ç¼–ç»„åŒ–ï¼ˆmarshalledï¼‰** çš„å¯¹è±¡ã€‚æˆ‘ä»¬ç°åœ¨å·²ç»å‡†å¤‡å¥½é€šè¿‡æœ‰çº¿å‘é€å®ƒæˆ–å°†å…¶æ”¾å…¥æ™®é€šæ•°æ®å­˜å‚¨ã€‚

è¯·æ³¨æ„ï¼ŒJSON ç¼–ç çš„å¯¹è±¡ä¸å¯¹è±¡å­—é¢é‡æœ‰å‡ ä¸ªé‡è¦çš„åŒºåˆ«ï¼š

- å­—ç¬¦ä¸²ä½¿ç”¨åŒå¼•å·ã€‚JSON ä¸­æ²¡æœ‰å•å¼•å·æˆ–åå¼•å·ã€‚æ‰€ä»¥ `'John'` è¢«è½¬æ¢ä¸º `"John"`ã€‚
- å¯¹è±¡å±æ€§åç§°ä¹Ÿæ˜¯åŒå¼•å·çš„ã€‚è¿™æ˜¯å¼ºåˆ¶æ€§çš„ã€‚æ‰€ä»¥ `age:30` è¢«è½¬æ¢æˆ `"age":30`ã€‚

`JSON.stringify` ä¹Ÿå¯ä»¥åº”ç”¨äºåŸå§‹ï¼ˆprimitiveï¼‰æ•°æ®ç±»å‹ã€‚

JSON æ”¯æŒä»¥ä¸‹æ•°æ®ç±»å‹ï¼š

- Objects `{ ... }`
- Arrays `[ ... ]`
- Primitivesï¼š
  - strings
  - numbers
  - boolean values `true/false`
  - null

ä¾‹å¦‚ï¼š

```js
// æ•°å­—åœ¨ JSON è¿˜æ˜¯æ•°å­—
alert(JSON.stringify(1)); // 1

// å­—ç¬¦ä¸²åœ¨ JSON ä¸­è¿˜æ˜¯å­—ç¬¦ä¸²ï¼Œåªæ˜¯è¢«åŒå¼•å·æ‰©èµ·æ¥
alert(JSON.stringify("test")); // "test"

alert(JSON.stringify(true)); // true

alert(JSON.stringify([1, 2, 3])); // [1,2,3]
```

JSON æ˜¯è¯­è¨€æ— å…³çš„çº¯æ•°æ®è§„èŒƒï¼Œå› æ­¤ä¸€äº›ç‰¹å®šäº JavaScript çš„å¯¹è±¡å±æ€§ä¼šè¢« `JSON.stringify` è·³è¿‡ã€‚

å³ï¼š

- å‡½æ•°å±æ€§ï¼ˆæ–¹æ³•ï¼‰ã€‚
- Symbol ç±»å‹çš„å±æ€§ã€‚
- å­˜å‚¨ `undefined` çš„å±æ€§ã€‚

```js
let user = {
  sayHi() {
    // è¢«å¿½ç•¥
    alert("Hello");
  },
  [Symbol("id")]: 123, // è¢«å¿½ç•¥
  something: undefined, // è¢«å¿½ç•¥
};

alert(JSON.stringify(user)); // {}ï¼ˆç©ºå¯¹è±¡ï¼‰
```

é€šå¸¸è¿™å¾ˆå¥½ã€‚å¦‚æœè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾ˆå¿«å°±ä¼šçœ‹åˆ°å¦‚ä½•è‡ªå®šä¹‰è½¬æ¢æ–¹å¼ã€‚

æœ€æ£’çš„æ˜¯æ”¯æŒåµŒå¥—å¯¹è±¡è½¬æ¢ï¼Œå¹¶ä¸”å¯ä»¥è‡ªåŠ¨å¯¹å…¶è¿›è¡Œè½¬æ¢ã€‚

ä¾‹å¦‚ï¼š

```js
let meetup = {
  title: "Conference",
  room: {
    number: 23,
    participants: ["john", "ann"],
  },
};

alert(JSON.stringify(meetup));
/* æ•´ä¸ªè§£æ„éƒ½è¢«å­—ç¬¦ä¸²åŒ–äº†
{
  "title":"Conference",
  "room":{"number":23,"participants":["john","ann"]},
}
*/
```

é‡è¦çš„é™åˆ¶ï¼šä¸å¾—æœ‰å¾ªç¯å¼•ç”¨ã€‚

ä¾‹å¦‚ï¼š

```js
let room = {
  number: 23,
};

let meetup = {
  title: "Conference",
  participants: ["john", "ann"],
};

meetup.place = room; // meetup å¼•ç”¨äº† room
room.occupiedBy = meetup; // room å¼•ç”¨äº† meetup

JSON.stringify(meetup); // Error: Converting circular structure to JSON
```

åœ¨è¿™é‡Œï¼Œè½¬æ¢å¤±è´¥äº†ï¼Œå› ä¸ºå¾ªç¯å¼•ç”¨ï¼š`room.occupiedBy` å¼•ç”¨äº†`meetup`ï¼Œ`meetup.place` å¼•ç”¨äº† `room`ï¼š

![](https://zh.javascript.info/article/json/json-meetup.svg)

## 12.2. æ’é™¤å’Œè½¬æ¢ï¼šreplacer

`JSON.stringify` çš„å®Œæ•´è¯­æ³•æ˜¯ï¼š

```JS
let json = JSON.stringify(value[, replacer, space])
```

- `value`
  è¦ç¼–ç çš„å€¼ã€‚
- `replacer`
  è¦ç¼–ç çš„å±æ€§æ•°ç»„æˆ–æ˜ å°„å‡½æ•° function(key, value)ã€‚
- `space`
  ç”¨äºæ ¼å¼åŒ–çš„ç©ºæ ¼æ•°é‡

å¤§éƒ¨åˆ†æƒ…å†µï¼Œ`JSON.stringify` ä»…ä¸ç¬¬ä¸€ä¸ªå‚æ•°ä¸€èµ·ä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¾®è°ƒæ›¿æ¢è¿‡ç¨‹ï¼Œæ¯”å¦‚è¿‡æ»¤æ‰å¾ªç¯å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ JSON.stringify çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚

å¦‚æœæˆ‘ä»¬ä¼ é€’ä¸€ä¸ªå±æ€§æ•°ç»„ç»™å®ƒï¼Œé‚£ä¹ˆåªæœ‰è¿™äº›å±æ€§ä¼šè¢«ç¼–ç ã€‚

ä¾‹å¦‚ï¼š

```js
let room = {
  number: 23,
};

let meetup = {
  title: "Conference",
  participants: [{ name: "John" }, { name: "Alice" }],
  place: room, // meetup å¼•ç”¨äº† room
};

room.occupiedBy = meetup; // room å¼•ç”¨äº† meetup

alert(JSON.stringify(meetup, ["title", "participants"]));
// {"title":"Conference","participants":[{},{}]}
```

è¿™é‡Œæˆ‘ä»¬å¯èƒ½è¿‡äºä¸¥æ ¼äº†ã€‚å±æ€§åˆ—è¡¨åº”ç”¨äºäº†æ•´ä¸ªå¯¹è±¡ç»“æ„ã€‚æ‰€ä»¥ `participants` æ˜¯ç©ºçš„ï¼Œå› ä¸º `name` ä¸åœ¨åˆ—è¡¨ä¸­ã€‚

è®©æˆ‘ä»¬åŒ…å«é™¤äº†ä¼šå¯¼è‡´å¾ªç¯å¼•ç”¨çš„ `room.occupiedBy` ä¹‹å¤–çš„æ‰€æœ‰å±æ€§ï¼š

```js
let room = {
  number: 23,
};

let meetup = {
  title: "Conference",
  participants: [{ name: "John" }, { name: "Alice" }],
  place: room, // meetup å¼•ç”¨äº† room
};

room.occupiedBy = meetup; // room å¼•ç”¨äº† meetup

alert(
  JSON.stringify(meetup, ["title", "participants", "place", "name", "number"])
);
/*
{
  "title":"Conference",
  "participants":[{"name":"John"},{"name":"Alice"}],
  "place":{"number":23}
}
*/
```

ç°åœ¨ï¼Œé™¤ `occupiedBy` ä»¥å¤–çš„æ‰€æœ‰å†…å®¹éƒ½è¢«åºåˆ—åŒ–äº†ã€‚ä½†æ˜¯å±æ€§çš„åˆ—è¡¨å¤ªé•¿äº†ã€‚

å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ä»£æ›¿æ•°ç»„ä½œä¸º `replacer`ã€‚

è¯¥å‡½æ•°ä¼šä¸ºæ¯ä¸ª`(key,value)` å¯¹è°ƒç”¨å¹¶è¿”å›â€œå·²æ›¿æ¢â€çš„å€¼ï¼Œè¯¥å€¼å°†æ›¿æ¢åŸæœ‰çš„å€¼ã€‚å¦‚æœå€¼è¢«è·³è¿‡äº†ï¼Œåˆ™ä¸º `undefined`ã€‚

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º `occupiedBy` ä»¥å¤–çš„æ‰€æœ‰å†…å®¹æŒ‰åŸæ ·è¿”å› `value`ã€‚ä¸ºäº† `occupiedBy`ï¼Œä¸‹é¢çš„ä»£ç è¿”å›`undefined`ï¼š

```js
let room = {
  number: 23,
};

let meetup = {
  title: "Conference",
  participants: [{ name: "John" }, { name: "Alice" }],
  place: room, // meetup å¼•ç”¨äº† room
};

room.occupiedBy = meetup; // room å¼•ç”¨äº† meetup

alert(
  JSON.stringify(meetup, function replacer(key, value) {
    alert(`${key}: ${value}`);
    return key == "occupiedBy" ? undefined : value;
  })
);

/* key:value pairs that come to replacer:
:             [object Object]
title:        Conference
participants: [object Object],[object Object]
0:            [object Object]
name:         John
1:            [object Object]
name:         Alice
place:        [object Object]
number:       23
*/
```

è¯·æ³¨æ„`replacer` å‡½æ•°ä¼šè·å–æ¯ä¸ªé”®/å€¼å¯¹ï¼ŒåŒ…æ‹¬åµŒå¥—å¯¹è±¡å’Œæ•°ç»„é¡¹ã€‚å®ƒè¢«é€’å½’åœ°åº”ç”¨ã€‚`replacer` ä¸­çš„ `this` çš„å€¼æ˜¯åŒ…å«å½“å‰å±æ€§çš„å¯¹è±¡ã€‚

ç¬¬ä¸€ä¸ªè°ƒç”¨å¾ˆç‰¹åˆ«ã€‚å®ƒæ˜¯ä½¿ç”¨ç‰¹æ®Šçš„â€œåŒ…è£…å¯¹è±¡â€åˆ¶ä½œçš„ï¼š{"": meetup}ã€‚æ¢å¥è¯è¯´ï¼Œç¬¬ä¸€ä¸ª `(key, value)` å¯¹çš„é”®æ˜¯ç©ºçš„ï¼Œå¹¶ä¸”è¯¥å€¼æ˜¯æ•´ä¸ªç›®æ ‡å¯¹è±¡ã€‚è¿™å°±æ˜¯ä¸Šé¢çš„ç¤ºä¾‹ä¸­ç¬¬ä¸€è¡Œæ˜¯ `":[object Object]"`çš„åŸå› ã€‚

è¿™ä¸ªç†å¿µæ˜¯ä¸ºäº†ç»™`replacer` æä¾›å°½å¯èƒ½å¤šçš„åŠŸèƒ½ï¼šå¦‚æœæœ‰å¿…è¦ï¼Œå®ƒæœ‰æœºä¼šåˆ†æå¹¶æ›¿æ¢/è·³è¿‡æ•´ä¸ªå¯¹è±¡ã€‚

## 12.3. æ ¼å¼åŒ–ï¼šspace

`JSON.stringify(value, replacer, spaces)` çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ç”¨äºä¼˜åŒ–æ ¼å¼çš„ç©ºæ ¼æ•°é‡ã€‚

ä»¥å‰ï¼Œæ‰€æœ‰å­—ç¬¦ä¸²åŒ–çš„å¯¹è±¡éƒ½æ²¡æœ‰ç¼©è¿›å’Œé¢å¤–çš„ç©ºæ ¼ã€‚å¦‚æœæˆ‘ä»¬æƒ³é€šè¿‡ç½‘ç»œå‘é€ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£å°±æ²¡ä»€ä¹ˆé—®é¢˜ã€‚`space`å‚æ•°ä¸“é—¨ç”¨äºè°ƒæ•´å‡ºæ›´ç¾è§‚çš„è¾“å‡ºã€‚

è¿™é‡Œçš„ `space = 2` å‘Šè¯‰ JavaScript åœ¨å¤šè¡Œä¸­æ˜¾ç¤ºåµŒå¥—çš„å¯¹è±¡ï¼Œå¯¹è±¡å†…éƒ¨ç¼©ç´§ 2 ä¸ªç©ºæ ¼ï¼š

```js
let user = {
  name: "John",
  age: 25,
  roles: {
    isAdmin: false,
    isEditor: true,
  },
};

alert(JSON.stringify(user, null, 2));
/* ä¸¤ä¸ªç©ºæ ¼çš„ç¼©è¿›ï¼š
{
  "name": "John",
  "age": 25,
  "roles": {
    "isAdmin": false,
    "isEditor": true
  }
}
*/

/* å¯¹äº JSON.stringify(user, null, 4) çš„ç»“æœä¼šæœ‰æ›´å¤šç¼©è¿›ï¼š
{
    "name": "John",
    "age": 25,
    "roles": {
        "isAdmin": false,
        "isEditor": true
    }
}
*/
```

`spaces` å‚æ•°ä»…ç”¨äºæ—¥å¿—è®°å½•å’Œç¾åŒ–è¾“å‡ºã€‚

## 12.4. è‡ªå®šä¹‰ â€œtoJSONâ€

åƒ `toString` è¿›è¡Œå­—ç¬¦ä¸²è½¬æ¢ï¼Œå¯¹è±¡ä¹Ÿå¯ä»¥æä¾› toJSON æ–¹æ³•æ¥è¿›è¡Œ JSON è½¬æ¢ã€‚å¦‚æœå¯ç”¨ï¼Œ`JSON.stringify` ä¼šè‡ªåŠ¨è°ƒç”¨å®ƒã€‚

ä¾‹å¦‚ï¼š

```js
let room = {
  number: 23,
};

let meetup = {
  title: "Conference",
  date: new Date(Date.UTC(2017, 0, 1)),
  room,
};

alert(JSON.stringify(meetup));
/*
  {
    "title":"Conference",
    "date":"2017-01-01T00:00:00.000Z",  // (1)
    "room": {"number":23}               // (2)
  }
*/
```

åœ¨è¿™å„¿æˆ‘ä»¬å¯ä»¥çœ‹åˆ° `date (1)` å˜æˆäº†ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¿™æ˜¯å› ä¸ºæ‰€æœ‰æ—¥æœŸéƒ½æœ‰ä¸€ä¸ªå†…ç½®çš„ toJSON æ–¹æ³•æ¥è¿”å›è¿™ç§ç±»å‹çš„å­—ç¬¦ä¸²ã€‚

ç°åœ¨è®©æˆ‘ä»¬ä¸ºå¯¹è±¡ `room` æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„ `toJSON`ï¼š

```js
let room = {
  number: 23,
  toJSON() {
    return this.number;
  },
};

let meetup = {
  title: "Conference",
  room,
};

alert(JSON.stringify(room)); // 23

alert(JSON.stringify(meetup));
/*
  {
    "title":"Conference",
    "room": 23
  }
*/
```

æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œ`toJSON` æ—¢å¯ä»¥ç”¨äºç›´æ¥è°ƒç”¨ `JSON.stringify(room)` ä¹Ÿå¯ä»¥ç”¨äºå½“ `room` åµŒå¥—åœ¨å¦ä¸€ä¸ªç¼–ç å¯¹è±¡ä¸­æ—¶ã€‚

## 12.5. JSON.parse

è¦è§£ç  JSON å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬éœ€è¦å¦ä¸€ä¸ªæ–¹æ³• [JSON.parse](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse)ã€‚

è¯­æ³•ï¼š

```js
let value = JSON.parse(str, [reviver]);
```

- **`str`** è¦è§£æçš„ JSON å­—ç¬¦ä¸²ã€‚
- **`reviver`**
  å¯é€‰çš„å‡½æ•° function(key,value)ï¼Œè¯¥å‡½æ•°å°†ä¸ºæ¯ä¸ª (key, value) å¯¹è°ƒç”¨ï¼Œå¹¶å¯ä»¥å¯¹å€¼è¿›è¡Œè½¬æ¢ã€‚

ä¾‹å¦‚ï¼š

```js
// å­—ç¬¦ä¸²åŒ–æ•°ç»„
let numbers = "[0, 1, 2, 3]";

numbers = JSON.parse(numbers);

alert(numbers[1]); // 1
```

å¯¹äºåµŒå¥—å¯¹è±¡ï¼š

```js
let userData =
  '{ "name": "John", "age": 35, "isAdmin": false, "friends": [0,1,2,3] }';

let user = JSON.parse(userData);

alert(user.friends[1]); // 1
```

JSON å¯èƒ½ä¼šéå¸¸å¤æ‚ï¼Œå¯¹è±¡å’Œæ•°ç»„å¯ä»¥åŒ…å«å…¶ä»–å¯¹è±¡å’Œæ•°ç»„ã€‚ä½†æ˜¯ä»–ä»¬å¿…é¡»éµå¾ªç›¸åŒçš„ JSON æ ¼å¼ã€‚

ä»¥ä¸‹æ˜¯æ‰‹å†™ JSON æ—¶çš„å…¸å‹é”™è¯¯ï¼ˆæœ‰æ—¶æˆ‘ä»¬å¿…é¡»å‡ºäºè°ƒè¯•ç›®çš„ç¼–å†™å®ƒï¼‰ï¼š

```js
let json = `{
  name: "John",                     // é”™è¯¯ï¼šå±æ€§åæ²¡æœ‰åŒå¼•å·
  "surname": 'Smith',               // é”™è¯¯ï¼šå€¼ä½¿ç”¨çš„æ˜¯å•å¼•å·ï¼ˆå¿…é¡»ä½¿ç”¨åŒå¼•å·ï¼‰
  'isAdmin': false                  // é”™è¯¯ï¼šé”®ä½¿ç”¨çš„æ˜¯å•å¼•å·ï¼ˆå¿…é¡»ä½¿ç”¨åŒå¼•å·ï¼‰
  "birthday": new Date(2000, 2, 3), // é”™è¯¯ï¼šä¸å…è®¸ä½¿ç”¨ "new"ï¼Œåªèƒ½æ˜¯è£¸å€¼
  "friends": [0,1,2,3]              // è¿™ä¸ªæ²¡é—®é¢˜
}`;
```

æ­¤å¤–ï¼ŒJSON ä¸æ”¯æŒæ³¨é‡Šã€‚å‘ JSON æ·»åŠ æ³¨é‡Šæ— æ•ˆã€‚

è¿˜æœ‰å¦ä¸€ç§åä¸º [JSON5](http://json5.org/) çš„æ ¼å¼ï¼Œå®ƒå…è®¸æœªåŠ å¼•å·çš„é”®ï¼Œä¹Ÿå…è®¸æ³¨é‡Šç­‰ã€‚ä½†è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åº“ï¼Œä¸åœ¨è¯­è¨€çš„è§„èŒƒä¸­ã€‚

å¸¸è§„çš„ JSON æ ¼å¼ä¸¥æ ¼ï¼Œå¹¶ä¸æ˜¯å› ä¸ºå®ƒçš„å¼€å‘è€…å¾ˆæ‡’ï¼Œè€Œæ˜¯ä¸ºäº†å®ç°ç®€å•ï¼Œå¯é ä¸”å¿«é€Ÿåœ°å®ç°è§£æç®—æ³•ã€‚

## 12.6. ä½¿ç”¨ reviver

æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä»æœåŠ¡å™¨ä¸Šè·å¾—äº†ä¸€ä¸ªå­—ç¬¦ä¸²åŒ–çš„ `meetup` å¯¹è±¡ã€‚

å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```js
// title: (meetup title), date: (meetup date)
let str = '{"title":"Conference","date":"2017-11-30T12:00:00.000Z"}';
```

â€¦â€¦ç°åœ¨æˆ‘ä»¬éœ€è¦å¯¹å®ƒè¿›è¡Œ **ååºåˆ—ï¼ˆdeserializeï¼‰**ï¼ŒæŠŠå®ƒè½¬æ¢å› JavaScript å¯¹è±¡ã€‚

è®©æˆ‘ä»¬é€šè¿‡è°ƒç”¨ JSON.parse æ¥å®Œæˆï¼š

```js
let str = '{"title":"Conference","date":"2017-11-30T12:00:00.000Z"}';

let meetup = JSON.parse(str);

alert(meetup.date.getDate()); // Error!
```

å•Šï¼æŠ¥é”™äº†ï¼

`meetup.date` çš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯`Date`å¯¹è±¡ã€‚`JSON.parse` æ€ä¹ˆçŸ¥é“åº”è¯¥å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º Date å‘¢ï¼Ÿ

è®©æˆ‘ä»¬å°† `reviver` å‡½æ•°ä¼ é€’ç»™ `JSON.parse` ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œè¯¥å‡½æ•°æŒ‰ç…§â€œåŸæ ·â€è¿”å›æ‰€æœ‰å€¼ï¼Œä½†æ˜¯ date ä¼šå˜æˆ Dateï¼š

```js
let str = '{"title":"Conference","date":"2017-11-30T12:00:00.000Z"}';

let meetup = JSON.parse(str, function (key, value) {
  if (key == "date") return new Date(value);
  return value;
});

alert(meetup.date.getDate()); // ç°åœ¨æ­£å¸¸è¿è¡Œäº†ï¼
```

é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè¿™ä¹Ÿé€‚ç”¨äºåµŒå¥—å¯¹è±¡ï¼š

```js
let schedule = `{
  "meetups": [
    {"title":"Conference","date":"2017-11-30T12:00:00.000Z"},
    {"title":"Birthday","date":"2017-04-18T12:00:00.000Z"}
  ]
}`;

schedule = JSON.parse(schedule, function (key, value) {
  if (key == "date") return new Date(value);
  return value;
});

alert(schedule.meetups[1].date.getDate()); // æ­£å¸¸è¿è¡Œäº†ï¼
```

## 12.7. æ€»ç»“

- JSON æ˜¯ä¸€ç§æ•°æ®æ ¼å¼ï¼Œå…·æœ‰è‡ªå·±çš„ç‹¬ç«‹æ ‡å‡†å’Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€çš„åº“ã€‚
- JSON æ”¯æŒ objectï¼Œarrayï¼Œstringï¼Œnumberï¼Œboolean å’Œ `null`ã€‚
- JavaScript æä¾›åºåˆ—åŒ–ï¼ˆserializeï¼‰æˆ JSON çš„æ–¹æ³• [JSON.stringify](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify) å’Œè§£æ JSON çš„æ–¹æ³• [JSON.parse](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse)ã€‚
- è¿™ä¸¤ç§æ–¹æ³•éƒ½æ”¯æŒç”¨äºæ™ºèƒ½è¯»/å†™çš„è½¬æ¢å‡½æ•°ã€‚
- å¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰` toJSON`ï¼Œé‚£ä¹ˆå®ƒä¼šè¢« `JSON.stringify` è°ƒç”¨ã€‚
